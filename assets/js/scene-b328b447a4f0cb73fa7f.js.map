{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/systems/userinput/paths.js","webpack:///./src/constants.js","webpack:///./src/utils/promisify-worker.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/utils/media-url-utils.js","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/utils/component-utils.js","webpack:///./src/utils/three-utils.js","webpack:///./src/assets/stylesheets/scene.scss?9a0b","webpack:///./src/react-components/create-room-dialog.js","webpack:///./src/react-components/scene-ui.js","webpack:///./src/systems/scene-systems.js","webpack:///./src/scene.js","webpack:///./src/utils/async-utils.js","webpack:///./src/components/hoverable-visuals.js","webpack:///./src/assets/waternormals.jpg","webpack:///./src/utils/i18n.js","webpack:///./src/components/environment-map.js","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/utils/history.js","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/App.js","webpack:///./src/loaders/HubsTextureLoader.js","webpack:///./src/utils/media-utils.js","webpack:///./src/webxr-bypass-hacks.js","webpack:///./src/systems/sound-effects-system.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/react-components/if-feature.js","webpack:///./src/utils/animation.js","webpack:///./src/utils/easing.js","webpack:///./src/assets/sfx/quickTurn.mp3","webpack:///./src/assets/sfx/Eb_blip.mp3","webpack:///./src/react-components/dialog-container.js","webpack:///./src/utils/qs_truthy.js","webpack:///./src/utils/logging.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/utils/webgl.js","webpack:///./src/assets/models/LoadingObject_Atom.glb","webpack:///./src/assets/sfx/teleport-loop.mp3","webpack:///./src/assets/sfx/tap_mellow.mp3","webpack:///./src/assets/sfx/PenSpawn.mp3","webpack:///./src/assets/sfx/PenDraw1.mp3","webpack:///./src/assets/sfx/PicSnapHey.mp3","webpack:///./src/assets/sfx/welcome.mp3","webpack:///./src/assets/sfx/quack.mp3","webpack:///./src/assets/sfx/specialquack.mp3","webpack:///./src/assets/sfx/pop.mp3","webpack:///./src/assets/sfx/tack.mp3","webpack:///./src/assets/sfx/A_bendUp.mp3","webpack:///./src/assets/sfx/suspense.mp3","webpack:///./src/assets/sfx/emoji.mp3","webpack:///./src/systems/scene-preview-camera-system.js","webpack:///./src/utils/threejs-world-update.js","webpack:///./src/components/animation.js","webpack:///./src/components/ambient-light.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/css-class.js","webpack:///./src/components/duck.js","webpack:///./src/object-types.js","webpack:///./src/components/heightfield.js","webpack:///./src/components/hemisphere-light.js","webpack:///./src/components/hide-when-quality.js","webpack:///./src/components/point-light.js","webpack:///./src/components/spot-light.js","webpack:///./src/components/floaty-object.js","webpack:///./src/components/trigger-volume.js","webpack:///./src/components/video-pause-state.js","webpack:///./src/components/debug.js","webpack:///./src/systems/nav.js","webpack:///./src/components/event-repeater.js","webpack:///./src/utils/resizeShadowCameraFrustum.js","webpack:///./src/components/directional-light.js","webpack:///./src/components/layers.js","webpack:///./src/components/loop-animation.js","webpack:///./src/components/media-loader.js","webpack:///./src/components/quack.js","webpack:///./src/components/scene-preview-camera.js","webpack:///./src/components/skybox.js","webpack:///./src/components/spawn-controller.js","webpack:///./src/components/super-spawner.js","webpack:///./src/components/water.js","webpack:///./src/components/simple-water.js","webpack:///./src/components/particle-emitter.js","webpack:///./src/utils/component-mappings.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/utils/configs.js","webpack:///./src/systems/camera-system.js","webpack:///./src/utils/material-utils.js","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/assets/images/app-logo.png","webpack:///./src/assets/images/company-logo.png","webpack:///./src/assets/images/editor-logo.png","webpack:///./src/utils/permissions-utils.js","webpack:///./src/assets/stylesheets/scene-ui.scss?ca5c","webpack:///./src/telemetry.js","webpack:///./src/assets/sfx/tick.mp3","webpack:///./src/assets/images/twitter.svg","webpack:///./src/utils/auto-box-collider.js","webpack:///./src/assets/models/DuckyMesh.glb","webpack:///./src/utils/next-tick.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/scene-graph.js","webpack:///./src/utils/name-generation.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/theme.js","webpack:///./src/assets/images/warning_icon.png","webpack:///./src/materials/MobileStandardMaterial.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","8","exports","module","l","e","Promise","resolve","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","oe","err","console","error","jsonpArray","window","oldJsonpFunction","slice","paths","actions","log","toggleScreenShare","snapRotateLeft","snapRotateRight","angularVelocity","logDebugFrame","logInteractionState","debugUserInput","describeCurrentMasks","cameraDelta","lobbyCameraDelta","characterAcceleration","dCharSpeed","boost","startGazeTeleport","stopGazeTeleport","spawnPen","ensureFrozen","toggleFreeze","thaw","muteMic","toggleFly","toggleUI","waypointDeltaDistance","focusChat","focusChatCommand","toggleCamera","takeSnapshot","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","transformModifier","rayObjectRotation","cursor","right","pose","hideLine","grab","drop","modDelta","startDrawing","stopDrawing","undoDrawing","penNextColor","penPrevColor","scalePenTip","scaleGrabbedGrabbable","mediaVolumeMod","wake","left","pen","remove","rightHand","matrix","switchDrawMode","startTeleport","stopTeleport","thumb","index","middleRingPinky","leftHand","camera","exitMirror","startInspecting","stopInspecting","inspectZoom","inspectPanY","resetInspectView","nextCameraMode","haptics","actuators","device","mouse","coords","movementXY","buttonLeft","buttonRight","buttonMiddle","wheel","smartMouse","cursorPose","shouldMoveCamera","touchscreen","touchCameraDelta","gyroCameraDelta","pinch","delta","initialDistance","currentDistance","isTouching","isTouchingGrabbable","tap1","tap2","tap3","tap4","tap5","anything","gyro","averageDeltaX","averageDeltaY","hud","penButton","keyboard","map","Map","k","path","this","toLowerCase","set","gamepad","gamepadIndex","button","buttonIndex","pressed","touched","axis","axisIndex","xbox","v","buttonName","axisName","axesSum","oculusgo","trigger","touchpad","axisX","axisY","gearVRController","daydream","rightOculusTouch","leftOculusTouch","side","axes","wmrController","wmr","_objectSpread","grip","menu","joystick","vive","COLLISION_LAYERS","ALL","NONE","INTERACTABLES","ENVIRONMENT","AVATAR","HANDS","DEFAULT_INTERACTABLE","UNOWNED_INTERACTABLE","DEFAULT_SPAWNER","promisifyWorker","worker","nextItemId","outstanding","onmessage","msg","id","handlers","reject","Error","transfer","args","promise","postMessage","assign","payload","__webpack_exports__","EMPTY_RESULT","entries","meta","URL_SOURCE_TO_TO_API_SOURCE","scenes","images","videos","youtube","gifs","sketchfab","poly","twitch","favorites","availableIntegrations","configs","AVAILABLE_INTEGRATIONS","SOURCES","filter","source","apiSource","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","EventTarget","constructor","_this","super","_defineProperty","_ref","_asyncToGenerator","location","dispatchEvent","CustomEvent","urlSource","getUrlMediaSource","previousSource","urlParams","URLSearchParams","search","requestIndex","currentRequestIndex","searchParams","locationSearchParams","isMy","startsWith","param","navigator","languages","singular","fetch","APP","store","credentialsAccountId","toString","url","getReticulumFetchUrl","lastSavedUrl","isFetching","fetchReticulumAuthenticated","nextCursor","next_cursor","lastFetchedUrl","_x","arguments","history","goBack","pushHistoryPath","pathname","query","delete","keepSource","keepNav","keepSelectAction","_stashedParams","_stashedSource","q","_sourceNavigate","selectAction","_ref2","hideNav","useLastStashedParams","currentQuery","getSearchClearedSearchParams","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","hasReticulumServer","document","host","RETICULUM_SERVER","withSlug","_x2","_x3","_x4","_x5","sluglessPath","substring","stashLastSearchParams","_stashLastSearchParams","hasMediaPath","setHistory","_update","listen","nonCorsProxyDomains","NON_CORS_PROXY_DOMAINS","split","CORS_PROXY_SERVER","hostname","commonKnownContentTypes","gltf","glb","png","jpg","jpeg","pdf","mp4","mp3","farsparkEncodeUrl","str","btoa","encodeURIComponent","replace","_","p1","String","fromCharCode","b64EncodeUnicode","scaledThumbnailUrlFor","width","height","extension","pathParts","URL","extensionCandidate","pop","thumbnailUrl","THUMBNAIL_SERVER","urlHostname","isNonCorsProxyDomain","find","domain","endsWith","proxiedUrlFor","parsedUrl","getAbsoluteHref","baseUrl","relativeUrl","getAbsoluteUrl","href","getCustomGLTFParserURLResolver","gltfUrl","test","corsProxyPrefix","originalUrlParts","decodeURIComponent","join","dataUrlRegex","guessContentType","matches","exec","originIsHubsServer","isHubsServer","origin","has","method","headers","hubsSceneRegex","hubsAvatarRegex","_wrapRegExp","hubsRoomRegex","isLocalHubsUrl","isHubsSceneUrl","isLocalHubsSceneUrl","_ref3","isHubsAvatarUrl","_ref4","isLocalHubsAvatarUrl","_ref5","_x6","isHubsRoomUrl","_ref6","_x7","idForAvatarUrl","match","groups","disableiOSZoom","detect_browser__WEBPACK_IMPORTED_MODULE_0__","detectOS","userAgent","lastTouchAtMs","addEventListener","ev","scale","preventDefault","now","Date","getTime","isDoubleTouch","registerComponentInstance","component","componentRegistry","deregisterComponentInstance","indexOf","getCurrentStreamer","hubChannel","presence","playerInfos","presences","state","playerInfo","playerSessionId","metas","streaming","getLastWorldPosition","getLastWorldQuaternion","disposeNode","setMatrixWorld","cloneObject3D","findNode","interpolateAffine","squareDistanceBetween","affixToWorldUp","calculateCameraTransformForWaypoint","calculateViewingDistance","rotateInPlaceAroundWorldUp","childMatch","tempVector3","THREE","Vector3","Quaternion","src","target","updateMatrices","setFromMatrixPosition","matrixWorld","decompose","disposeMaterial","mtrl","dispose","lightMap","bumpMap","normalMap","specularMap","envMap","node","Mesh","geometry","material","materialArray","MeshFaceMaterial","MultiMaterial","materials","Array","forEach","IDENTITY","Matrix4","identity","object3D","matrixIsModified","applyMatrix","copy","parent","getInverse","multiply","position","quaternion","childrenNeedMatrixWorldUpdate","cloneAnimationClip","sourceAnimationClip","cloneUUIDLookup","clonedTracks","tracks","keyframeTrack","sourceKeyframeTrack","nodeName","uuid","objectName","objectIndex","propertyName","propertyIndex","PropertyBinding","parseTrackName","undefined","clonedUUID","warn","clonedKeyframeTrack","clone","cloneKeyframeTrack","AnimationClip","duration","preserveUUIDs","cloneLookup","parallelTraverse","a","b","callback","children","sourceNode","clonedNode","traverse","animations","animationClip","isMesh","boundsTree","isSkinnedMesh","sourceBones","skeleton","bones","sourceBone","bindMatrix","root","pred","nodes","concat","mat4","end","start","interpolated","startMat4","endMat4","progress","outMat4","setFromRotationMatrix","extractRotation","slerp","lerpVectors","setFromMatrixColumn","setFromMatrixScale","compose","posA","posB","objA","objB","distanceToSquared","inRotationMat4","inForward","outForward","outSide","worldUp","inMat4Copy","inMat4","multiplyScalar","sub","projectOnVector","normalize","crossVectors","makeBasis","setPosition","upAffixedCameraTransform","upAffixedWaypointTransform","detachFromWorldUp","cameraTransform","waypointTransform","fov","aspect","box","center","vrMode","halfYExtents","Math","max","abs","y","min","halfXExtents","x","halfVertFOV","degToRad","halfHorFOV","atan","tan","length1","length2","length3","z","startRotation","endRotation","theta","makeRotationY","childInverse","newParentMatrix","child","multiplyMatrices","loading-text","loadingText","HUB_NAME_PATTERN","CreateRoomDialog","Component","[object Object]","customRoomName","customSceneUrl","render","_this$props","props","onCustomScene","onClose","other","_objectWithoutProperties","react_default","createElement","dialog_container","_extends","title","includeScenePrompt","onSubmit","className","type","placeholder","pattern","onChange","setState","required","wrap_with_audio","PropTypes","bool","func","addLocaleData","en","SceneUI","scene_ui_defineProperty","showScreenshot","showCustomRoomDialog","createAndRedirectToNewHub","sceneId","setTimeout","sceneLoaded","componentDidMount","scene","onSceneLoaded","componentWillUnmount","removeEventListener","unavailable","index_es","locale","lang","messages","styles","ui","sceneAllowRemixing","isOwner","sceneProjectId","parentScene","sceneUrl","protocol","tweetText","sceneName","tweetLink","attributions","toAttributionSpan","includes","rel","author","sceneAttributions","extras","creator","content","classNames","screenshot","screenshotHidden","sceneScreenshotURL","whiteOverlay","grid","mainPanel","logo","image","logoTagline","showCreateRoom","createButtons","createButton","onClick","createRoom","optionsButton","react_fontawesome_index_es","icon","faEllipsisH","if_feature","spokeButton","faPencilAlt","faCodeBranch","tweetButton","twitter_default","info","attribution","spoke","madeWith","create_room_dialog_CreateRoomDialog","string","sceneDescription","AFRAME","registerSystem","init","waitForDOMContentLoaded","then","DOMContentDidLoad","scenePreviewCameraSystem","ScenePreviewCameraSystem","tick","process","BUILD_VERSION","patchWebGLRenderingContext","App","qs","isMobile","utils","isMobileVR","mountUI","ReactDOM","react_components_scene_ui","getElementById","quality","preferences","materialQualitySetting","onReady","querySelector","setAttribute","enabled","uiProps","remountUI","sceneRoot","sceneModelEntity","gltfEl","connectToReticulum","socket","joinParams","hub_id","credentials","token","retPhxChannel","channel","receive","perms_token","perms","jwtDecode","create_hub","leave","disconnect","previewCamera","getObjectByName","rotation","matrixNeedsUpdate","sceneInfo","allow_promotion","registerTelemetry","modelUrl","model_url","useCache","inflate","emit","appendChild","parent_scene_id","description","screenshot_url","scene_id","project_id","allow_remixing","account_id","waitForEvent","eventName","eventObj","once","readyState","validMaterials","_utils_material_utils__WEBPACK_IMPORTED_MODULE_0__","_utils_permissions_utils__WEBPACK_IMPORTED_MODULE_1__","interactorOneTransform","interactorTwoTransform","registerComponent","schema","enableSweepingEffect","default","uniforms","geometryRadius","sweepParams","boundingBox","batchManagerSystem","el","sceneEl","systems","forEachMaterial","classList","contains","getAttribute","meshToEl","isTouchscreen","time","isFrozen","is","showEffect","showHoverEffect","toggling","cursorTogglingSystem","interactorOne","interactorTwo","interaction","ready","hovered","held","options","entity","leftRemote","leftToggledOff","rightRemote","rightToggledOff","toArray","worldY","elements","ms1","ms2","ms3","scaledRadius","sqrt","uniform","hubs_EnableSweepingEffect","hubs_IsFrozen","hubs_SweepParams","hubs_HighlightInteractorOne","hubs_InteractorOnePos","hubs_HighlightInteractorTwo","hubs_InteractorTwoPos","hubs_Time","_configs__WEBPACK_IMPORTED_MODULE_0__","_assets_translations_data_json__WEBPACK_IMPORTED_MODULE_1__","navigatorLang","language","userLanguage","localeData","_messages","APP_CONFIG","translations","configTranslations","messageKey","message","_match","subkey","reduce","acc","entry","createDefaultEnvironmentMap","_createDefaultEnvironmentMap","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","texture","CubeTextureLoader","load","format","RGBFormat","environmentMap","updateEnvironmentMap","applyEnvironmentMap","isMeshStandardMaterial","needsUpdate","pushOrUpdateHistory","detail","newPathname","newSearch","newLength","__historyLength","__duplicate","isDuplicate","pushHistoryState","replaceHistoryState","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","len","unsubscribe","go","_storage_store__WEBPACK_IMPORTED_MODULE_0__","_storage_media_search_store__WEBPACK_IMPORTED_MODULE_1__","Store","mediaSearchStore","setQuality","HubsTextureLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","Texture","loadTextureAsync","catch","imageLoader","createImageBitmap","ImageBitmapLoader","flipY","ImageLoader","setCrossOrigin","crossOrigin","setPath","cacheKey","resolveURL","loader","loadAsync","Cache","onUpdate","close","linkify","Linkify","tlds","mediaAPIEndpoint","resolveUrlCache","getDefaultResolveQuality","is360","useLowerQuality","resolveUrl","media_utils_asyncToGenerator","version","resultPromise","Content-Type","body","JSON","stringify","media","response","ok","text","statusText","json","upload","file","desiredContentType","formData","FormData","append","coerceToUrl","urlOrText","addMedia","template","contentOrigin","contentSubtype","fitToBox","animate","mediaOptions","networked","parentEl","linkedEl","templateBody","importNode","firstElementChild","cloneNode","elAttrs","attributes","attrIdx","needsToBeUploaded","File","els","querySelectorAll","components","getLatestMediaVersionOfSrc","fileIsOwned","orientation","reader","FileReader","onload","view","DataView","getUint16","byteLength","offset","marker","getUint32","little","tags","readAsArrayBuffer","getOrientation","srcUrl","access_token","fileId","file_id","update","uploadPromotionTokens","promotionToken","promotion_token","MediaStream","NAF","clientId","objectType","objectTypeForOriginAndContentType","contentType","cloneMedia","sourceEl","link","ObjectContentOrigins","injectCustomShaderChunks","obj","vertexRegex","fragRegex","shaderUniforms","mapMaterials","hubs_InjectedCustomShaderChunks","newMaterial","onBeforeCompile","shader","vertexShader","vlines","vindex","findIndex","line","unshift","flines","fragmentShader","findex","mediaHighlightFrag","getPromotionTokenForFile","mediaPos","addAndArrangeMedia","snapCount","mirrorOrientation","distance","pos","rotateY","PI","idx","cos","sin","localToWorld","visible","handler","dur","from","to","easing","eventType","textureLoader","createImageTexture","_createImageTexture","Image","res","canvas","ctx","getContext","drawImage","CanvasTexture","status","encoding","sRGBEncoding","anisotropy","addMeshScaleAnimation","mesh","initialScale","onComplete","step","lastValue","anim","animatables","Number","MIN_VALUE","config","elasticity","loop","round","targets","complete","anime","closeExistingMediaMirror","mirrorTarget","firstChild","removeChild","xr","requestDevice","getVRDisplays","SOUND_HOVER_OR_GRAB","SOUND_THAW","SOUND_PEN_STOP_DRAW","SOUND_PEN_UNDO_DRAW","SOUND_PEN_CHANGE_COLOR","SOUND_TOGGLE_MIC","SOUND_TELEPORT_START","SOUND_TELEPORT_END","SOUND_WAYPOINT_START","SOUND_WAYPOINT_END","SOUND_SNAP_ROTATE","SOUND_SPAWN_PEN","SOUND_PEN_START_DRAW","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","SOUND_ENTER_SCENE","SOUND_QUACK","SOUND_SPECIAL_QUACK","SOUND_CHAT_MESSAGE","SOUND_FREEZE","SOUND_PIN","SOUND_MEDIA_LOADING","SOUND_MEDIA_LOADED","SOUND_CAMERA_TOOL_COUNTDOWN","SOUND_PREFERENCE_MENU_SELECT","SOUND_SPAWN_EMOJI","SoundEffectsSystem","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0__","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0___default","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1__","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1___default","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2__","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2___default","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3__","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3___default","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4__","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4___default","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5__","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5___default","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6__","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6___default","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7__","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7___default","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8__","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8___default","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9__","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9___default","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10__","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10___default","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11__","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11___default","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12__","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12___default","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13__","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13___default","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14__","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14___default","_assets_sfx_emoji_mp3__WEBPACK_IMPORTED_MODULE_15__","_assets_sfx_emoji_mp3__WEBPACK_IMPORTED_MODULE_15___default","_utils_three_utils__WEBPACK_IMPORTED_MODULE_16__","soundEnum","SOUND_PREFERENCE_MENU_HOVER","pendingAudioSourceNodes","pendingPositionalAudios","positionalAudiosStationary","positionalAudiosFollowingObject3Ds","audioContext","AudioContext","audioListener","AudioListener","add","evt","cameraEl","getObject3D","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","URL_SPAWN_EMOJI","loading","audioBufferPromise","arrayBuffer","decodeAudioData","sounds","sound","audioBuffer","enqueueSound","createBufferSource","buffer","connect","destination","enqueuePositionalSound","positionalAudio","PositionalAudio","setBuffer","playPositionalSoundAt","matrixWorldNeedsUpdate","playPositionalSoundFollowing","playSoundOneShot","playSoundLooped","playSoundLoopedWithGain","gain","createGain","stopSoundNode","stop","stopPositionalAudio","inPositionalAudio","pendingIndex","isPlaying","pendingPositionalAudio","play","positionalAudioAndObject3D","MIN_VOLUME_THRESHOLD","calculateVolume","analyser","levels","getByteTimeDomainData","sum","amplitude","tempScaleFromPosition","tempScaleToPosition","getAudioFeedbackScale","fromObject","toObject","minScale","maxScale","volume","distanceTo","updateVolume","newRawVolume","newPerceivedVolume","mapLinear","E","prevVolume","getAnalyser","ikRootEl","findAncestorWithComponent","analyserEl","loudest","_updateAnalysis","_runScheduledWork","schedule","event","createAnalyser","fftSize","Uint8Array","soundSource","unschedule","avatarIsQuiet","lastSeenVolume","mediaStream","stream","createMediaStreamSource","connectAnalyser","_this2","setScalar","minValue","maxValue","object3DMap","skinnedmesh","morphNumber","morphTargetDictionary","morphTargetInfluences","easeOutQuadratic","SPRITE_NAMES","MIC","MIC_HOVER","MIC_OFF","MIC_OFF_HOVER","micLevelForVolume","clamp","ceil","active","tooltip","tooltipText","activeTooltipText","prevSpriteName","hovering","onHover","onHoverOut","pause","textEl","audioAnalyser","spriteName","IfFeature","_utils_configs__WEBPACK_IMPORTED_MODULE_0__","feature","addAnimationComponents","modelEl","DialogContainer","closable","currentTarget","onKeyDown","onContainerClicked","react__WEBPACK_IMPORTED_MODULE_0___default","noOverlay","wide","allowOverflow","additionalClass","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_4__","faTimes","isRequired","qsTruthy","val","debug__WEBPACK_IMPORTED_MODULE_0__","debug__WEBPACK_IMPORTED_MODULE_0___default","_qs_truthy__WEBPACK_IMPORTED_MODULE_1__","isDebug","logFilter","debug","enable","ReactAudioContext","WithHoverSound","react__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","React","createContext","Consumer","context","cloneElement","onMouseEnter","playSound","propTypes","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","renderer","WebGLRenderer","Scene","Float32Array","size","dataTexture","DataTexture","RGBAFormat","FloatType","PlaneBufferGeometry","MeshBasicMaterial","Camera","getError","checkFloatTextureSupport","_camera_system_js__WEBPACK_IMPORTED_MODULE_0__","entities","register","unregister","hubsSystems","cameraSystem","CAMERA_MODE_INSPECT","tick2","zeroPos","zeroQuat","oneScale","bindingSetters","SetterByBindingTypeAndVersioning","Versioning","setter","MatrixWorldNeedsUpdate","targetObject","Object3D","getWorldPosition","getWorldQuaternion","getWorldScale","handleMatrixModification","cachedMatrixWorld","updateMatrix","forceLocalUpdate","forceWorldUpdate","skipParents","hasHadFirstMatrixUpdate","matrixAutoUpdate","equals","updateMatrixWorld","includeInvisible","forceChildrenWorldUpdate","lookAt","q1","m1","isVector3","isCamera","isLight","up","premultiply","inverse","require","animation","colorHelperFrom","Color","colorHelperTo","getComponentProperty","setComponentProperty","splitCache","TYPE_COLOR","STRING_COMPONENTS","STRING_OBJECT3D","toRadians","addEventListeners","eventNames","removeEventListeners","getRawProperty","splitDot","setRawProperty","targetValue","g","isRawProperty","autoplay","delay","dir","parse","parseInt","startEvents","pauseEvents","resumeEvents","multiple","self","eventDetail","attrName","animationIsPlaying","onStartEvent","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targetsArray","updateConfigForDefault","updateConfigForRawColor","oldData","direction","createAndStartAnimation","dt","cancelDelayedStart","paused","pausedWasPlaying","updateConfig","delayTimeout","stopRelatedAnimations","waitComponentInitRawProperty","setColorConfig","isBoolean","isNaN","parseFloat","aframeProperty","updateConfigForVector","coordinates","propType","componentName","getPropertyType","cb","wait","clearTimeout","color","intensity","light","AmbientLight","setObject3D","registerLight","rendererSystem","prevData","applyColorCorrection","removeObject3D","initMixer","mixer","AnimationMixer","initialForce","maxForce","physicsSystem","physics","hasBody","CANNON","Vec3","force","addComponent","removeComponent","beforeStep","isMine","currentScale","angle","random","applyForce","ObjectTypes","FILE","CLIPBOARD","SPAWNER","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","CAMERA","UNKNOWN","objectTypeForOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","image/","model/","application/x-zip-compressed","video/","application/vnd.apple.mpegurl","application/x-mpegurl","audio/","application/pdf","srcSuffixLookupMap",".m3u8","prefix","suffix","generateAndAddHeightfield","shape","mass","setFromAxisAngle","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","HemisphereLight","onQualityChanged","updateComponentState","range","decay","castShadow","shadowMapResolution","shadowBias","shadowRadius","PointLight","shadow","bias","radius","prevWidth","prevHeight","mapSize","innerConeAngle","outerConeAngle","SpotLight","penumbra","autoLockOnLoad","autoLockOnRelease","modifyGravityOnRelease","releaseGravity","reduceAngularFloat","gravitySpeedLimit","onGrab","onRelease","bodyHelper","isHeld","wasHeld","_makeStaticWhenAtRest","linearThreshold","linearSleepingThreshold","angularThreshold","angularSleepingThreshold","isAtRest","physicsBody","getLinearVelocity","getAngularVelocity","hasBeenHereBefore","gravity","setLocked","locked","getVelocity","angularDamping","linearDamping","collisionFilterMask","stuckTo","_unstickObject","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","colliders","enterComponent","enterProperty","enterValue","leaveComponent","leaveProperty","leaveValue","Box3","collidingLastFrame","setFromCenterAndSize","isColliding","containsPoint","onPauseStateChange","videoComponent","onVideoLoaded","video","togglePlaying","origDispatch","firstObject","Pathfinding","pathfinder","loadMesh","zone","Geometry","fromBufferGeometry","setZoneData","createZone","eventSource","events","eventListeners","_handleEvent","frustumBox","inverseLightMatrixWorld","tempBox","FRUSTUM_PADDING","NEAR_CLIPPING_PLANE","FAR_CLIPPING_PLANE","verts","DirectionalLight","makeEmpty","computeBoundingBox","applyMatrix4","union","expandByPoint","bottom","top","near","far","updateProjectionMatrix","resizeShadowCameraFrustum","Layers","reflection","inWorldHud","exclusive","layers","mask","layer","oldValue","newValue","disable","clip","activeClipIndex","mixerEl","updateClip","currentAction","clipName","action","clipAction","setLoop","LoopRepeat","Infinity","destroy","loadingObjectEnvMap","loadingObject","loadModel","loadingObjectSrc","forceMeshBatching","disableBatching","playSoundEffect","showLoader","clearLoadingTimeout","onMediaLoaded","handleLinkedElRemoved","refresh","animating","getNetworkedEntity","networkedEl","updateScale","getBox","scaleCoefficient","getScaleCoefficient","addVectors","removeShape","removeAttribute","loaderMixer","sfx","soundEffectsSystem","loadingSoundEffect","loadedSoundEffect","useFancyLoader","BoxGeometry","environmentMapComponent","currentEnivronmentMap","loadingClip","loadingScaleClip","VectorKeyframeTrack","SHAPE","BOX","showLoaderTimeout","updateHoverableVisuals","boundingSphere","Sphere","hoverableVisuals","injectedCustomShaderChunks","setFromObject","getBoundingSphere","physicsShape","shouldUpdateScale","finish","minHalfExtent","registerLinkage","takeOwnership","floor","srcChanged","thumbnail","canonicalUrl","canonicalAudioUrl","accessibleUrl","isLocalModelAsset","projection","origin_audio","expected_content_type","fetchContentType","raw","isHLS","linkedVideoTexture","linkedAudioSource","linkedMediaElementAudioSource","linkedMediaVideo","videoTexture","audioSource","mediaElementAudioSource","qsTime","startTime","hash","audioSrc","dirs","batch","HULL","modelToWorldScale","mayChangeScene","permissions","can","maxIndex","onNext","onPrev","onSnap","getHoverMenu","parentNode","hoverMenu","nextButton","prevButton","snapButton","pageLabel","_this3","pinnableElement","isPinned","pinnable","pinned","newIndex","quackPercentage","specialQuackPercentage","_handleGrabStart","rand","lerp","newRot","positionOnly","startPoint","targetPoint","targetRotDelta","Euler","targetRotation","setFromEuler","performance","backwards","ranOnePass","streamerCamera","CAMERA_MODE_SCENE_PREVIEW","streamer","getStreamerCamera","translateZ","fromRot","toRot","setFromQuaternion","isBotMode","CubeCamera","BoxBufferGeometry","ShaderMaterial","UniformsUtils","BackSide","UniformsLib","PMREMGenerator","skybox_PMREMGenerator","PMREMCubeUVPacker","Sky","fog","skyScene","cubeCamera","sky","_geometry","_inclination","_azimuth","_distance","updateSunPosition","turbidity","rayleigh","luminance","mieCoefficient","mieDirectionalG","inclination","azimuth","phi","sunPosition","generateEnvironmentMap","vrEnabled","vr","pmremGenerator","renderTarget","pmremCubeUVPacker","cubeLods","CubeUVRenderTarget","recursive","skyIndex","merge","requestAnimationFrame","playerHeight","loadedEvent","moveToSpawnPoint","spawnPoints","spawnPoint","spawnScale","NaN","spawnCooldown","spawnEvent","animateFromCursor","cooldownTimeout","handPosition","onSpawnEvent","tempSpawnHandPosition","handleMediaLoaded","spawnedMediaScale","spawnedEntity","values","boxSize","divideScalar","hand","userinput","willAnimateFromCursor","spawning","activateCooldown","syncToPhysics","sx","sy","sz","MobileWater","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","FrontSide","mirrorShader","ShaderChunk","transparent","lights","TextureLoader","wrapS","wrapT","RepeatWrapping","Water","speed","forceMobile","waterMesh","waterGeometry","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","water","mirrorCamera","setStyle","simple_water_Mesh","MeshStandardMaterial","MeshPhongMaterial","Vector2","Octave","alternate","SimpleWater","resolution","lowQuality","rotateX","waterUniforms","ripplesSpeed","ripplesScale","materialClass","specular","receiveShadow","dynamic","octaves","simplex","SimplexNoise","opacity","tideHeight","tideScale","tideSpeed","waveHeight","waveScale","waveSpeed","positionAttribute","octave","noise","setY","computeVertexNormals","vec2Equals","waterNormalsUrl","defaultSrcUrl","defaultSrcImage","startColor","middleColor","endColor","startOpacity","middleOpacity","endOpacity","colorCurve","sizeCurve","startSize","endSize","sizeRandomness","ageRandomness","lifetime","lifetimeRandomness","particleCount","startVelocity","endVelocity","velocityCurve","particleEmitter","ParticleEmitter","updateParticles","setTexture","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","registerRootSceneComponent","GLTFModelPlus","componentData","mediaInflator","isControlled","hasVolume","templateName","controls","owner","persistent","networkId","videoPaused","autoPlay","audioType","hidePlaybackControls","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","isHandCollisionTarget","TYPE","STATIC","collisionFilterGroup","euler","fit","FIT","MANUAL","halfExtents","canBeSpawnPoint","canBeOccupied","canBeClicked","willDisableMotion","willDisableTeleporting","willMaintainWorldUp","_componentName","nav","found","attachTemplateToLocal","mediaLoaderAttributes","pageIndex","loop-animation","indexToEntityMap","enterComponentMapping","leaveComponentMapping","targetEntity","HEIGHTFIELD","margin","heightfieldDistance","heightfieldData","MESH","audioSettingsSystem","updateAudioSettings","pdfjs_dist__WEBPACK_IMPORTED_MODULE_3__","pdfjs_dist__WEBPACK_IMPORTED_MODULE_3___default","isAdmin","__webpack_public_path__","pdfjs","GlobalWorkerOptions","workerSrc","theme","colorVars","style","innerHTML","head","prepend","features","featureName","enableAll","localDevImages","imageName","cssUrl","linkName","defaultValue","links","setIsAdmin","_isAdmin","enableThirdPersonMode","getInspectable","inspectable","orbit","owq","owp","cwq","cwp","rwq","UP","RIGHT","dhQ","dvQ","rig","dh","dv","dz","panY","applyQuaternion","dPos","subVectors","zoom","moveRigSoCameraLooksAtObject","oForw","distanceMod","getCenter","dist","CAMERA_MODE_FIRST_PERSON","CAMERA_MODE_THIRD_PERSON_NEAR","CAMERA_MODE_THIRD_PERSON_FAR","NEXT_MODES","CAMERA_LAYER_INSPECT","CAMERA_LAYER_BATCH_INSPECT","ensureLightsAreSeenByCamera","enableInspectLayer","batchManager","batchForMesh","disableInspectLayer","FALLOFF","CameraSystem","translation","enteredScene","avatarPOVRotator","avatarPOV","viewingCameraRotator","viewingCamera","on","hoverEl","inspect","temporarilyDisableRegularExit","uninspect","nextMode","headShouldBeVisible","playerHead","avatarRig","viewingRig","makeTranslation","horizontalDelta","verticalDelta","inspected","enableLights","localStorage","getItem","snapshot","audioTransform","audioListenerTargetTransform","bg","setPoseTarget","getCamera","mask0","cameras","mask1","hideEverythingButThisObject","audio","getAudio","showEverythingAsNormal","fn","isArray","names","chooseRandom","arr","fetchRandomDefaultAvatarId","_fetchRandomDefaultAvatarId","defaultAvatars","ducky","avatar","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","SCHEMA","definitions","profile","additionalProperties","properties","displayName","avatarId","personalAvatarId","email","activity","hasFoundFreeze","hasChangedName","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","hasOpenedShare","entryCount","settings","lastUsedMicDeviceId","muteMicOnEntry","enableOnScreenJoystickLeft","enableOnScreenJoystickRight","onlyShowNametagsInFreeze","allowMultipleHubsInstances","maxResolutionWidth","maxResolutionHeight","globalVoiceVolume","globalMediaVolume","snapRotationDegrees","disableMovement","disableBackwardsMovement","disableStrafing","disableTeleporter","confirmedDiscordRooms","items","confirmedBroadcastedRooms","creatorAssignmentTokens","hubId","creatorAssignmentToken","embedTokens","embedToken","onLoadActions","$ref","exp","store_asyncToGenerator","_shouldResetAvatarOnInit","resetToRandomDefaultAvatar","setItem","oauthFlowCredentials","Cookies","getJSON","_signOutOnExpiredAuthToken","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","bumpEntryCount","currentEntryCount","enqueueOnLoadAction","executeOnLoadActions","clearOnLoadActions","arrayMerge","destinationArray","sourceArray","newState","mergeOpts","finalState","valid","validate","isSpawner","canMove","networkedTemplate","isPen","holdableButton","indexForComponent","fullComponent","schemaComponent","authorizeOrSanitizeMessage","applyPersistentSync","nonAuthorizedSchemas","sanitizeMessageData","schemaDict","schemas","nonAuthorizedComponents","nonAuthorizedComponent","initializeNonAuthorizedSchemas","nonAuthorizedIndices","authorizeEntityManipulation","entityMetadata","sender","senderPermissions","isCreator","pin_objects","spawn_and_move_media","spawn_camera","spawn_drawing","getPendingOrExistingEntityMetadata","pendingData","connection","adapter","getPendingDataForNetworkId","pinnableComponent","getEntity","authorizeOrSanitizeMessageData","persistentSyncs","stashPersistentSync","entityData","currentData","currentComponents","dataType","from_session_id","emptyObject","isFirstSync","presenceState","sanitizedAny","stashedAny","PHOENIX_RELIABLE_NAF","onData","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","_utils_configs__WEBPACK_IMPORTED_MODULE_1__","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","Raven","install","computeObjectAABB","bounds","boxRoot","worldSpace","isEmpty","worldToLocal","dX","dY","dZ","nextTick","raycast","acceleratedRaycast","gltfCache","cache","count","retain","cacheItem","release","inflightGltfs","extractZipFile","SketchfabZipWorker","defaultInflator","cloneGltf","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","componentKey","inflator","inflateEntities","templates","isRoot","childEntities","entityComponents","order","generateUUID","gltfIndex","inflatedEntity","isFirstInflation","objectInflations","objectInflation","prop","_x9","attachTemplate","templateRoot","targetEls","getHubsComponentsExtension","extensions","loadGLTF","_loadGLTF","preferredTechnique","jsonPreprocessor","fileMap","loadingManager","LoadingManager","setURLModifier","gltfLoader","GLTFLoader","parser","createParser","oldHeightfieldNode","heightfield","runMigration","MOZ_alt_materials","altMaterialIndex","DefaultMatrixAutoUpdate","MobileStandardMaterial","fromStandardMaterial","keys","revokeObjectURL","_x8","_loadModel","resolveAsset","charAt","assetEl","loadTemplates","applySrc","model","removeObject","templateEl","lastSrc","inflatedEl","disposeLastInflatedEl","addObject","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","triCount","MeshBVH","strategy","maxDepth","object3DToSet","inflateComponents","rewires","f","adjectives","nouns","generateHubName","randItem","toUpperCase","isLocalClient","resolverLink","absolute","reticulumMeta","invalidatedReticulumMetaThisSession","invalidateReticulumMeta","_invalidateReticulumMeta","getReticulumMeta","_getReticulumMeta","pool","phx_host","phxHostOverride","_connectToReticulum","params","socketClass","Socket","getNewSocketUrl","socketProtocol","RETICULUM_SOCKET_PROTOCOL","socketHost","socketPort","RETICULUM_SOCKET_SERVER","port","socketUrl","socketSettings","logger","kind","endPointPath","endPoint","newEndPoint","getLandingPageForPhoto","photoUrl","retUrl","content-type","authorization","_createAndRedirectToNewHub","createUrl","hub","creator_assignment_token","embed_token","getPresenceEntryForSession","sessionId","getPresenceContextForSession","getPresenceProfileForSession","migrateChannelToSocket","oldChannel","topic","bindings","item","pushBuffer","timeout","oldJoinPush","joinPush","recHooks","discordBridgesForPresences","channels","discordBridges","applyThemeToTextButton","getThemeColor","_async_utils__WEBPACK_IMPORTED_MODULE_0__","DEFAULT_COLORS","action-color","action-label-color","action-color-disabled","action-color-highlight","action-text-color","action-subtitle-color","notice-background-color","notice-text-color","favorited-color","highlighted","actionColor","actionHoverColor","VERTEX_SHADER","FRAGMENT_SHADER","parameters","uvTransform","Matrix3","diffuse","aoMapIntensity","aoMap","emissive","emissiveMap","alphaTest","skinning","morphTargets","vertexColors","mobileMaterial","emissiveIntensity","refreshUniforms","uvScaleMap"],"mappings":"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AASV,SAASM,QAAQ6lD,GAE1BA,EAAGzlD,EAASV,WAIT,SAASkiB,EAAaxhB,EAAUylD,GACrC,GAAKzlD,EAASV,SAEd,OAAIK,MAAM+lD,QAAQ1lD,EAASV,UAClBU,EAASV,SAASxT,IAAI25D,GAEtBA,EAAGzlD,EAASV,UAhBvBjd,EAAAY,EAAA6M,EAAA,sBAAAmkB,IAAA5xB,EAAAY,EAAA6M,EAAA,sBAAA0xB,sPCGA,MAAMmkC,EAAQ,CACZ,gBACA,cACA,oBACA,cACA,YACA,cACA,aACA,aACA,aACA,gBACA,gBACA,gBACA,gBACA,YACA,eACA,mBACA,mBACA,iBACA,gBACA,kBACA,eACA,eACA,mBACA,iBACA,WACA,cACA,gBACA,UACA,WACA,gBACA,cACA,YACA,WACA,YACA,YACA,mBACA,iBACA,aACA,aACA,YACA,cACA,eACA,cACA,cACA,UACA,WACA,eACA,eACA,YACA,mBACA,gBACA,oBACA,kBACA,YACA,cACA,kBACA,aACA,cACA,eACA,cACA,cACA,cACA,iBACA,kBACA,cACA,WACA,WACA,cACA,OACA,mBACA,cACA,mBACA,cACA,iBACA,aACA,cACA,cACA,gBACA,qBACA,iBACA,eACA,gBACA,eACA,SACA,YACA,iBAGF,SAASC,EAAaC,GACpB,OAAOA,EAAIv/C,KAAKwmC,MAAMxmC,KAAKg4B,SAAWunB,EAAI3kE,SAOrC,SAAe4kE,IAAtB,OAAAC,EAAAlkE,MAAAqK,KAAA4H,uCAAO,YACL,MACMkyD,SAAwBvyD,YADA,+DACoDzD,QAClF,OAA8B,IAA1Bg2D,EAAe9kE,OAGV,IAAIiX,IAAI8tD,IAAOp0D,SAASsH,MAAMA,KAGhCysD,EADWI,EAAel6D,IAAIo6D,GAAUA,EAAO92D,kgCCvGxD,MAAM+2D,EAAkB,gBAClBC,EAAwB3iE,SACxB4iE,EAA6B,qCAC7BC,EAAY,IAAIC,YAMTC,EAAS,CACpBp3D,GAAI,aAEJq3D,YAAa,CACXC,QAAS,CACPr9C,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVC,YAAa,CAAEx9C,KAAM,SAAUE,QAAS,yBACxCu9C,SAAU,CAAEz9C,KAAM,UAElB09C,iBAAkB,CAAE19C,KAAM,YAI9BuH,YAAa,CACXvH,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACV/1C,MAAO,CAAExH,KAAM,CAAC,OAAQ,WACxB29C,MAAO,CAAE39C,KAAM,CAAC,OAAQ,aAI5B49C,SAAU,CACR59C,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVM,eAAgB,CAAE79C,KAAM,WACxB89C,eAAgB,CAAE99C,KAAM,WACxB+9C,mBAAoB,CAAE/9C,KAAM,WAC5Bg+C,cAAe,CAAEh+C,KAAM,UACvBi+C,UAAW,CAAEj+C,KAAM,WACnBk+C,WAAY,CAAEl+C,KAAM,WACpBm+C,cAAe,CAAEn+C,KAAM,WACvBo+C,UAAW,CAAEp+C,KAAM,WACnBq+C,qBAAsB,CAAEr+C,KAAM,WAC9Bs+C,eAAgB,CAAEt+C,KAAM,WACxBu+C,WAAY,CAAEv+C,KAAM,YAIxBw+C,SAAU,CACRx+C,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVkB,oBAAqB,CAAEz+C,KAAM,YAIjCwG,YAAa,CACXxG,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVmB,eAAgB,CAAE1+C,KAAM,QACxB2+C,2BAA4B,CAAE3+C,KAAM,QACpC4+C,4BAA6B,CAAE5+C,KAAM,QACrC6+C,yBAA0B,CAAE7+C,KAAM,QAClC8+C,2BAA4B,CAAE9+C,KAAM,QACpC++C,mBAAoB,CAAE/+C,KAAM,UAC5Bg/C,oBAAqB,CAAEh/C,KAAM,UAC7Bi/C,kBAAmB,CAAEj/C,KAAM,UAC3Bk/C,kBAAmB,CAAEl/C,KAAM,UAC3Bm/C,oBAAqB,CAAEn/C,KAAM,UAC7ByG,uBAAwB,CAAEzG,KAAM,UAChCo/C,gBAAiB,CAAEp/C,KAAM,QACzBq/C,yBAA0B,CAAEr/C,KAAM,QAClCs/C,gBAAiB,CAAEt/C,KAAM,QACzBu/C,kBAAmB,CAAEv/C,KAAM,UAK/Bw/C,sBAAuB,CACrBx/C,KAAM,QACNy/C,MAAO,CAAEz/C,KAAM,WAGjB0/C,0BAA2B,CACzB1/C,KAAM,QACNy/C,MAAO,CAAEz/C,KAAM,WAGjBiX,sBAAuB,CACrBjX,KAAM,QACNy/C,MAAO,CACLz/C,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVzmC,OAAQ,CAAE9W,KAAM,UAChBkX,eAAgB,CAAElX,KAAM,aAK9B2/C,wBAAyB,CACvB3/C,KAAM,QACNy/C,MAAO,CACLz/C,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVqC,MAAO,CAAE5/C,KAAM,UACf6/C,uBAAwB,CAAE7/C,KAAM,aAKtC8/C,YAAa,CACX9/C,KAAM,QACNy/C,MAAO,CACLz/C,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVqC,MAAO,CAAE5/C,KAAM,UACf+/C,WAAY,CAAE//C,KAAM,aAK1BggD,cAAe,CACbhgD,KAAM,QACNy/C,MAAO,CACLz/C,KAAM,SACNs9C,sBAAsB,EACtBC,WAAY,CACVtd,OAAQ,CAAEjgC,KAAM,UAChB5Z,KAAM,CAAE4Z,KAAM,cAMtBA,KAAM,SAENu9C,WAAY,CACVF,QAAS,CAAE4C,KAAM,yBACjB14C,YAAa,CAAE04C,KAAM,6BACrBrC,SAAU,CAAEqC,KAAM,0BAClBzB,SAAU,CAAEyB,KAAM,0BAClBz5C,YAAa,CAAEy5C,KAAM,6BACrBT,sBAAuB,CAAES,KAAM,uCAC/BP,0BAA2B,CAAEO,KAAM,2CACnChpC,sBAAuB,CAAEgpC,KAAM,uCAC/BN,wBAAyB,CAAEM,KAAM,yCACjCH,YAAa,CAAEG,KAAM,6BACrBD,cAAe,CAAEC,KAAM,gCAGzB3C,sBAAsB,GAGT,MAAM1sC,UAAc3oB,IACjCC,cAAc,IAAAC,EACZC,QADYD,EAAAtF,KAAAwF,EAAAxF,KAAA,6BAwCe,KAC3B,IAAKA,KAAK6Q,MAAM6T,YAAYC,MAAO,OAE0B,IAA9CM,IAAUjlB,KAAK6Q,MAAM6T,YAAYC,OAAO04C,KACzCrtD,KAAKD,OACjB/P,KAAKm0B,OAAO,CAAEzP,YAAa,CAAEC,MAAO,KAAMm2C,MAAO,UA7CvCt1D,EAAAxF,KAAA,cAAAs9D,EAiDA,YACRh4D,EAAKi4D,+BACDj4D,EAAKk4D,6BAEXl4D,EAAK6uB,OAAO,CACVqmC,QAAO34D,EAAA,CAAI+4D,eAAgBhB,KAAkCt0D,EAAKuL,MAAM2pD,SAAW,MAKlFl1D,EAAKuL,MAAMkqD,SAASE,gBACvB31D,EAAK6uB,OAAO,CAAEqmC,QAAS,CAAEG,eDjInBjB,EAAaD,MAAUr/C,KAAKwmC,MAAM,IAAwB,IAAhBxmC,KAAKg4B,kBCqE3C5sC,EAAAxF,KAAA,6BAAAs9D,EAgEe,YAC3Bh4D,EAAK6uB,OAAO,CACVqmC,QAAO34D,EAAA,GAAQyD,EAAKuL,MAAM2pD,SAAW,GAA9B,CAAmCI,eAAgBhB,WA/Dd,OAA1CpB,aAAaC,QAAQwB,IACvBzB,aAAaiF,QAAQxD,EAAiBzpC,KAAKC,UAAU,KAIvD/3B,OAAOiX,iBAAiB,UAAWjZ,IAC7BA,EAAEqB,MAAQkiE,WACPj6D,KAAKk6D,GACZl6D,KAAK4F,cAAc,IAAIC,YAAY,oBAGrC7F,KAAKm0B,OAAO,CACV4mC,SAAU,GACVY,SAAU,GACVj3C,YAAa,GACb81C,QAAS,GACTmC,sBAAuB,GACvBE,0BAA2B,GAC3BzoC,sBAAuB,GACvB0oC,wBAAyB,GACzBG,YAAa,GACbE,cAAe,GACfx5C,YAAa,KAGf3jB,KAAKu9D,0BAA2B,EAEhC,MAAMG,EAAuBC,IAAQC,QAAQzD,GACzCuD,IACF19D,KAAKm0B,OAAO,CAAEzP,YAAag5C,IAC3B19D,KAAKu9D,0BAA2B,EAChCI,IAAQnhE,OAAO29D,IAGjBn6D,KAAK69D,6BAiCPhtD,YAKE,OAJK7Q,KAAK3K,eAAe6kE,KACvBl6D,KAAKk6D,GAAyB1pC,KAAKsd,MAAM0qB,aAAaC,QAAQwB,KAGzDj6D,KAAKk6D,GAGdjzD,2BACE,OAAIjH,KAAK6Q,MAAM6T,YAAYC,MAClBM,IAAUjlB,KAAK6Q,MAAM6T,YAAYC,OAAOxL,IAExC,KAIX2kD,iCACE99D,KAAK+9D,iBAAiB,6BAGxBC,wBACEh+D,KAAKm0B,OAAO,CACV4mC,SAAU,CAAEM,YAAY,EAAOD,WAAW,EAAOE,eAAe,EAAOC,WAAW,EAAOG,WAAY,KAIzGuC,iBACE,MAAMC,EAAoBl+D,KAAK6Q,MAAMkqD,SAASW,YAAc,EAC5D17D,KAAKm0B,OAAO,CAAE4mC,SAAU,CAAEW,WAAYwC,EAAoB,KAI5DC,oBAAoB/gB,EAAQ75C,GAC1BvD,KAAKm0B,OAAO,CAAEgpC,cAAe,CAAC,CAAE/f,SAAQ75C,WAG1C66D,qBAAqBv2C,GACnB,IAAK,IAAI/yB,EAAI,EAAGA,EAAIkL,KAAK6Q,MAAMssD,cAAcnoE,OAAQF,IAAK,CACxD,MAAMsoD,OAAEA,EAAF75C,KAAUA,GAASvD,KAAK6Q,MAAMssD,cAAcroE,GAEnC,qBAAXsoD,GACFv1B,EAAQ7B,KAAKziB,EAAKigC,MAAOjgC,EAAKupB,QAIlC9sB,KAAKq+D,qBAGPA,qBACEr+D,KAAK+9D,iBAAiB,iBAGxBA,iBAAiBhmE,GACf,MACMo8B,EAAS,GACfA,EAAOp8B,GAAO,GAEdiI,KAAKm0B,OAAOA,EAAQ,CAAEmqC,WAJC,CAACC,EAAkBC,IAAgBA,IAO5DrqC,OAAOsqC,EAAUC,GACf,MAAMC,EAAahX,YAAM3nD,KAAK6Q,MAAO4tD,EAAUC,IACzCE,MAAEA,GAAUxE,EAAUyE,SAASF,EAAYrE,GAEjD,IAAKsE,EAGH,MAAM,IAAIv7D,MAAO,4CAWnB,OARAm1D,aAAaiF,QAAQxD,EAAiBzpC,KAAKC,UAAUkuC,WAC9C3+D,KAAKk6D,QAEa3kD,IAArBkpD,EAASjE,SACXx6D,KAAK4F,cAAc,IAAIC,YAAY,mBAErC7F,KAAK4F,cAAc,IAAIC,YAAY,iBAE5B84D,wBC1TXnoE,EAAAD,QAAiBJ,EAAAiC,EAAuB,kFCAxC5B,EAAAD,QAAiBJ,EAAAiC,EAAuB,sFCAxC5B,EAAAD,QAAiBJ,EAAAiC,EAAuB,kGCEjC,SAASqwB,EAAgBb,GAC9B,MAAMU,EAAWV,EAAGC,QAAQU,GAAG,UACzBi7B,EAAW57B,EAAGiL,WAAW4wB,UAAY77B,EAAGiL,WAAW4wB,SAASjvD,KAAKkvD,OACjEob,IAAcl3C,EAAGiL,WAAW,iBAC5BksC,EACJrmE,OAAOqO,IAAI0J,WAAWiyC,IAAI,2BAA6Bc,GAAY9qD,OAAOqO,IAAI0J,WAAWiyC,IAAI,gBAC/F,OAAQoc,IAActb,GAAYl7B,IAAay2C,EAG1C,SAASA,EAAQ51C,GACtB,MAAMq6B,EAAWr6B,EAAO0J,WAAW4wB,UAAYt6B,EAAO0J,WAAW4wB,SAASjvD,KAAKkvD,OACzEsb,EAAoB71C,GAAUA,EAAO0J,WAAWd,WAAa5I,EAAO0J,WAAWd,UAAUv9B,KAAKi9B,SAC9Fwa,EAAiC,yBAAtB+yB,EACXC,EAA8B,sBAAtBD,EAEd,OADyB71C,EAAO0J,WAAWe,MAAQzK,EAAO0J,WAAWe,KAAKp/B,KAAK0qE,gBAG5ExmE,OAAOqO,IAAI0J,WAAWiyC,IAAI,2BACvBc,GAAY9qD,OAAOqO,IAAI0J,WAAWiyC,IAAI,mBACtCzW,GAAYvzC,OAAOqO,IAAI0J,WAAWiyC,IAAI,oBACtCuc,GAASvmE,OAAOqO,IAAI0J,WAAWiyC,IAAI,kBAI3C,SAASyc,EAAkB/uD,EAAWgX,GACpC,MAAMg4C,EAAqC,iBAAdhvD,EACvBggC,EAAgBgvB,EAAgBhvD,EAAYA,EAAUA,UAE5D,OAAIgvD,EACKh4C,EAAOyL,WAAWiD,UAAUupC,GAAmBA,IAAoBjvB,GAEnEhpB,EAAOyL,WAAWiD,UACvBupC,GAAmBA,EAAgBjvD,YAAcggC,GAAiBivB,EAAgBlnE,WAAaiY,EAAUjY,UAlC/GhC,EAAAY,EAAA6M,EAAA,sBAAA6kB,IAAAtyB,EAAAY,EAAA6M,EAAA,sBAAAm7D,IAAA5oE,EAAAY,EAAA6M,EAAA,sBAAA07D,IAAAnpE,EAAAY,EAAA6M,EAAA,sBAAA27D,IAuCA,IAAIC,EAAuB,KAoB3B,SAASC,EAAoBhuC,EAAUj9B,GACR,OAAzBgrE,GApBN,WAQEA,EAAuB,GACvB,MAAME,WAAEA,GAAelrC,IAAImrC,QAC3B,IAAK,MAAMluC,KAAYiuC,EAAY,CACjC,IAAKA,EAAWrqE,eAAeo8B,GAAW,SAC1C,MAAMrK,EAASs4C,EAAWjuC,GAC1B+tC,EAAqB/tC,IAAarK,EAAOw4C,yBAA2B,IACjEhgE,IAAIigE,GAA0BV,EAAkBU,EAAwBz4C,IACxExnB,IAAI7C,GAASA,EAAMmK,aAMtB44D,GAEF,MAAMC,EAAuBP,EAAqB/tC,GAClD,IAAK,MAAM10B,KAASvI,EAAKq+B,WAClBr+B,EAAKq+B,WAAWx9B,eAAe0H,KAC/BgjE,EAAqBjgD,SAAS/iB,KACjCvI,EAAKq+B,WAAW91B,GAAS,OAG7B,OAAOvI,EAGT,SAASwrE,EAA4BC,EAAgBC,EAAQC,GAC3D,MAAM1uC,SAAEA,EAAFtR,QAAYA,EAAZqjC,SAAqBA,GAAayc,EAClCG,EAAYF,IAAW//C,EAE7B,QAAIsR,EAAS/kB,SAAS,sBAEX+kB,EAAS/kB,SAAS,WACpB0zD,EACE3uC,EAAS/kB,SAAS,YAClB82C,GAAY2c,EAAkBE,eAAiBD,GAAaD,EAAkBG,sBAC9E7uC,EAAS/kB,SAAS,WACpB0zD,GAAaD,EAAkBI,gBAC7B9uC,EAAS/kB,SAAS,UAAW+kB,EAAS/kB,SAAS,eACjD0zD,GAAaD,EAAkBK,gBAM1C,SAASC,EAAmCnQ,GAC1C,MAAMoQ,EAAclsC,IAAImsC,WAAWC,QAAQC,2BAA2BvQ,GAEtE,GAAIoQ,EAAa,CACf,MAAMjvC,SAAEA,EAAFtR,QAAYA,GAAYugD,EACxBt5C,EAASoN,IAAImrC,QAAQD,WAAWjuC,GAChCqvC,EAAoBJ,EAAY7tC,WAAWssC,EAAkB,WAAY/3C,IAE/E,MAAO,CAAEqK,WAAUtR,UAASqjC,SADXsd,GAAqBA,EAAkBpd,QAI1D,MAAMv6B,EAASqL,IAAIqV,SAASk3B,UAAUzQ,GACtC,IAAKnnC,EAAQ,OAAO,KAEpB,MAAMsI,SAAEA,EAAFtR,QAAYA,GAAYgJ,EAAO0J,WAAWd,UAAUv9B,KAE1D,MAAO,CAAEi9B,WAAUtR,UAASqjC,SADXr6B,EAAO0J,WAAW4wB,UAAYt6B,EAAO0J,WAAW4wB,SAASjvD,KAAKkvD,QAIjF,SAASsd,EAA+BxsE,EAAM0rE,EAAQC,GACpD,MAAMF,EAAiBQ,EAAmCjsE,EAAK87D,WAC/D,IAAK2P,EAAgB,OAAO,EAE5B,GAAID,EAA4BC,EAAgBC,EAAQC,GACtD,OAAO,EACF,CACL,MAAM1uC,SAAEA,GAAawuC,EAErB,OADAR,EAAoBhuC,EAAUj9B,IACvB,GASX,MAAMysE,EAAkB,GACxB,SAASC,EAAoB91C,EAAS+1C,GACpC,GAAKF,EAAgBE,EAAW7Q,WAOzB,CACL,MAAM8Q,EAAcH,EAAgBE,EAAW7Q,WAAW97D,KACpD6sE,EAAoBD,EAAYvuC,WACtC19B,OAAOuO,OAAO09D,EAAaD,GAC3BC,EAAYvuC,WAAa19B,OAAOuO,OAAO29D,EAAmBF,EAAWtuC,iBAVrEouC,EAAgBE,EAAW7Q,WAAa,CACtCgR,SAAU,IACV9sE,KAAM2sE,EACN1sC,SAAUrJ,EAAQqJ,SAClB8sC,gBAAiBn2C,EAAQm2C,iBAU/B,MAAMC,EAAc,GACb,SAASlC,EAA2Bl0C,GACzC,MAAMk2C,SAAEA,EAAFC,gBAAYA,GAAoBn2C,EAEtC,GAAiB,MAAbk2C,GAAoBl2C,EAAQ52B,KAAKitE,cAAgBr2C,EAAQ52B,KAAK67D,WAEhE,OAAOjlC,EAGT,MAAMs2C,EAAgBhpE,OAAOqO,IAAI0J,WAAWC,SAASG,MAAM0wD,GAE3D,IAAKG,EAGH,OAAOF,EAGT,MAAMrB,EAAoBuB,EAAc1wD,MAAM,GAAGyxC,YAEjD,GAAiB,OAAb6e,EAAmB,CACrB,IAAIK,GAAe,EACfC,GAAa,EACjB,IAAK,MAAM7kE,KAASquB,EAAQ52B,KAAKuC,EAAG,CAClC,IAAKq0B,EAAQ52B,KAAKuC,EAAE1B,eAAe0H,GAAQ,SAC3C,MAAMokE,EAAa/1C,EAAQ52B,KAAKuC,EAAEgG,GAClC,GAAIokE,EAAW9Q,aAAe77B,IAAIqV,SAASk3B,UAAUI,EAAW7Q,WAC9D4Q,EAAoB91C,EAAS+1C,GAC7B/1C,EAAQ52B,KAAKuC,EAAEgG,GAAS,KACxB6kE,GAAa,MACR,CACyBZ,EAA+BG,EAAYI,EAAiBpB,KAExF/0C,EAAQ52B,KAAKuC,EAAEgG,GAAS,KACxB4kE,GAAe,IASrB,OAJIA,GAAgBC,KAClBx2C,EAAQ52B,KAAKuC,EAAIq0B,EAAQ52B,KAAKuC,EAAE+N,OAAO4V,GAAU,MAALA,IAGvC0Q,EACF,GAAiB,MAAbk2C,EAAkB,CAC3B,GAAIl2C,EAAQ52B,KAAK67D,aAAe77B,IAAIqV,SAASk3B,UAAU31C,EAAQ52B,KAAK87D,WAElE,OADA2Q,EAAgB71C,EAAQ52B,KAAK87D,WAAallC,EACnCo2C,EAGP,OAD8BR,EAA+B51C,EAAQ52B,KAAM+sE,EAAiBpB,GAEnF/0C,EAEAo2C,EAGN,GAAiB,MAAbF,EAAkB,CAC3B,MAAMrB,EAAiBQ,EAAmCr1C,EAAQ52B,KAAK87D,WACvE,OAAK2P,GACDD,EAA4BC,EAAgBsB,EAAiBpB,GACxD/0C,EAFmBo2C,EAQ5B,OAAOp2C,EAIX,MAAMy2C,EAAuB,eACtB,SAAStC,EAAoBjP,GAC7B2Q,EAAgB3Q,KACrB97B,IAAImsC,WAAWC,QAAQkB,OAAOxC,EAA2B2B,EAAgB3Q,IAAauR,UAC/EZ,EAAgB3Q,yBC1NzB95D,EAAAD,QAAA,CAAkBkrB,YAAA,+BAAAG,YAAA,+BAAAX,aAAA,gCAAAG,cAAA,iCAAAlC,GAAA,sBAAA4B,YAAA,+BAAAL,aAAA,gCAAAC,KAAA,wBAAAC,UAAA,6BAAAC,KAAA,wBAAAkB,KAAA,wBAAA9qB,KAAA,wBAAA+qB,YAAA,+BAAAzB,WAAA,8BAAAC,iBAAA,oCAAAyB,MAAA,yBAAAC,SAAA,4BAAAjB,cAAA,iCAAApC,YAAA,iECDlBzoB,EAAAY,EAAA6M,EAAA,sBAAA+hB,IAAA,IAAAo8C,EAAA5rE,EAAA,IAAA6rE,EAAA7rE,EAAA8B,EAAA8pE,GAAAE,EAAA9rE,EAAA,GAGA,MAAM+rE,EAAKxpE,OAAOwpE,GAEH,SAASv8C,EAAkBw8C,EAAaC,GACrD,MAAMC,EAAY19D,IAAQ29D,WACpBC,EAAe59D,IAAQ69D,eAEzBH,IACF9pE,QAAQQ,IAAI,yBAA2BspE,GACvCI,IAAMxpC,OAAOopC,GAAWK,WAGtBR,GAAMK,IACRhqE,QAAQQ,IAAI,kCAAoCwpE,GAEhDL,EAAG,SAAUK,EAAc,QAEvBJ,GACFD,EAAG,MAAO,OAAQC,GAGhBC,GACFF,EAAG,MAAO,QAASE,GAGrBF,EAAG,OAAQ,kCC3Bf1rE,EAAAD,QAAiBJ,EAAAiC,EAAuB,4ECAxC5B,EAAAD,QAAiBJ,EAAAiC,EAAuB,8FCAxCjC,EAAAY,EAAA6M,EAAA,sBAAA86C,IAAAvoD,EAAAY,EAAA6M,EAAA,sBAAAg7C,IAKA,MAAM+jB,EAAqB,WACzB,MAAMC,EAAS,IAAI5wD,MAAMynC,KACzB,OAAO,SAAStiC,EAAM/E,GAWpB,OAVAA,EAAOqpC,YACPtkC,EAAKX,SAASvD,IACZ,MAAME,EAAWF,EAAKE,SACN,MAAZA,IAC0B,MAAxBA,EAASuU,aACXvU,EAASuoC,qBAEXtpC,EAAOwpC,MAAMgnB,EAAO3uD,KAAKd,EAASuU,aAAai0B,aAAa1oC,EAAKV,iBAG9DH,GAbgB,GAiBrBmT,EAAW,IAAIvT,MAAMsyC,MACpB,SAAS5F,EAAOv1B,EAAQ05C,EAASC,GACtC,MAAM9oD,EAAM,IAAIhI,MAAMynC,KAuBtB,OArBAl0B,EAAStR,KAAKkV,EAAOrV,SAASyR,UAC9B4D,EAAOrV,SAASyR,SAASrlB,IAAI,EAAG,EAAG,GAEnCipB,EAAOrV,SAASzB,gBAAe,GAAM,GACrCwwD,EAAQxwD,gBAAe,GAAM,GAC7BwwD,EAAQn3B,mBAAkB,GAE1Bi3B,EAAkBE,EAAS7oD,GAEtBA,EAAI+oD,YACFD,IACH35C,EAAOrV,SAASkvD,aAAahpD,EAAIQ,KACjC2O,EAAOrV,SAASkvD,aAAahpD,EAAIK,MAEnC8O,EAAOrV,SAASyR,SAAStR,KAAKsR,GAC9B4D,EAAOrV,SAAS0R,mBAAoB,GAGtCq9C,EAAQniC,wBAAyB,EACjCmiC,EAAQxwD,iBAED2H,EAGF,SAAS4kC,EAAoB5pD,EAAQglB,GAC1C,GAAIA,EAAI+oD,UAAW,OAAO,EAE1B,MAAM1oD,IAAEA,EAAFG,IAAOA,GAAQR,EACfipD,EAAK7oD,KAAKE,IAAID,EAAIK,EAAIF,EAAIE,GAC1BwoD,EAAK9oD,KAAKE,IAAID,EAAIE,EAAIC,EAAID,GAC1B4oD,EAAK/oD,KAAKE,IAAID,EAAIc,EAAIX,EAAIW,GAEhC,OAAOnmB,EAD0BolB,KAAKC,IAAI4oD,EAAIC,EAAIC,wBCzDpD3sE,EAAAD,QAAiBJ,EAAAiC,EAAuB,gGCAzB,SAASgrE,IACtB,OAAO,IAAIzsE,QAAQC,IACjBynB,WAAWznB,EAAS,KAFxBT,EAAAY,EAAA6M,EAAA,sBAAAw/D,ufCUApxD,MAAMkB,KAAK9d,UAAUiuE,QAAUC,IA0C/B,MAAMC,EAAY,IAxClB,MAAgBtnD,0BAAAjc,OAAA,UACN,IAAIH,iGAEZK,IAAIiS,EAAKzH,GAKP,OAJA1K,KAAKwjE,MAAMtjE,IAAIiS,EAAK,CAClBzH,OACA+4D,MAAO,IAEFzjE,KAAK0jE,OAAOvxD,GAGrBnE,IAAImE,GACF,OAAOnS,KAAKwjE,MAAMx1D,IAAImE,GAGxB9a,IAAI8a,GACF,OAAOnS,KAAKwjE,MAAMnsE,IAAI8a,GAGxBuxD,OAAOvxD,GACL,MAAMwxD,EAAY3jE,KAAKwjE,MAAMnsE,IAAI8a,GAEjC,OADAwxD,EAAUF,QACHE,EAGTC,QAAQzxD,GACN,MAAMwxD,EAAY3jE,KAAKwjE,MAAMnsE,IAAI8a,GAE5BwxD,GAKLA,EAAUF,QACNE,EAAUF,OAAS,IACrBE,EAAUj5D,KAAK8T,MAAMhI,SAASpF,KAC9BpR,KAAKwjE,MAAMt7D,OAAOiK,KAPlB5Z,QAAQC,iCAAiC2Z,OAYzC0xD,EAAgB,IAAIhkE,IAEpBikE,EAAiBlhE,YAAgB,IAAImhE,KAE3C,SAASC,EAAgBp8C,EAAIwoB,EAAe0f,GAC1C,IAAKztC,OAAOwQ,WAAWud,GACrB,MAAM,IAAI/sC,2BAA2B+sC,gCAEvC,GAAI/tB,OAAOwQ,WAAWud,GAAejC,UAAY16B,MAAM+lD,QAAQ1J,GAC7D,IAAK,IAAIh7D,EAAI,EAAGA,EAAIg7D,EAAc96D,OAAQF,IACxC8yB,EAAG7D,aAAaqsB,EAAgB,KAAOt7C,EAAGg7D,EAAch7D,SAG1D8yB,EAAG7D,aAAaqsB,EAAe0f,GAgCnC,SAASmU,EAAUv5D,GACjB,MAAO,CACL+L,WAAY/L,EAAK8T,MAAM/H,WACvB+H,MAAOlN,YAAc5G,EAAK8T,QAI9B,SAAS0lD,EAAkBjxD,GACzB,MAAMkxD,EACJlxD,EAAKmxD,SAASC,iBACbpxD,EAAKmxD,SAASC,eAAeC,qBAAuBrxD,EAAKmxD,SAASC,eAAeE,iBAI9EC,EAAmBvxD,EAAKmxD,SAASvxC,WAEvC,OAAOsxC,GAAkBK,EA5C3BniD,OAAOwtC,cAAgB,CAErBh9B,WAAY,GACZ1L,kBAAkBs9C,EAAcr0B,EAAes0B,GAC7CA,EAAWA,GAAYV,EACvB3hD,OAAOwtC,cAAch9B,WAAW4xC,GAAgB,CAAEC,WAAUt0B,mBAgDhE,MAAMu0B,EAAkB,SAASnS,EAAkBv/C,EAAM2xD,EAAWC,EAAQtiB,EAAoB,GAE5E,UAAdtvC,EAAKjc,KACPic,EAAKjc,KAAO,QACW,eAAdic,EAAKjc,KACdic,EAAKjc,KAAO,aACW,gBAAdic,EAAKjc,OACdic,EAAKjc,KAAO,cAId,MAAM8tE,EAAgB,GAChBzuD,EAAWpD,EAAKoD,SAASzd,MAAM,GACrC,IAAK,MAAM8iB,KAASrF,EAAU,CAC5B,MAAMuR,EAAK+8C,EAAgBnS,EAAkB92C,EAAOkpD,GAChDh9C,GACFk9C,EAAc5vE,KAAK0yB,GAIvB,MAAMm9C,EAAmBb,EAAkBjxD,GAG3C,OAD0B8xD,GAAoB9xD,EAAKjc,QAAQ4tE,KAClCE,EAAc9vE,SAAW6vE,EAChD,OAAO,KAGT,MAAMj9C,EAAKxe,SAASwT,cAAc,YAClCgL,EAAGyJ,OAAO17B,MAAMiyB,EAAIk9C,GAGpB,MAAM5nD,GAAajK,EAAKjc,MAAQic,EAAK+B,MAAM1J,QAAQ,UAAW,IAC9Dsc,EAAGI,UAAUoW,IAAIlhB,GAGW,QAAxBjK,EAAKsS,SAASy/C,OAChB/xD,EAAKsS,SAAS4/B,kBAAkBlyC,EAAKqB,WAAY,OAKnDsT,EAAG9T,SAASO,SAASJ,KAAKhB,EAAKoB,UAC/BuT,EAAG9T,SAASyR,SAAStR,KAAKhB,EAAKsS,UAC/BqC,EAAG9T,SAASjE,MAAMoE,KAAKhB,EAAKpD,OAAOqJ,eAAeqpC,GAClD36B,EAAG9T,SAAS0R,mBAAoB,EAEhCvS,EAAKu4B,kBAAmB,EACxBv4B,EAAKvW,OAAOmX,WACZZ,EAAKvW,OAAO8V,UAAUS,EAAKoB,SAAUpB,EAAKsS,SAAUtS,EAAKpD,OAEzD+X,EAAGipB,YAAY59B,EAAKkK,KAAKld,cAAegT,GACpC8xD,GAAoB,aAAcA,GACpCn9C,EAAGipB,YAAY,OAAQ59B,GAKzB2U,EAAG9T,SAAS9c,KAAOic,EAAKjc,KAMxB4wB,EAAG9T,SAASkB,KAAO/B,EAAK+B,KACxB/B,EAAK+B,KAAOhD,MAAMoI,KAAK6qD,eAEnBhyD,EAAKwD,aAKPxD,EAAKiB,OAAOuC,WAAaxD,EAAKwD,YAGhC,MAAMyuD,EAAYjyD,EAAKmxD,SAASc,UAKhC,YAJkB3vD,IAAd2vD,IACF1S,EAAiB0S,GAAat9C,GAGzBA,2BAGT,UAAiCu9C,EAAgB3S,GAC/C,IAAI4S,GAAmB,EACvB,MAAMC,EAAmB,GAEzBF,EAAerxD,SAAS0C,SAAxB,eAAA7N,EAAAjD,EAAiC,UAAMoO,GACrC,MAAMwxD,EAAkB,GACxBA,EAAgB9hE,QAAU,IAAI7M,QAAQC,GAAY0uE,EAAgB1uE,QAAUA,GAC5EyuE,EAAiBnwE,KAAKowE,GAEjBF,UACGC,EAAiB5vE,QAAQ+N,SAEjC4hE,GAAmB,EAEnB,MAAML,EAAmBb,EAAkBpwD,GACrC8T,EAAK9T,EAAS8T,GAEpB,GAAIm9C,GAAoBn9C,EACtB,IAAK,MAAM29C,KAAQR,EACjB,GAAIA,EAAiB1vE,eAAekwE,IAASljD,OAAOwtC,cAAch9B,WAAWx9B,eAAekwE,GAAO,CACjG,MAAMn1B,cAAEA,EAAFs0B,SAAiBA,GAAariD,OAAOwtC,cAAch9B,WAAW0yC,SAC9Db,EAAS98C,EAAIwoB,EAAe20B,EAAiBQ,GAAOR,EAAkBvS,GAKlF8S,EAAgB1uE,YAtBlB,gBAAA4uE,GAAA,OAAA78D,EAAAhT,MAAAqK,KAAA4H,YAAA,UAyBMy9D,EAAiB5vE,QAAQ+N,iCAGjC,SAASiiE,EAAetuD,EAAMngB,EAAM0uE,GAClC,MAAMC,EAAYxuD,EAAKyb,iBAAiB,IAAM57B,GAC9C,IAAK,MAAM4wB,KAAM+9C,EAAW,CAC1B,MAAMxuD,EAAOuuD,EAAarzC,WAAU,GAEpC,UAAA5sB,KAA8B0R,EAAKob,WAAY,OAApCv7B,KAAEA,EAAFS,MAAQA,GAA4BgO,EAC7CmiB,EAAG7D,aAAa/sB,EAAMS,GAIxB,KAAO0f,EAAKd,SAASrhB,OAAS,GAC5B4yB,EAAG3B,YAAY9O,EAAKd,SAAS,KAKnC,SAASuvD,EAA2B3yD,GAClC,OAAIA,EAAK4yD,YAAc5yD,EAAK4yD,WAAWvB,oBAC9BrxD,EAAK4yD,WAAWvB,oBACdrxD,EAAK4yD,YAAc5yD,EAAK4yD,WAAWtB,gBACrCtxD,EAAK4yD,WAAWtB,gBACdtxD,EAAKiN,QAAUjN,EAAKiN,OAAOmkD,gBAAkBpxD,EAAKiN,OAAOmkD,eAAeC,oBAC1ErxD,EAAKiN,OAAOmkD,eAAeC,yBAD7B,EAiDF,SAAewB,EAAtBr8D,EAAAC,EAAAC,EAAAoF,EAAAG,GAAA,OAAA62D,EAAApwE,MAAAqK,KAAA4H,mCAAO,UAAwBuK,EAAKyiB,EAAaoxC,EAAoB13C,EAAY23C,GAC/E,IACIC,EADA/4D,EAAUgF,EAGVyiB,IAAgBA,EAAY9U,SAAS,mBAAqB8U,EAAY9U,SAAS,mCACjFomD,QAAgBpC,EAAe32D,GAC/BA,EAAU+4D,EAAQ,eAGpB,MAAMC,EAAiB,IAAIn0D,MAAMo0D,eACjCD,EAAeE,eAAen5D,YAA+BC,IAC7D,MAAMm5D,EAAa,IAAIt0D,MAAMu0D,WAAWJ,GAElCK,QAAe,IAAI7vE,QAAQ,CAACC,EAASwM,IAAWkjE,EAAWG,aAAat5D,EAASvW,EAAS03B,EAAYlrB,IAE5GojE,EAAO/uC,cAAgBA,IAEnBwuC,IACFO,EAAOz1C,KAAOk1C,EAAiBO,EAAOz1C,OAGxC,IAAIX,EAAU,EAEZo2C,EAAOz1C,KAAK80C,YACZW,EAAOz1C,KAAK80C,WAAWvB,qBACvBkC,EAAOz1C,KAAK80C,WAAWvB,oBAAoBjvE,eAAe,aAE1D+6B,EAAUo2C,EAAOz1C,KAAK80C,WAAWvB,oBAAoBl0C,SArEzD,SAAsBA,EAASW,GAC7B,GAAIX,EAAU,EAAG,CAEf,MAAMs2C,EAAqB31C,EAAK1Z,MAAM7K,KAAKyG,IACzC,MAAM4f,EAAa+yC,EAA2B3yD,GAC9C,OAAO4f,GAAcA,EAAW8zC,aAAe9zC,EAAW,cAExD6zC,IACEA,EAAmBb,YAAca,EAAmBb,WAAWvB,2BAC1DoC,EAAmBb,WAAWvB,oBAAoBqC,YAChDD,EAAmBb,YAAca,EAAmBb,WAAWtB,uBACjEmC,EAAmBb,WAAWtB,gBAAgBoC,YAErDD,EAAmBxmD,QACnBwmD,EAAmBxmD,OAAOmkD,gBAC1BqC,EAAmBxmD,OAAOmkD,eAAeC,4BAElCoC,EAAmBxmD,OAAOmkD,eAAeC,qBAKtD,GAAIl0C,EAAU,GAERW,EAAK1Z,MACP,IAAK,MAAMpE,KAAQ8d,EAAK1Z,MAAO,CAC7B,MAAMwb,EAAa+yC,EAA2B3yD,GAE9C,IAAK4f,EACH,SAGF,MAAM8d,EAAQ9d,EAAW,eAAiBA,EAAW,eAEjD8d,GAAyB,IAAhBA,EAAMqF,QACjBrF,EAAMsF,MAAQ,IAoCtB2wB,CAAax2C,EAASo2C,EAAOz1C,MAE7B,MAAMvd,EAAYgzD,EAAOz1C,KAAKvd,UAC9B,GAAIA,EACF,IAAK,IAAI1e,EAAI,EAAGA,EAAI0e,EAAUxe,OAAQF,IAAK,CACzC,MAAMse,EAAWI,EAAU1e,GAE3B,GACEse,EAASyyD,YACTzyD,EAASyyD,WAAWgB,wBAC0CtxD,IAA9DnC,EAASyyD,WAAWgB,kBAAkBb,GACtC,CACA,MAAMc,EAAmB1zD,EAASyyD,WAAWgB,kBAAkBb,GAC/DxyD,EAAU1e,GAAK0e,EAAUszD,IAK/B,MAAMzvD,EAAQmvD,EAAOz1C,KAAK1Z,MAE1B,GAAIA,EACF,IAAK,IAAIviB,EAAI,EAAGA,EAAIuiB,EAAMriB,OAAQF,IAAK,CACrC,MAAMme,EAAOoE,EAAMviB,GAEdme,EAAKiN,SACRjN,EAAKiN,OAAS,IAGhBjN,EAAKiN,OAAOglD,UAAYpwE,EAI5B,MAAM4V,QAAa,IAAI/T,QAAQ6vE,EAAO14B,MAAM91C,KAAKwuE,IAsBjD,OApBA97D,EAAK8T,MAAMhI,SAASte,IAElBA,EAAOszC,iBAAmBx5B,MAAM64B,SAASk8B,wBAEzC7uE,EAAOkb,SAAWkiB,YAAap9B,EAAQkb,GACjCA,EAASuZ,wBAAiD,wBAAvBq5C,EAC9BgB,IAAuBC,qBAAqB7zD,GAG9CA,KAIP8yD,GAEF/wE,OAAO+xE,KAAKhB,GAASxyD,QAAQzH,IAAIk7D,iBAGnCz8D,EAAK8T,MAAM/H,WAAa/L,EAAK+L,WAEtB/L,2BAGF,SAAekzC,EAAtBwpB,GAAA,OAAAC,EAAA1xE,MAAAqK,KAAA4H,mCAAO,UAAyBuK,EAAKyiB,EAAc,KAAM9O,GAAW,EAAOmgD,EAAmB,MAC5F,MAAMD,EACJttE,OAAOqO,KAA8B,QAAvBrO,OAAOqO,IAAI2c,QAAoB,sBAAwB,uBAEvE,GAAIoC,EAAU,CACZ,GAAIy9C,EAAUv1D,IAAImE,GAEhB,OADAoxD,EAAUG,OAAOvxD,GACV8xD,EAAUV,EAAUlsE,IAAI8a,GAAKzH,MAEpC,GAAIm5D,EAAc71D,IAAImE,GAAM,CAC1B,MAAMzH,QAAam5D,EAAcxsE,IAAI8a,GAErC,OADAoxD,EAAUG,OAAOvxD,GACV8xD,EAAUv5D,GACZ,CACL,MAAMlH,EAAUsiE,EAAS3zD,EAAKyiB,EAAaoxC,EAAoB,KAAMC,GACrEpC,EAAc3jE,IAAIiS,EAAK3O,GACvB,MAAMkH,QAAalH,EAGnB,OAFAqgE,EAAc37D,OAAOiK,GACrBoxD,EAAUrjE,IAAIiS,EAAKzH,GACZu5D,EAAUv5D,IAIrB,OAAOo7D,EAAS3zD,EAAKyiB,EAAaoxC,EAAoB,KAAMC,4BAIhE,SAASqB,EAAan1D,GAEpB,GAAIA,GAAyB,MAAlBA,EAAIo1D,OAAO,GAAY,CAChC,MAAMC,EAAUp+D,SAASqa,eAAetR,EAAItI,UAAU,IACtD,GAAI29D,EACF,OAAOA,EAAQt/C,aAAa,OAGhC,OAAO/V,EASTkQ,OAAO8E,kBAAkB,kBAAmB,CAC1CC,OAAQ,CACNjV,IAAK,CAAEgL,KAAM,UACbyX,YAAa,CAAEzX,KAAM,UACrB2I,SAAU,CAAEwB,SAAS,GACrBvB,QAAS,CAAEuB,SAAS,GACpB+6B,MAAO,CAAE/6B,SAAS,GAClBi7B,kBAAmB,CAAEplC,KAAM,SAAUmK,QAAS,IAGhD/E,OAEEviB,KAAKimE,iBAAmB,KAExBjmE,KAAKynE,iBAGPtzC,SACEn0B,KAAK0nE,SAASJ,EAAatnE,KAAKxL,KAAK2d,KAAMnS,KAAKxL,KAAKogC,cAGvDp4B,SACMwD,KAAKxL,KAAK6tD,OAASriD,KAAK2nE,OAC1B3nE,KAAK4nB,GAAGC,QAAQC,QAAQ,gBAAgBH,mBAAmBigD,aAAa5nE,KAAK4nB,GAAG4c,YAAYhM,MAE9F,MAAMrmB,EAAMm1D,EAAatnE,KAAKxL,KAAK2d,KAC/BA,GACFoxD,EAAUK,QAAQzxD,IAItBs1D,gBACEznE,KAAK4kE,UAAY,GACjB5kE,KAAK4nB,GAAGgL,iBAAiB,qBAAqBlf,QAAQm0D,IACpD,MAAM1wD,EAAO/N,SAAS+oB,WAAW01C,EAAWz1C,mBAAqBy1C,EAAWznD,QAAQgS,mBAAmB,GACvGpyB,KAAK4kE,UAAUiD,EAAW3/C,aAAa,cAAgB/Q,KAIrDuwD,SAASv1D,EAAKyiB,GAAa,IAAAtvB,EAAAtF,KAAA,OAAA0F,EAAA,YAC/B,IACE,GAAIyM,IAAQ7M,EAAKwiE,QAAS,OAE1B,MAAMA,EAAUxiE,EAAKwiE,QAGrB,GAFAxiE,EAAKwiE,QAAU31D,GAEVA,EAKH,YAJI7M,EAAKyiE,aACPxvE,QAAQkd,KAAK,qEACbnQ,EAAK0iE,0BAKT1iE,EAAKsiB,GAAG5B,KAAK,iBACb,MAAMtb,QAAakzC,EAAUzrC,EAAKyiB,EAAatvB,EAAK9Q,KAAKsxB,SAAUxgB,EAAK2gE,kBAIxE,GAAI9zD,GAAO7M,EAAKwiE,QAAS,OAGzBxiE,EAAK0iE,wBAEL1iE,EAAKqiE,MAAQj9D,EAAK8T,OAAS9T,EAAKzG,OAAO,GAEnCqB,EAAK9Q,KAAK6tD,OACZ/8C,EAAKsiB,GAAGC,QAAQC,QAAQ,gBAAgBH,mBAAmBsgD,UAAU3iE,EAAKqiE,OAGxEj9D,EAAK+L,WAAWzhB,OAAS,GAC3BsQ,EAAKsiB,GAAG7D,aAAa,kBAAmB,IACxCze,EAAKsiB,GAAGiL,WAAW,mBAAmBse,UAAU7rC,EAAKqiE,MAAMlxD,aAE3CnR,EAAKqiE,MA/alBnxD,SAAS0e,IAEhB,MAAMgzC,EAAoBhzC,EAAIve,QAAUue,EAAI/hB,SAASg1D,iBAC/CC,EAAgBF,GAAqBhzC,EAAI/hB,SAASyD,WACxD,GAAIsxD,IAAsBE,GAAiBlzC,EAAI/hB,SAASof,WAAWle,SAAU,CAC3E,MAAMg0D,EAAMnzC,EAAI/hB,SACVm1D,EAAWD,EAAItrE,MAAQsrE,EAAItrE,MAAM0mE,MAAQ,EAAI4E,EAAI91C,WAAWle,SAASovD,MAAQ,EAI/E6E,EAAW,KAAQA,EAAW,MAEhCD,EAAIzxD,WAAa,IAAI2xD,IAAQrzC,EAAI/hB,SAAU,CAAEq1D,SAAU,EAAGC,SAAU,SAsatE,MAAMjW,EAAmB,GAEzB,IAAIkW,EAAgBpjE,EAAKqiE,MACzB,GACEriE,EAAK9Q,KAAKuxB,UACTzgB,EAAKyiE,WAAapD,EACjBnS,EACAltD,EAAKqiE,MACLriE,EAAKs/D,WACL,EACAt/D,EAAK9Q,KAAK+tD,oBAEZ,CASA,GARAj9C,EAAKsiB,GAAG3B,YAAY3gB,EAAKyiE,aAEzBW,EAAgBpjE,EAAKyiE,WAAWj0D,UAClBojB,SAAU,QAIlBksC,cACFjxD,GAAO7M,EAAKwiE,QAAS,0DAEnBa,CAAkBrjE,EAAKyiE,WAAYvV,GAEzC,IAAK,MAAMx7D,KAAQsO,EAAKs/D,UACtBa,EAAengE,EAAKsiB,GAAI5wB,EAAMsO,EAAKs/D,UAAU5tE,IAWjD,MAAM4xE,EAAU,GAEhBF,EAAclyD,SAAStf,IACrB,MAAM0wB,EAAK1wB,EAAE0wB,GACTA,GAAIghD,EAAQ1zE,KAAK,IAAOgC,EAAE0wB,GAAKA,KAGrC,MAAM23B,EAA0Bj6C,EAAKsiB,GAAGC,QAAQgL,WAAW,mBAEvD0sB,GACFA,EAAwB7yB,oBAAoBg8C,GAG1CZ,GACFvE,EAAUK,QAAQkE,GAEpBxiE,EAAKsiB,GAAGipB,YAAY,OAAQ63B,GAE5BE,EAAQl1D,QAAQm1D,GAAKA,KAErBH,EAAcxxC,SAAU,EACxB5xB,EAAKsiB,GAAG5B,KAAK,eAAgB,CAAEsG,OAAQ,OAAQq7C,MAAOriE,EAAKqiE,QAC3D,MAAOjxE,GACP6sE,EAAUK,QAAQzxD,GAClB5Z,QAAQC,MAAM,4BAA6B9B,EAAG4O,GAC9CA,EAAKsiB,GAAG5B,KAAK,cAAe,CAAEsG,OAAQ,OAAQna,UApGjBzM,IAwGjCsiE,wBACMhoE,KAAK+nE,aACP/nE,KAAK+nE,WAAW/kB,WAAWrpB,YAAY35B,KAAK+nE,YAE5C/nE,KAAK+nE,WAAWj0D,SAAS0C,SAASkE,IAC5BA,EAAEtH,UAAYsH,EAAEtH,SAAST,SAC3B+H,EAAEtH,SAAST,UAGT+H,EAAEvH,WACAuH,EAAEvH,SAASR,SACb+H,EAAEvH,SAASR,UAGb+H,EAAEvH,SAASyD,WAAa,eAIrB5W,KAAK+nE,WAEZ/nE,KAAK4nB,GAAGm3B,gBAAgB,wDCxlBvB,SAAS7b,EAA0B/Z,EAAQinB,GAChD,KAAOjnB,KAAYA,EAAO0J,aAAc1J,EAAO0J,WAAWud,KACxDjnB,EAASA,EAAO65B,WAElB,OAAO75B,EAJThzB,EAAAY,EAAA6M,EAAA,sBAAAs/B,iDCAA,MAAM4lC,EAAa,CACjB,OACA,WACA,aACA,YACA,eACA,WACA,SACA,YACA,WACA,cACA,QACA,UACA,UACA,OACA,SACA,UACA,WACA,SACA,WACA,aACA,WACA,SACA,UACA,UACA,OACA,QACA,QACA,UACA,OACA,YACA,WACA,SACA,WACA,OACA,WACA,WACA,SACA,QACA,YACA,MACA,WACA,SACA,UACA,QACA,WACA,WACA,QACA,QACA,MACA,QACA,YACA,OACA,UACA,SACA,cACA,WACA,UACA,YACA,UACA,WACA,YACA,UACA,aACA,SACA,WACA,UACA,WACA,SACA,YACA,UACA,QACA,OACA,OACA,QACA,YACA,QACA,SACA,SACA,QACA,UACA,aACA,SACA,cACA,YACA,WACA,OACA,QACA,WACA,UACA,WACA,WACA,cACA,cACA,OACA,SACA,QACA,YACA,UACA,WACA,SACA,WACA,eACA,aACA,OACA,SACA,MACA,WACA,SACA,QACA,SACA,UACA,QACA,QACA,SACA,SACA,WACA,OACA,UACA,aACA,aACA,YACA,YACA,UACA,SACA,UACA,aACA,aACA,OACA,YACA,WACA,WACA,SACA,YACA,WACA,aACA,aACA,cACA,UACA,UACA,OACA,QACA,QACA,SACA,OACA,WACA,OACA,YACA,QACA,UACA,UACA,WACA,QACA,WACA,YACA,QACA,YACA,QACA,OACA,YACA,aACA,QACA,SACA,SACA,QACA,QACA,QACA,MACA,QACA,WACA,QACA,WACA,QACA,WACA,UACA,SACA,OACA,QACA,MACA,UACA,QACA,UACA,QACA,QACA,QACA,WACA,WACA,SACA,WACA,WACA,cACA,gBACA,WACA,aACA,QACA,aACA,YACA,cACA,WACA,aACA,UACA,YACA,UACA,YACA,YACA,aACA,YACA,WACA,OACA,WACA,OACA,YACA,QACA,SACA,WACA,WACA,SACA,SACA,OACA,WACA,WACA,UACA,YACA,SACA,UACA,YACA,aACA,QACA,SACA,eACA,UACA,QACA,SACA,UACA,YACA,OACA,MACA,UACA,UACA,WACA,WACA,QACA,QACA,WACA,SACA,WACA,WACA,aACA,SACA,aACA,cACA,SACA,aACA,WACA,SACA,SACA,OACA,QACA,SACA,SACA,SACA,UACA,OACA,WACA,QACA,aACA,SACA,UACA,UACA,WACA,YACA,YACA,QACA,UACA,YACA,QACA,SACA,UACA,UACA,UACA,UACA,OACA,QACA,OACA,SACA,YACA,UACA,YACA,cACA,WACA,UACA,eACA,SACA,OACA,cACA,WACA,YACA,SACA,WACA,UACA,YACA,UACA,WACA,WACA,SACA,YACA,UACA,OACA,WACA,QACA,YACA,WACA,WACA,QACA,QACA,SACA,OACA,YACA,SACA,eACA,aACA,WACA,SACA,SACA,YACA,SACA,OACA,WACA,YACA,QACA,QACA,OACA,OACA,QACA,SACA,UACA,UACA,SACA,UACA,OACA,WACA,UACA,WACA,YACA,WACA,UACA,cACA,QACA,YACA,OACA,QACA,WACA,OACA,QACA,OACA,gBACA,UACA,YACA,cACA,SACA,QACA,SACA,WACA,WACA,WACA,WACA,OACA,UACA,OACA,QACA,SACA,SACA,SACA,WACA,SACA,SACA,OACA,OACA,UACA,UACA,QACA,SACA,eACA,cACA,WACA,UACA,cACA,SACA,YACA,SACA,cACA,aACA,YACA,SACA,QACA,SACA,WACA,QACA,UACA,WACA,YACA,YACA,cACA,QACA,OACA,YACA,YACA,YACA,YACA,aACA,YACA,WACA,QACA,OACA,WACA,QACA,WACA,aACA,SACA,WACA,WACA,SACA,YACA,UACA,UACA,aACA,MACA,OACA,aACA,WACA,WACA,YACA,cACA,QACA,QACA,UACA,gBACA,WACA,OACA,UACA,SACA,SACA,SACA,aACA,SACA,UACA,WACA,WACA,SACA,UACA,UACA,WACA,UACA,QACA,aACA,aACA,QACA,iBACA,UACA,SACA,SACA,WACA,SACA,QACA,SACA,QACA,cACA,WACA,UACA,SACA,WACA,WACA,QACA,UACA,YACA,aACA,aACA,SACA,SACA,UACA,SACA,UACA,QACA,YACA,SACA,UACA,WACA,WACA,YACA,aACA,UACA,YACA,YACA,QACA,UACA,SACA,WACA,OACA,UACA,SACA,WACA,QACA,QACA,OACA,cACA,YACA,WACA,UACA,WACA,SACA,cACA,SACA,SACA,WACA,OACA,WACA,QACA,QACA,UACA,QACA,QACA,SACA,YACA,SACA,cACA,cACA,QACA,QACA,QACA,QACA,WACA,WACA,YACA,eACA,aACA,aACA,OACA,aACA,cACA,YACA,SACA,QACA,UACA,WACA,OACA,OACA,UACA,WACA,SACA,aACA,SACA,UACA,UACA,SACA,QACA,QACA,SACA,aACA,YACA,QACA,QACA,cACA,UACA,WACA,cACA,SACA,WACA,OACA,SACA,OACA,SACA,WACA,QACA,QACA,UACA,aACA,SACA,WACA,MACA,QACA,YACA,UACA,OACA,UACA,OACA,WACA,OACA,QACA,UACA,QACA,OACA,SACA,WACA,SACA,OACA,UACA,SACA,cACA,YACA,UAGIC,EAAQ,CACZ,QACA,OACA,QACA,WACA,QACA,OACA,SACA,QACA,YACA,SACA,eACA,WACA,QACA,SACA,WACA,QACA,SACA,UACA,OACA,SACA,SACA,UACA,OACA,OACA,OACA,QACA,OACA,QACA,YACA,SACA,OACA,SACA,SACA,WACA,YACA,cACA,SACA,YACA,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","file":"assets/js/scene-b328b447a4f0cb73fa7f.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t8: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"assets/js/\" + ({}[chunkId]||chunkId) + \"-\" + {}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// The chunk loading function for additional chunks\n \t// Since all referenced chunks are already included\n \t// in this file, this function is empty here.\n \t__webpack_require__.e = function requireEnsure() {\n \t\treturn Promise.resolve();\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/custom-hubs-template/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1415,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export const paths = {};\r\npaths.noop = \"/noop\";\r\npaths.actions = {};\r\npaths.actions.log = \"/actions/log\";\r\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\r\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\r\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\r\npaths.actions.angularVelocity = \"/actions/angularVelocity\";\r\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\r\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\r\npaths.actions.debugUserInput = {};\r\npaths.actions.debugUserInput.describeCurrentMasks = \"/actions/debugUserInput/describeCurrentMasks\";\r\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\r\npaths.actions.lobbyCameraDelta = \"/actions/lobbyCameraDelta\";\r\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\r\npaths.actions.dCharSpeed = \"/actions/dCharSpeed\";\r\npaths.actions.boost = \"/actions/boost\";\r\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\r\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\r\npaths.actions.spawnPen = \"/actions/spawnPen\";\r\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\r\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\r\npaths.actions.thaw = \"/actions/thaw\";\r\npaths.actions.muteMic = \"/actions/muteMic\";\r\npaths.actions.toggleFly = \"/actions/toggleFly\";\r\npaths.actions.toggleUI = \"/actions/toggleUI\";\r\npaths.actions.waypointDeltaDistance = \"/actions/waypointDeltaDistance\";\r\npaths.actions.focusChat = \"/actions/focusChat\";\r\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\r\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\r\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\r\npaths.actions.mediaExit = \"/actions/mediaExit\";\r\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\r\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\r\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\r\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\r\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\r\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\r\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\r\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\r\npaths.actions.transformModifier = \"/actions/transformModifier\";\r\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\r\npaths.actions.cursor = {};\r\npaths.actions.cursor.right = {};\r\npaths.actions.cursor.right.pose = \"/actions/cursor/right/Pose\";\r\npaths.actions.cursor.right.hideLine = \"/actions/cursor/right/HideLine\";\r\npaths.actions.cursor.right.grab = \"/actions/cursor/right/Grab\";\r\npaths.actions.cursor.right.drop = \"/actions/cursor/right/Drop\";\r\npaths.actions.cursor.right.modDelta = \"/actions/cursor/right/ModDelta\";\r\npaths.actions.cursor.right.startDrawing = \"/actions/cursor/right/StartDrawing\";\r\npaths.actions.cursor.right.stopDrawing = \"/actions/cursor/right/StopDrawing\";\r\npaths.actions.cursor.right.undoDrawing = \"/actions/cursor/right/UndoDrawing\";\r\npaths.actions.cursor.right.penNextColor = \"/actions/cursor/right/PenNextColor\";\r\npaths.actions.cursor.right.penPrevColor = \"/actions/cursor/right/PenPrevColor\";\r\npaths.actions.cursor.right.scalePenTip = \"/actions/cursor/right/ScalePenTip\";\r\npaths.actions.cursor.right.scaleGrabbedGrabbable = \"/actions/cursor/right/ScaleGrabbedGrabbable\";\r\npaths.actions.cursor.right.mediaVolumeMod = \"/actions/cursor/right//mediaVolumeMod\";\r\npaths.actions.cursor.right.takeSnapshot = \"/actions/cursor/right/TakeSnapshot\";\r\npaths.actions.cursor.right.wake = \"/actions/cursor/right/wake\";\r\npaths.actions.cursor.left = {};\r\npaths.actions.cursor.left.pose = \"/actions/cursor/left/Pose\";\r\npaths.actions.cursor.left.hideLine = \"/actions/cursor/left/HideLine\";\r\npaths.actions.cursor.left.grab = \"/actions/cursor/left/Grab\";\r\npaths.actions.cursor.left.drop = \"/actions/cursor/left/Drop\";\r\npaths.actions.cursor.left.modDelta = \"/actions/cursor/left/ModDelta\";\r\npaths.actions.cursor.left.startDrawing = \"/actions/cursor/left/StartDrawing\";\r\npaths.actions.cursor.left.stopDrawing = \"/actions/cursor/left/StopDrawing\";\r\npaths.actions.cursor.left.undoDrawing = \"/actions/cursor/left/UndoDrawing\";\r\npaths.actions.cursor.left.penNextColor = \"/actions/cursor/left/PenNextColor\";\r\npaths.actions.cursor.left.penPrevColor = \"/actions/cursor/left/PenPrevColor\";\r\npaths.actions.cursor.left.scalePenTip = \"/actions/cursor/left/ScalePenTip\";\r\npaths.actions.cursor.left.scaleGrabbedGrabbable = \"/actions/cursor/left/ScaleGrabbedGrabbable\";\r\npaths.actions.cursor.left.mediaVolumeMod = \"/actions/cursor/left//mediaVolumeMod\";\r\npaths.actions.cursor.left.takeSnapshot = \"/actions/cursor/left/TakeSnapshot\";\r\npaths.actions.cursor.left.wake = \"/actions/cursor/left/wake\";\r\npaths.actions.pen = {};\r\npaths.actions.pen.remove = \"/actions/pen/remove\";\r\npaths.actions.rightHand = {};\r\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\r\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\r\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\r\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\r\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\r\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\r\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\r\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\r\npaths.actions.rightHand.switchDrawMode = \"/actions/rightHandSwitchDrawMode\";\r\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\r\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\r\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\r\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\r\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\r\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\r\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\r\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\r\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\r\npaths.actions.leftHand = {};\r\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\r\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\r\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\r\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\r\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\r\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\r\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\r\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\r\npaths.actions.leftHand.switchDrawMode = \"/actions/leftHandSwitchDrawMode\";\r\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\r\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\r\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\r\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\r\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\r\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\r\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\r\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\r\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\r\npaths.actions.camera = {};\r\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\r\npaths.actions.startInspecting = \"/actions/startInspecting\";\r\npaths.actions.stopInspecting = \"/actions/stopInspecting\";\r\npaths.actions.inspectZoom = \"/actions/inspectZoom\";\r\npaths.actions.inspectPanY = \"/actions/inspectPanY\";\r\npaths.actions.resetInspectView = \"/actions/resetInspectView\";\r\npaths.actions.nextCameraMode = \"/actions/nextCameraMode\";\r\npaths.haptics = {};\r\npaths.haptics.actuators = {};\r\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\r\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\r\n\r\npaths.device = {};\r\npaths.device.mouse = {};\r\npaths.device.mouse.coords = \"/device/mouse/coords\";\r\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\r\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\r\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\r\npaths.device.mouse.buttonMiddle = \"/device/mouse/buttonMiddle\";\r\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\r\npaths.device.smartMouse = {};\r\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\r\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\r\npaths.device.smartMouse.shouldMoveCamera = \"/device/smartMouse/shouldMoveCamera\";\r\npaths.device.touchscreen = {};\r\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\r\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\r\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\r\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\r\npaths.device.touchscreen.pinch = {};\r\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\r\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\r\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\r\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\r\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\r\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\r\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\r\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\r\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\r\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\r\npaths.device.touchscreen.anything = \"/device/touchscreen/anything\";\r\npaths.device.gyro = {};\r\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\r\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\r\npaths.device.hud = {};\r\npaths.device.hud.penButton = \"/device/hud/penButton\";\r\n\r\npaths.device.keyboard = {\r\n  map: new Map(),\r\n  key: function(k) {\r\n    let path = this.map.get(k);\r\n    if (path) {\r\n      return path;\r\n    }\r\n    path = `/device/keyboard/${k === \" \" ? \"space\" : k.toLowerCase()}`;\r\n    this.map.set(k, path);\r\n    return path;\r\n  }\r\n};\r\n\r\npaths.device.gamepad = gamepadIndex => ({\r\n  button: buttonIndex => ({\r\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\r\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\r\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\r\n  }),\r\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\r\n});\r\n\r\nconst xbox = \"/device/xbox/\";\r\npaths.device.xbox = {\r\n  v: name => `/vars/xbox/${name}`,\r\n  button: buttonName => ({\r\n    pressed: `${xbox}button/${buttonName}/pressed`,\r\n    touched: `${xbox}button/${buttonName}/touched`,\r\n    value: `${xbox}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${xbox}axis/${axisName}`;\r\n  },\r\n  axesSum: `${xbox}axis/sum`\r\n};\r\n\r\npaths.device.oculusgo = {\r\n  // TODO remove these in favor of the direct accessors\r\n  button: buttonName => ({\r\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\r\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\r\n    value: `/device/oculusgo/button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `/device/oculusgo/axis/${axisName}`;\r\n  },\r\n  //\r\n  trigger: {\r\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\r\n    touched: \"/device/oculusgo/button/trigger/touched\",\r\n    value: \"/device/oculusgo/button/trigger/value\"\r\n  },\r\n  touchpad: {\r\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\r\n    touched: \"/device/oculusgo/button/touchpad/touched\",\r\n    value: \"/device/oculusgo/button/touchpad/value\",\r\n    axisX: \"/device/oculusgo/axis/touchpadX\",\r\n    axisY: \"/device/oculusgo/axis/touchpadY\"\r\n  },\r\n  pose: \"/device/oculusgo/pose\",\r\n  matrix: \"/device/oculusgo/matrix\",\r\n  v: name => {\r\n    return `/vars/oculusgo/${name}`;\r\n  }\r\n};\r\n\r\nconst gearVRController = \"/device/gearVRController/\";\r\npaths.device.gearVRController = {\r\n  button: buttonName => ({\r\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\r\n    touched: `${gearVRController}button/${buttonName}/touched`,\r\n    value: `${gearVRController}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${gearVRController}axis/${axisName}`;\r\n  },\r\n  pose: `${gearVRController}pose`,\r\n  matrix: `${gearVRController}matrix`,\r\n  v: name => {\r\n    return `/vars/gearVRController/${name}`;\r\n  }\r\n};\r\n\r\nconst daydream = \"/device/daydream/\";\r\npaths.device.daydream = {\r\n  button: buttonName => ({\r\n    pressed: `${daydream}button/${buttonName}/pressed`,\r\n    touched: `${daydream}button/${buttonName}/touched`,\r\n    value: `${daydream}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${daydream}axis/${axisName}`;\r\n  },\r\n  pose: `${daydream}pose`,\r\n  matrix: `${daydream}matrix`\r\n};\r\n\r\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\r\npaths.device.rightOculusTouch = {\r\n  button: buttonName => ({\r\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\r\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\r\n    value: `${rightOculusTouch}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${rightOculusTouch}axis/${axisName}`;\r\n  },\r\n  axesSum: `${rightOculusTouch}axis/sum`,\r\n  pose: `${rightOculusTouch}pose`,\r\n  matrix: `${rightOculusTouch}matrix`\r\n};\r\n\r\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\r\npaths.device.leftOculusTouch = {\r\n  button: buttonName => ({\r\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\r\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\r\n    value: `${leftOculusTouch}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${leftOculusTouch}axis/${axisName}`;\r\n  },\r\n  axesSum: `${leftOculusTouch}axis/sum`,\r\n  pose: `${leftOculusTouch}pose`,\r\n  matrix: `${leftOculusTouch}matrix`\r\n};\r\n\r\npaths.device.vive = {};\r\npaths.device.vive.left = {\r\n  button: buttonName => ({\r\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\r\n    touched: `/device/vive/left/button/${buttonName}/touched`,\r\n    value: `/device/vive/left/button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `/device/vive/left/axis/${axisName}`;\r\n  },\r\n  axesSum: \"/device/vive/left/axis/sum\",\r\n  pose: `/device/vive/left/pose`,\r\n  matrix: `/device/vive/left/matrix`\r\n};\r\npaths.device.vive.right = {\r\n  button: buttonName => ({\r\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\r\n    touched: `/device/vive/right/button/${buttonName}/touched`,\r\n    value: `/device/vive/right/button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `/device/vive/right/axis/${axisName}`;\r\n  },\r\n  axesSum: \"/device/vive/right/axis/sum\",\r\n  pose: `/device/vive/right/pose`,\r\n  matrix: `/device/vive/right/matrix`\r\n};\r\n\r\nfunction button(device, side, name) {\r\n  return {\r\n    pressed: `${device}${side}/button/${name}/pressed`,\r\n    touched: `${device}${side}/button/${name}/touched`,\r\n    value: `${device}${side}/button/${name}/value`\r\n  };\r\n}\r\n\r\nfunction axes(device, side, name) {\r\n  return {\r\n    axisX: `${device}${side}/axis/${name}X`,\r\n    axisY: `${device}${side}/axis/${name}Y`\r\n  };\r\n}\r\n\r\nfunction wmrController(side) {\r\n  const wmr = \"/device/wmr/\";\r\n  return {\r\n    touchpad: {\r\n      ...button(wmr, side, \"touchpad\"),\r\n      ...axes(wmr, side, \"touchpad\")\r\n    },\r\n    trigger: button(wmr, side, \"trigger\"),\r\n    grip: button(wmr, side, \"grip\"),\r\n    menu: button(wmr, side, \"menu\"),\r\n    joystick: axes(wmr, side, \"joystick\"),\r\n    pose: `${wmr}${side}/pose`,\r\n    matrix: `${wmr}${side}/matrix`\r\n  };\r\n}\r\npaths.device.wmr = {};\r\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\r\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\r\npaths.device.wmr.left = wmrController(\"left\");\r\npaths.device.wmr.right = wmrController(\"right\");\r\n","module.exports = {\r\n  COLLISION_LAYERS: {\r\n    ALL: -1,\r\n    NONE: 0,\r\n    INTERACTABLES: 1,\r\n    ENVIRONMENT: 2,\r\n    AVATAR: 4,\r\n    HANDS: 8,\r\n    DEFAULT_INTERACTABLE: 1 | 2 | 4 | 8,\r\n    UNOWNED_INTERACTABLE: 1 | 8,\r\n    DEFAULT_SPAWNER: 1 | 8\r\n  }\r\n};\r\n","// Wrapper for a worker which accepts work items and responds with results.\r\n//\r\n// The worker must receive messages with data of the shape { id, payload }, and then respond\r\n// with messages containing matching IDs of the shape { id, result, err }.\r\n//\r\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\r\n// will resolve with the result or reject with the error.\r\n//\r\nexport function promisifyWorker(worker) {\r\n  let nextItemId = 0;\r\n  const outstanding = {}; // item ID: { resolve, reject }\r\n\r\n  worker.onmessage = msg => {\r\n    const { id, result, err } = msg.data;\r\n    const handlers = outstanding[id];\r\n    if (handlers == null) {\r\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\r\n    } else {\r\n      delete outstanding[id];\r\n      if (err != null) {\r\n        handlers.reject(new Error(err));\r\n      } else {\r\n        handlers.resolve(result);\r\n      }\r\n    }\r\n  };\r\n\r\n  return function(data, transfer, args = {}) {\r\n    const id = nextItemId++;\r\n    const promise = new Promise((resolve, reject) => {\r\n      outstanding[id] = { resolve, reject };\r\n    });\r\n    worker.postMessage(Object.assign(args, { id, payload: data }), transfer);\r\n    return promise;\r\n  };\r\n}\r\n","import { EventTarget } from \"event-target-shim\";\r\nimport configs from \"../utils/configs\";\r\nimport { getReticulumFetchUrl, fetchReticulumAuthenticated, hasReticulumServer } from \"../utils/phoenix-utils\";\r\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\r\n\r\nconst EMPTY_RESULT = { entries: [], meta: {} };\r\n\r\nconst URL_SOURCE_TO_TO_API_SOURCE = {\r\n  scenes: \"scene_listings\",\r\n  images: \"bing_images\",\r\n  videos: \"bing_videos\",\r\n  youtube: \"youtube_videos\",\r\n  gifs: \"tenor\",\r\n  sketchfab: \"sketchfab\",\r\n  poly: \"poly\",\r\n  twitch: \"twitch\",\r\n  favorites: \"favorites\"\r\n};\r\n\r\nconst desiredSources = [\"poly\", \"sketchfab\", \"videos\", \"scenes\", \"avatars\", \"gifs\", \"images\"];\r\nconst availableIntegrations = configs.AVAILABLE_INTEGRATIONS;\r\nconst availableSources = desiredSources.filter(source => {\r\n  const apiSource = URL_SOURCE_TO_TO_API_SOURCE[source];\r\n  return !availableIntegrations.hasOwnProperty(apiSource) || availableIntegrations[apiSource];\r\n});\r\nexport const SOURCES = availableSources;\r\n\r\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\r\n  gifs: \"trending\",\r\n  sketchfab: \"featured\",\r\n  scenes: \"featured\",\r\n  favorites: \"my-favorites\"\r\n};\r\n\r\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\", \"similar_to\"];\r\n\r\n// This class is responsible for fetching and storing media search results and provides a\r\n// convenience API for performing history updates relevant to search navigation.\r\nexport default class MediaSearchStore extends EventTarget {\r\n  constructor() {\r\n    super();\r\n\r\n    this.requestIndex = 0;\r\n  }\r\n\r\n  setHistory(history) {\r\n    this.history = history;\r\n\r\n    this._update(this.history.location);\r\n\r\n    this.history.listen(location => {\r\n      this._update(location);\r\n    });\r\n  }\r\n\r\n  _update = async location => {\r\n    this.result = null;\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n\r\n    const urlSource = this.getUrlMediaSource(location);\r\n    if (!urlSource) return;\r\n\r\n    if (!this.previousSource || this.previousSource !== urlSource) {\r\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\r\n      this.previousSource = urlSource;\r\n    }\r\n\r\n    const urlParams = new URLSearchParams(location.search);\r\n\r\n    this.requestIndex++;\r\n    const currentRequestIndex = this.requestIndex;\r\n    const searchParams = new URLSearchParams();\r\n    const locationSearchParams = new URLSearchParams(location.search);\r\n    const isMy = locationSearchParams.get(\"filter\") && locationSearchParams.get(\"filter\").startsWith(\"my-\");\r\n\r\n    for (const param of SEARCH_CONTEXT_PARAMS) {\r\n      if (!urlParams.get(param)) continue;\r\n      searchParams.set(param, urlParams.get(param));\r\n    }\r\n\r\n    searchParams.get(\"locale\", navigator.languages[0]);\r\n\r\n    let source;\r\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\r\n      // Avatars + scenes are special since we request them from a different source based on the facet.\r\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\r\n      source = isMy ? `${singular}s` : `${singular}_listings`;\r\n    } else {\r\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\r\n    }\r\n    searchParams.set(\"source\", source);\r\n\r\n    let fetch = true;\r\n\r\n    if (source === \"avatars\" || source === \"scenes\" || source === \"favorites\") {\r\n      if (isMy) {\r\n        if (window.APP.store.credentialsAccountId) {\r\n          searchParams.set(\"user\", window.APP.store.credentialsAccountId);\r\n        } else {\r\n          fetch = false; // Don't fetch my-* if not signed in\r\n        }\r\n      }\r\n    }\r\n\r\n    const path = `/api/v1/media/search?${searchParams.toString()}`;\r\n    const url = getReticulumFetchUrl(path);\r\n    if (this.lastSavedUrl === url) return;\r\n\r\n    this.isFetching = true;\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n    const result = fetch ? await fetchReticulumAuthenticated(path) : EMPTY_RESULT;\r\n\r\n    if (this.requestIndex != currentRequestIndex) return;\r\n\r\n    this.result = result;\r\n    this.nextCursor = this.result && this.result.meta && this.result.meta.next_cursor;\r\n    this.lastFetchedUrl = url;\r\n    this.isFetching = false;\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n  };\r\n\r\n  pageNavigate = delta => {\r\n    if (delta === -1) {\r\n      this.history.goBack();\r\n    } else {\r\n      const location = this.history.location;\r\n      const searchParams = new URLSearchParams(location.search);\r\n      searchParams.set(\"cursor\", this.nextCursor);\r\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\r\n    }\r\n  };\r\n\r\n  filterQueryNavigate = (filter, query) => {\r\n    const location = this.history.location;\r\n    const searchParams = new URLSearchParams(location.search);\r\n\r\n    searchParams.delete(\"similar_to\");\r\n    searchParams.delete(\"similar_name\");\r\n\r\n    if (query) {\r\n      searchParams.set(\"q\", query);\r\n    } else {\r\n      searchParams.delete(\"q\");\r\n    }\r\n\r\n    if (filter) {\r\n      searchParams.set(\"filter\", filter);\r\n    } else {\r\n      searchParams.delete(\"filter\");\r\n    }\r\n\r\n    if (filter) {\r\n      searchParams.set(\"cursor\", filter);\r\n    } else {\r\n      searchParams.delete(\"cursor\");\r\n    }\r\n\r\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\r\n  };\r\n\r\n  getSearchClearedSearchParams = (location, keepSource, keepNav, keepSelectAction) => {\r\n    const searchParams = new URLSearchParams(location.search);\r\n\r\n    // Strip browsing query params\r\n    searchParams.delete(\"q\");\r\n    searchParams.delete(\"filter\");\r\n    searchParams.delete(\"cursor\");\r\n    searchParams.delete(\"similar_to\");\r\n    searchParams.delete(\"similar_name\");\r\n\r\n    if (!keepNav) {\r\n      searchParams.delete(\"media_nav\");\r\n    }\r\n\r\n    if (!keepSource) {\r\n      searchParams.delete(\"media_source\");\r\n    }\r\n\r\n    if (!keepSelectAction) {\r\n      searchParams.delete(\"selectAction\");\r\n    }\r\n\r\n    return searchParams;\r\n  };\r\n\r\n  _stashLastSearchParams = location => {\r\n    const searchParams = new URLSearchParams(location.search);\r\n\r\n    this._stashedParams = {};\r\n    this._stashedSource = null;\r\n\r\n    const source = this.getUrlMediaSource(location);\r\n\r\n    // HACK for now do not stash favorite search, since that ends up being a source\r\n    // we do not reveal in the media browser UX. Revisit the rules here when we have a\r\n    // proper favorites browser. Then, we should have two separate stashes.\r\n    if (source === \"favorites\") return;\r\n    this._stashedSource = source;\r\n\r\n    for (const param of SEARCH_CONTEXT_PARAMS) {\r\n      const value = searchParams.get(param);\r\n\r\n      if (value) {\r\n        this._stashedParams[param] = value;\r\n      }\r\n    }\r\n  };\r\n\r\n  clearStashedQuery = () => {\r\n    if (!this._stashedParams) return;\r\n    delete this._stashedParams.q;\r\n  };\r\n\r\n  sourceNavigate = source => {\r\n    this._sourceNavigate(source, false, true);\r\n  };\r\n\r\n  sourceNavigateToDefaultSource = () => {\r\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\r\n  };\r\n\r\n  sourceNavigateWithNoNav = (source, selectAction) => {\r\n    this._sourceNavigate(source, true, false, selectAction);\r\n  };\r\n\r\n  _sourceNavigate = async (source, hideNav, useLastStashedParams, selectAction) => {\r\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\r\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\r\n\r\n    if (currentQuery) {\r\n      searchParams.set(\"q\", currentQuery);\r\n    } else {\r\n      if (useLastStashedParams && this._stashedParams) {\r\n        for (const param of SEARCH_CONTEXT_PARAMS) {\r\n          const value = this._stashedParams[param];\r\n\r\n          // Only q param is compatible across sources, so keep it if is stashed.\r\n          const useValue = param === \"q\" || this._stashedSource === source;\r\n\r\n          if (value && useValue) {\r\n            searchParams.set(param, value);\r\n          }\r\n        }\r\n      } else {\r\n        if (source === \"avatars\") {\r\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\r\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\r\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\r\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\r\n        }\r\n      }\r\n    }\r\n\r\n    this._stashedParams = null;\r\n    this._stashedSource = null;\r\n\r\n    if (hideNav) {\r\n      searchParams.set(\"media_nav\", \"false\");\r\n    }\r\n\r\n    if (selectAction) {\r\n      searchParams.set(\"selectAction\", selectAction);\r\n    }\r\n\r\n    if (hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER) {\r\n      searchParams.set(\"media_source\", source);\r\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\r\n    } else {\r\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\r\n    }\r\n  };\r\n\r\n  _hasAccountWithAvatars = async () => {\r\n    const { credentialsAccountId } = window.APP.store;\r\n    if (!credentialsAccountId) return false;\r\n\r\n    const searchParams = new URLSearchParams();\r\n    const source = \"avatars\";\r\n    searchParams.set(\"source\", source);\r\n    searchParams.set(\"user\", credentialsAccountId);\r\n    const result = await fetchReticulumAuthenticated(`/api/v1/media/search?${searchParams.toString()}`);\r\n    return !!(result && result.entries) && result.entries.length > 0;\r\n  };\r\n\r\n  getUrlMediaSource = location => {\r\n    const { search } = location;\r\n    const urlParams = new URLSearchParams(search);\r\n    const pathname = sluglessPath(location);\r\n\r\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\r\n    return urlParams.get(\"media_source\") || pathname.substring(7);\r\n  };\r\n\r\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\r\n    if (!history) history = this.history;\r\n\r\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\r\n\r\n    const { pathname } = history.location;\r\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\r\n    pushHistoryPath(\r\n      history,\r\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\r\n      this.getSearchClearedSearchParams(history.location).toString()\r\n    );\r\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\r\n  };\r\n}\r\n","import { hasReticulumServer } from \"./phoenix-utils\";\nimport configs from \"./configs\";\n\nconst nonCorsProxyDomains = (configs.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (configs.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(configs.CORS_PROXY_SERVER);\n}\nnonCorsProxyDomains.push(document.location.hostname)\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\"\n};\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url)\n    .replace(/=+$/g, \"\")\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  let extension = \"\";\n  try {\n    const pathParts = new URL(url).pathname.split(\".\");\n\n    if (pathParts.length > 1) {\n      const extensionCandidate = pathParts.pop();\n      if (commonKnownContentTypes[extensionCandidate]) {\n        extension = `.${extensionCandidate}`;\n      }\n    }\n  } catch (e) {\n    extension = \".png\";\n  }\n\n  // HACK: the extension is needed to ensure CDN caching on Cloudflare\n  const thumbnailUrl = `https://${configs.THUMBNAIL_SERVER}/thumbnail/${farsparkEncodeUrl(\n    url\n  )}${extension}?w=${width}&h=${height}`;\n\n  try {\n    const urlHostname = new URL(url).hostname;\n\n    if (hasReticulumServer()) {\n      const retHostname = new URL(`https://${configs.RETICULUM_SERVER}`).hostname;\n      if (retHostname === urlHostname) return url;\n    }\n  } catch (e) {\n    return thumbnailUrl;\n  }\n\n  return thumbnailUrl;\n};\n\nexport const isNonCorsProxyDomain = hostname => {\n  return nonCorsProxyDomains.find(domain => hostname.endsWith(domain));\n};\n\nexport const proxiedUrlFor = url => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  // Skip known domains that do not require CORS proxying.\n  try {\n    const parsedUrl = new URL(url);\n    if (isNonCorsProxyDomain(parsedUrl.hostname)) return url;\n  } catch (e) {\n    // Ignore\n  }\n\n  return `https://${configs.CORS_PROXY_SERVER}/${url}`;\n};\n\nexport function getAbsoluteUrl(baseUrl, relativeUrl) {\n  return new URL(relativeUrl, baseUrl);\n}\n\nexport function getAbsoluteHref(baseUrl, relativeUrl) {\n  return getAbsoluteUrl(baseUrl, relativeUrl).href;\n}\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (configs.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nconst dataUrlRegex = /data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/;\n\nexport const guessContentType = url => {\n  if (!url) return;\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  if (url.startsWith(\"data:\")) {\n    const matches = dataUrlRegex.exec(url);\n    if (matches.length > 0) {\n      matches[1];\n    }\n  }\n  const extension = new URL(url, window.location).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nconst originIsHubsServer = new Map();\nasync function isHubsServer(url) {\n  if (!url) return false;\n  if (!url.startsWith(\"http\")) {\n    url = \"https://\" + url;\n  }\n  const { origin } = new URL(url);\n\n  if (originIsHubsServer.has(origin)) {\n    return originIsHubsServer.get(origin);\n  }\n\n  let isHubsServer;\n  try {\n    isHubsServer = (await fetch(proxiedUrlFor(origin), { method: \"HEAD\" })).headers.has(\"hub-name\");\n  } catch (e) {\n    isHubsServer = false;\n  }\n  originIsHubsServer.set(origin, isHubsServer);\n  return isHubsServer;\n}\n\nconst hubsSceneRegex = /https?:\\/\\/[^/]+\\/scenes\\/(\\w+)\\/?\\S*/;\nconst hubsAvatarRegex = /https?:\\/\\/[^/]+\\/avatars\\/(?<id>\\w+)\\/?\\S*/;\nconst hubsRoomRegex = /(https?:\\/\\/)?[^/]+\\/([a-zA-Z0-9]{7})\\/?\\S*/;\n\nexport const isLocalHubsUrl = async url =>\n  (await isHubsServer(url)) && new URL(url).origin === document.location.origin;\n\nexport const isHubsSceneUrl = async url => (await isHubsServer(url)) && hubsSceneRegex.test(url);\nexport const isLocalHubsSceneUrl = async url => (await isHubsSceneUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsAvatarUrl = async url => (await isHubsServer(url)) && hubsAvatarRegex.test(url);\nexport const isLocalHubsAvatarUrl = async url => (await isHubsAvatarUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsRoomUrl = async url =>\n  (await isHubsServer(url)) && !(await isHubsAvatarUrl(url)) && !(await isHubsSceneUrl(url)) && hubsRoomRegex.test(url);\n\nexport const isHubsDestinationUrl = async url =>\n  (await isHubsServer(url)) && ((await isHubsSceneUrl(url)) || (await isHubsRoomUrl(url)));\n\nexport const idForAvatarUrl = url => {\n  const match = url.match(hubsAvatarRegex);\n  if (match) {\n    return match.groups.id;\n  }\n  return null;\n};\n","import { detectOS } from \"detect-browser\";\r\n\r\nexport function disableiOSZoom() {\r\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\r\n\r\n  let lastTouchAtMs = 0;\r\n\r\n  document.addEventListener(\"touchmove\", ev => {\r\n    if (ev.scale === 1) return;\r\n\r\n    ev.preventDefault();\r\n  });\r\n\r\n  document.addEventListener(\"touchend\", ev => {\r\n    const now = new Date().getTime();\r\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\r\n    lastTouchAtMs = now;\r\n\r\n    if (isDoubleTouch) {\r\n      ev.preventDefault();\r\n    }\r\n  });\r\n}\r\n","// Provides a global registry of running components\r\nexport function registerComponentInstance(component, name) {\r\n  window.APP.componentRegistry = window.APP.componentRegistry || {};\r\n  window.APP.componentRegistry[name] = window.APP.componentRegistry[name] || [];\r\n  window.APP.componentRegistry[name].push(component);\r\n}\r\n\r\nexport function deregisterComponentInstance(component, name) {\r\n  if (!window.APP.componentRegistry || !window.APP.componentRegistry[name]) return;\r\n  window.APP.componentRegistry[name].splice(window.APP.componentRegistry[name].indexOf(component), 1);\r\n}\r\n\r\nexport function getCurrentStreamer() {\r\n  if (!window.APP || !window.APP.componentRegistry || !window.APP.hubChannel || !window.APP.hubChannel.presence)\r\n    return null;\r\n  const playerInfos = window.APP.componentRegistry[\"player-info\"] || [];\r\n  const presences = window.APP.hubChannel.presence.state;\r\n\r\n  for (let i = 0; i < playerInfos.length; i++) {\r\n    const playerInfo = playerInfos[i];\r\n    const presence = presences[playerInfo.playerSessionId];\r\n\r\n    if (presence && presence.metas[0] && presence.metas[0].streaming) {\r\n      return playerInfo;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n","const tempVector3 = new THREE.Vector3();\r\nconst tempQuaternion = new THREE.Quaternion();\r\n\r\nexport function getLastWorldPosition(src, target) {\r\n  src.updateMatrices();\r\n  target.setFromMatrixPosition(src.matrixWorld);\r\n  return target;\r\n}\r\n\r\nexport function getLastWorldQuaternion(src, target) {\r\n  src.updateMatrices();\r\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\r\n  return target;\r\n}\r\n\r\nexport function getLastWorldScale(src, target) {\r\n  src.updateMatrices();\r\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\r\n  return target;\r\n}\r\n\r\nexport function disposeMaterial(mtrl) {\r\n  if (mtrl.map) mtrl.map.dispose();\r\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\r\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\r\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\r\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\r\n  if (mtrl.envMap) mtrl.envMap.dispose();\r\n  mtrl.dispose();\r\n}\r\n\r\nexport function disposeNode(node) {\r\n  if (!(node instanceof THREE.Mesh)) return;\r\n\r\n  if (node.geometry) {\r\n    node.geometry.dispose();\r\n  }\r\n\r\n  if (node.material) {\r\n    let materialArray;\r\n    if (node.material instanceof THREE.MeshFaceMaterial || node.material instanceof THREE.MultiMaterial) {\r\n      materialArray = node.material.materials;\r\n    } else if (node.material instanceof Array) {\r\n      materialArray = node.material;\r\n    }\r\n    if (materialArray) {\r\n      materialArray.forEach(disposeMaterial);\r\n    } else {\r\n      disposeMaterial(node.material);\r\n    }\r\n  }\r\n}\r\n\r\nconst IDENTITY = new THREE.Matrix4().identity();\r\nexport function setMatrixWorld(object3D, m) {\r\n  if (!object3D.matrixIsModified) {\r\n    object3D.applyMatrix(IDENTITY); // hack around our matrix optimizations\r\n  }\r\n  object3D.matrixWorld.copy(m);\r\n  if (object3D.parent) {\r\n    object3D.matrix = object3D.matrix.getInverse(object3D.parent.matrixWorld).multiply(object3D.matrixWorld);\r\n  } else {\r\n    object3D.matrix.copy(object3D.matrixWorld);\r\n  }\r\n  object3D.matrix.decompose(object3D.position, object3D.quaternion, object3D.scale);\r\n  object3D.childrenNeedMatrixWorldUpdate = true;\r\n}\r\n\r\n// Modified version of Don McCurdy's AnimationUtils.clone\r\n// https://github.com/mrdoob/three.js/pull/14494\r\n\r\nfunction parallelTraverse(a, b, callback) {\r\n  callback(a, b);\r\n\r\n  for (let i = 0; i < a.children.length; i++) {\r\n    parallelTraverse(a.children[i], b.children[i], callback);\r\n  }\r\n}\r\n\r\n// Supports the following PropertyBinding path formats:\r\n// uuid.propertyName\r\n// uuid.propertyName[propertyIndex]\r\n// uuid.objectName[objectIndex].propertyName[propertyIndex]\r\n// Does not support property bindings that use object3D names or parent nodes\r\nfunction cloneKeyframeTrack(sourceKeyframeTrack, cloneUUIDLookup) {\r\n  const { nodeName: uuid, objectName, objectIndex, propertyName, propertyIndex } = THREE.PropertyBinding.parseTrackName(\r\n    sourceKeyframeTrack.name\r\n  );\r\n\r\n  let path = \"\";\r\n\r\n  if (uuid !== undefined) {\r\n    const clonedUUID = cloneUUIDLookup.get(uuid);\r\n\r\n    if (clonedUUID === undefined) {\r\n      console.warn(`Could not find KeyframeTrack target with uuid: \"${uuid}\"`);\r\n    }\r\n\r\n    path += clonedUUID;\r\n  }\r\n\r\n  if (objectName !== undefined) {\r\n    path += \".\" + objectName;\r\n  }\r\n\r\n  if (objectIndex !== undefined) {\r\n    path += \"[\" + objectIndex + \"]\";\r\n  }\r\n\r\n  if (propertyName !== undefined) {\r\n    path += \".\" + propertyName;\r\n  }\r\n\r\n  if (propertyIndex !== undefined) {\r\n    path += \"[\" + propertyIndex + \"]\";\r\n  }\r\n\r\n  const clonedKeyframeTrack = sourceKeyframeTrack.clone();\r\n  clonedKeyframeTrack.name = path;\r\n\r\n  return clonedKeyframeTrack;\r\n}\r\n\r\nfunction cloneAnimationClip(sourceAnimationClip, cloneUUIDLookup) {\r\n  const clonedTracks = sourceAnimationClip.tracks.map(keyframeTrack =>\r\n    cloneKeyframeTrack(keyframeTrack, cloneUUIDLookup)\r\n  );\r\n  return new THREE.AnimationClip(sourceAnimationClip.name, sourceAnimationClip.duration, clonedTracks);\r\n}\r\n\r\nexport function cloneObject3D(source, preserveUUIDs) {\r\n  const cloneLookup = new Map();\r\n  const cloneUUIDLookup = new Map();\r\n\r\n  const clone = source.clone();\r\n\r\n  parallelTraverse(source, clone, (sourceNode, clonedNode) => {\r\n    cloneLookup.set(sourceNode, clonedNode);\r\n  });\r\n\r\n  source.traverse(sourceNode => {\r\n    const clonedNode = cloneLookup.get(sourceNode);\r\n\r\n    if (preserveUUIDs) {\r\n      clonedNode.uuid = sourceNode.uuid;\r\n    }\r\n\r\n    cloneUUIDLookup.set(sourceNode.uuid, clonedNode.uuid);\r\n  });\r\n\r\n  source.traverse(sourceNode => {\r\n    const clonedNode = cloneLookup.get(sourceNode);\r\n\r\n    if (!clonedNode) {\r\n      return;\r\n    }\r\n\r\n    if (sourceNode.animations) {\r\n      clonedNode.animations = sourceNode.animations.map(animationClip =>\r\n        cloneAnimationClip(animationClip, cloneUUIDLookup)\r\n      );\r\n    }\r\n\r\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\r\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\r\n    }\r\n\r\n    if (!sourceNode.isSkinnedMesh) return;\r\n\r\n    const sourceBones = sourceNode.skeleton.bones;\r\n\r\n    clonedNode.skeleton = sourceNode.skeleton.clone();\r\n\r\n    clonedNode.skeleton.bones = sourceBones.map(sourceBone => {\r\n      if (!cloneLookup.has(sourceBone)) {\r\n        throw new Error(\"Required bones are not descendants of the given object.\");\r\n      }\r\n\r\n      return cloneLookup.get(sourceBone);\r\n    });\r\n\r\n    clonedNode.bind(clonedNode.skeleton, sourceNode.bindMatrix);\r\n  });\r\n\r\n  return clone;\r\n}\r\n\r\nexport function findNode(root, pred) {\r\n  let nodes = [root];\r\n  while (nodes.length) {\r\n    const node = nodes.shift();\r\n    if (pred(node)) return node;\r\n    if (node.children) nodes = nodes.concat(node.children);\r\n  }\r\n  return null;\r\n}\r\n\r\nexport const interpolateAffine = (function() {\r\n  const mat4 = new THREE.Matrix4();\r\n  const end = {\r\n    position: new THREE.Vector3(),\r\n    quaternion: new THREE.Quaternion(),\r\n    scale: new THREE.Vector3()\r\n  };\r\n  const start = {\r\n    position: new THREE.Vector3(),\r\n    quaternion: new THREE.Quaternion(),\r\n    scale: new THREE.Vector3()\r\n  };\r\n  const interpolated = {\r\n    position: new THREE.Vector3(),\r\n    quaternion: new THREE.Quaternion(),\r\n    scale: new THREE.Vector3()\r\n  };\r\n  return function(startMat4, endMat4, progress, outMat4) {\r\n    start.quaternion.setFromRotationMatrix(mat4.extractRotation(startMat4));\r\n    end.quaternion.setFromRotationMatrix(mat4.extractRotation(endMat4));\r\n    THREE.Quaternion.slerp(start.quaternion, end.quaternion, interpolated.quaternion, progress);\r\n    interpolated.position.lerpVectors(\r\n      start.position.setFromMatrixColumn(startMat4, 3),\r\n      end.position.setFromMatrixColumn(endMat4, 3),\r\n      progress\r\n    );\r\n    interpolated.scale.lerpVectors(\r\n      start.scale.setFromMatrixScale(startMat4),\r\n      end.scale.setFromMatrixScale(endMat4),\r\n      progress\r\n    );\r\n    return outMat4.compose(\r\n      interpolated.position,\r\n      interpolated.quaternion,\r\n      interpolated.scale\r\n    );\r\n  };\r\n})();\r\n\r\nexport const squareDistanceBetween = (function() {\r\n  const posA = new THREE.Vector3();\r\n  const posB = new THREE.Vector3();\r\n  return function(objA, objB) {\r\n    objA.updateMatrices();\r\n    objB.updateMatrices();\r\n    posA.setFromMatrixColumn(objA.matrixWorld, 3);\r\n    posB.setFromMatrixColumn(objB.matrixWorld, 3);\r\n    return posA.distanceToSquared(posB);\r\n  };\r\n})();\r\n\r\nexport function isAlmostUniformVector3(v, epsilonHalf = 0.005) {\r\n  return Math.abs(v.x - v.y) < epsilonHalf && Math.abs(v.x - v.z) < epsilonHalf;\r\n}\r\nexport function almostEqual(a, b, epsilon = 0.01) {\r\n  return Math.abs(a - b) < epsilon;\r\n}\r\n\r\nexport const affixToWorldUp = (function() {\r\n  const inRotationMat4 = new THREE.Matrix4();\r\n  const inForward = new THREE.Vector3();\r\n  const outForward = new THREE.Vector3();\r\n  const outSide = new THREE.Vector3();\r\n  const worldUp = new THREE.Vector3(); // Could be called \"outUp\"\r\n  const v = new THREE.Vector3();\r\n  const inMat4Copy = new THREE.Matrix4();\r\n  return function affixToWorldUp(inMat4, outMat4) {\r\n    inRotationMat4.identity().extractRotation(inMat4Copy.copy(inMat4));\r\n    inForward.setFromMatrixColumn(inRotationMat4, 2).multiplyScalar(-1);\r\n    outForward\r\n      .copy(inForward)\r\n      .sub(v.copy(inForward).projectOnVector(worldUp.set(0, 1, 0)))\r\n      .normalize();\r\n    outSide.crossVectors(outForward, worldUp);\r\n    outMat4.makeBasis(outSide, worldUp, outForward.multiplyScalar(-1));\r\n    outMat4.scale(v.setFromMatrixScale(inMat4Copy));\r\n    outMat4.setPosition(v.setFromMatrixColumn(inMat4Copy, 3));\r\n    return outMat4;\r\n  };\r\n})();\r\n\r\nexport const calculateCameraTransformForWaypoint = (function() {\r\n  const upAffixedCameraTransform = new THREE.Matrix4();\r\n  const upAffixedWaypointTransform = new THREE.Matrix4();\r\n  const detachFromWorldUp = new THREE.Matrix4();\r\n  return function calculateCameraTransformForWaypoint(cameraTransform, waypointTransform, outMat4) {\r\n    affixToWorldUp(cameraTransform, upAffixedCameraTransform);\r\n    detachFromWorldUp.getInverse(upAffixedCameraTransform).multiply(cameraTransform);\r\n    affixToWorldUp(waypointTransform, upAffixedWaypointTransform);\r\n    outMat4.copy(upAffixedWaypointTransform).multiply(detachFromWorldUp);\r\n  };\r\n})();\r\n\r\nexport const calculateViewingDistance = (function() {\r\n  return function calculateViewingDistance(fov, aspect, object, box, center, vrMode) {\r\n    const halfYExtents = Math.max(Math.abs(box.max.y - center.y), Math.abs(center.y - box.min.y));\r\n    const halfXExtents = Math.max(Math.abs(box.max.x - center.x), Math.abs(center.x - box.min.x));\r\n    const halfVertFOV = THREE.Math.degToRad(fov / 2);\r\n    const halfHorFOV = Math.atan(Math.tan(halfVertFOV) * aspect) * (vrMode ? 0.5 : 1);\r\n    const margin = 1.05;\r\n    const length1 = Math.abs((halfYExtents * margin) / Math.tan(halfVertFOV));\r\n    const length2 = Math.abs((halfXExtents * margin) / Math.tan(halfHorFOV));\r\n    const length3 = Math.abs(box.max.z - center.z) + Math.max(length1, length2);\r\n    const length = vrMode ? Math.max(0.25, length3) : length3;\r\n    return length || 1.25;\r\n  };\r\n})();\r\n\r\nexport const rotateInPlaceAroundWorldUp = (function() {\r\n  const inMat4Copy = new THREE.Matrix4();\r\n  const startRotation = new THREE.Matrix4();\r\n  const endRotation = new THREE.Matrix4();\r\n  const v = new THREE.Vector3();\r\n  return function rotateInPlaceAroundWorldUp(inMat4, theta, outMat4) {\r\n    inMat4Copy.copy(inMat4);\r\n    return outMat4\r\n      .copy(endRotation.makeRotationY(theta).multiply(startRotation.extractRotation(inMat4Copy)))\r\n      .scale(v.setFromMatrixScale(inMat4Copy))\r\n      .setPosition(v.setFromMatrixPosition(inMat4Copy));\r\n  };\r\n})();\r\n\r\nexport const childMatch = (function() {\r\n  const childInverse = new THREE.Matrix4();\r\n  const newParentMatrix = new THREE.Matrix4();\r\n  // transform the parent such that its child matches the target\r\n  return function childMatch(parent, child, target) {\r\n    child.updateMatrices();\r\n    childInverse.getInverse(child.matrix);\r\n    newParentMatrix.multiplyMatrices(target, childInverse);\r\n    setMatrixWorld(parent, newParentMatrix);\r\n  };\r\n})();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-text\":\"scene__loading-text__1gvAa\",\"loadingText\":\"scene__loading-text__1gvAa\"};","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nconst HUB_NAME_PATTERN = \"^.{1,64}$\";\r\n\r\nexport default class CreateRoomDialog extends Component {\r\n  static propTypes = {\r\n    includeScenePrompt: PropTypes.bool,\r\n    onCustomScene: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  state = {\r\n    customRoomName: \"\",\r\n    customSceneUrl: \"\"\r\n  };\r\n\r\n  render() {\r\n    const { onCustomScene, onClose, ...other } = this.props;\r\n    const onCustomSceneClicked = () => {\r\n      onCustomScene(this.state.customRoomName, this.state.customSceneUrl);\r\n      onClose();\r\n    };\r\n\r\n    return (\r\n      <DialogContainer title=\"Create a Room\" onClose={onClose} {...other}>\r\n        <div>\r\n          {this.props.includeScenePrompt ? (\r\n            <div>Choose a name and GLTF URL for your room&apos;s scene:</div>\r\n          ) : (\r\n            <div>Choose a name for your room:</div>\r\n          )}\r\n\r\n          <form onSubmit={onCustomSceneClicked}>\r\n            <div className=\"custom-scene-form\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Room name\"\r\n                className=\"custom-scene-form__link_field\"\r\n                value={this.state.customRoomName}\r\n                pattern={HUB_NAME_PATTERN}\r\n                title=\"Names must be at most 64 characters.\"\r\n                onChange={e => this.setState({ customRoomName: e.target.value })}\r\n                required\r\n              />\r\n              {this.props.includeScenePrompt && (\r\n                <input\r\n                  type=\"url\"\r\n                  placeholder=\"URL to Scene GLTF or GLB (Optional)\"\r\n                  className=\"custom-scene-form__link_field\"\r\n                  value={this.state.customSceneUrl}\r\n                  onChange={e => this.setState({ customSceneUrl: e.target.value })}\r\n                />\r\n              )}\r\n              <div className=\"custom-scene-form__buttons\">\r\n                <WithHoverSound>\r\n                  <button className=\"custom-scene-form__action-button\">\r\n                    <span>Create Room</span>\r\n                  </button>\r\n                </WithHoverSound>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\r\nimport en from \"react-intl/locale-data/en\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport styles from \"../assets/stylesheets/scene-ui.scss\";\r\nimport { createAndRedirectToNewHub, getReticulumFetchUrl } from \"../utils/phoenix-utils\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\nimport CreateRoomDialog from \"./create-room-dialog.js\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faEllipsisH } from \"@fortawesome/free-solid-svg-icons/faEllipsisH\";\r\nimport { faCodeBranch } from \"@fortawesome/free-solid-svg-icons/faCodeBranch\";\r\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\r\n\r\nimport { lang, messages } from \"../utils/i18n\";\r\n\r\naddLocaleData([...en]);\r\n\r\nclass SceneUI extends Component {\r\n  static propTypes = {\r\n    scene: PropTypes.object,\r\n    sceneLoaded: PropTypes.bool,\r\n    sceneId: PropTypes.string,\r\n    sceneName: PropTypes.string,\r\n    sceneDescription: PropTypes.string,\r\n    sceneAttributions: PropTypes.object,\r\n    sceneScreenshotURL: PropTypes.string,\r\n    sceneProjectId: PropTypes.string,\r\n    sceneAllowRemixing: PropTypes.bool,\r\n    showCreateRoom: PropTypes.bool,\r\n    unavailable: PropTypes.bool,\r\n    isOwner: PropTypes.bool,\r\n    parentScene: PropTypes.object\r\n  };\r\n\r\n  state = {\r\n    showScreenshot: false,\r\n    showCustomRoomDialog: false\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    // Show screenshot if scene isn't loaded in 5 seconds\r\n    setTimeout(() => {\r\n      if (!this.props.sceneLoaded) {\r\n        this.setState({ showScreenshot: true });\r\n      }\r\n    }, 5000);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\r\n  }\r\n\r\n  createRoom = () => {\r\n    createAndRedirectToNewHub(this.state.customRoomName, this.props.sceneId);\r\n  };\r\n\r\n  render() {\r\n    if (this.props.unavailable) {\r\n      return (\r\n        <IntlProvider locale={lang} messages={messages}>\r\n          <div className={styles.ui}>\r\n            <div className={styles.unavailable}>\r\n              <div>\r\n                <FormattedMessage id=\"scene.unavailable\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </IntlProvider>\r\n      );\r\n    }\r\n\r\n    const { sceneAllowRemixing, isOwner, sceneProjectId, parentScene, sceneId } = this.props;\r\n\r\n    const sceneUrl = [location.protocol, \"//\", location.host, location.pathname].join(\"\");\r\n    const tweetText = `${this.props.sceneName} in ${messages[\"share-hashtag\"]}`;\r\n    const tweetLink = `https://twitter.com/share?url=${encodeURIComponent(sceneUrl)}&text=${encodeURIComponent(\r\n      tweetText\r\n    )}`;\r\n\r\n    let attributions;\r\n\r\n    const toAttributionSpan = a => {\r\n      if (a.url) {\r\n        const source = a.url.includes(\"sketchfab.com\")\r\n          ? \"on Sketchfab\"\r\n          : a.url.includes(\"poly.google.com\")\r\n            ? \"on Google Poly\"\r\n            : \"\";\r\n\r\n        return (\r\n          <span key={a.url}>\r\n            <a href={a.url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              {a.name} by {a.author} {source}\r\n            </a>\r\n            &nbsp;\r\n          </span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span key={`${a.name} ${a.author}`}>\r\n            {a.name} by {a.author}\r\n            &nbsp;\r\n          </span>\r\n        );\r\n      }\r\n    };\r\n\r\n    if (this.props.sceneAttributions) {\r\n      if (!this.props.sceneAttributions.extras) {\r\n        attributions = (\r\n          <span>\r\n            <span>{this.props.sceneAttributions.creator ? `by ${this.props.sceneAttributions.creator}` : \"\"}</span>\r\n            {parentScene &&\r\n              parentScene.attributions &&\r\n              parentScene.attributions.creator && (\r\n                <span className=\"remix\">\r\n                  &nbsp;(Remixed fron&nbsp;\r\n                  {toAttributionSpan({\r\n                    name: parentScene.name,\r\n                    url: parentScene.url,\r\n                    author: parentScene.attributions.creator\r\n                  })}\r\n                  )\r\n                </span>\r\n              )}\r\n            <br />\r\n            {this.props.sceneAttributions.content && this.props.sceneAttributions.content.map(toAttributionSpan)}\r\n          </span>\r\n        );\r\n      } else {\r\n        // Legacy\r\n        attributions = <span>{this.props.sceneAttributions.extras}</span>;\r\n      }\r\n    }\r\n\r\n    return (\r\n      <IntlProvider locale={lang} messages={messages}>\r\n        <div className={styles.ui}>\r\n          <div\r\n            className={classNames({\r\n              [styles.screenshot]: true,\r\n              [styles.screenshotHidden]: this.props.sceneLoaded\r\n            })}\r\n          >\r\n            {this.state.showScreenshot && <img src={this.props.sceneScreenshotURL} />}\r\n          </div>\r\n          <div className={styles.whiteOverlay} />\r\n          <div className={styles.grid}>\r\n            <div className={styles.mainPanel}>\r\n              <WithHoverSound>\r\n                <a href=\"/\" className={styles.logo}>\r\n                  <img src={configs.image(\"logo\")} />\r\n                </a>\r\n              </WithHoverSound>\r\n              <div className={styles.logoTagline}>\r\n                <FormattedMessage id=\"app-tagline\" />\r\n              </div>\r\n              {this.props.showCreateRoom && (\r\n                <div className={styles.createButtons}>\r\n                  <WithHoverSound>\r\n                    <button className={styles.createButton} onClick={this.createRoom}>\r\n                      <FormattedMessage id=\"scene.create_button\" />\r\n                    </button>\r\n                  </WithHoverSound>\r\n                  <WithHoverSound>\r\n                    <button\r\n                      className={styles.optionsButton}\r\n                      onClick={() => this.setState({ showCustomRoomDialog: true })}\r\n                    >\r\n                      <FontAwesomeIcon icon={faEllipsisH} />\r\n                    </button>\r\n                  </WithHoverSound>\r\n                </div>\r\n              )}\r\n              <IfFeature name=\"enable_spoke\">\r\n                {isOwner && sceneProjectId ? (\r\n                  <a\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    href={getReticulumFetchUrl(`/spoke/projects/${sceneProjectId}`)}\r\n                    className={styles.spokeButton}\r\n                  >\r\n                    <FontAwesomeIcon icon={faPencilAlt} />\r\n                    <FormattedMessage id=\"scene.edit_button\" />\r\n                  </a>\r\n                ) : (\r\n                  sceneAllowRemixing && (\r\n                    <a\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      href={getReticulumFetchUrl(`/spoke/projects/new?sceneId=${sceneId}`)}\r\n                      className={styles.spokeButton}\r\n                    >\r\n                      <FontAwesomeIcon icon={faCodeBranch} />\r\n                      <FormattedMessage id=\"scene.remix_button\" />\r\n                    </a>\r\n                  )\r\n                )}\r\n              </IfFeature>\r\n              <WithHoverSound>\r\n                <a href={tweetLink} rel=\"noopener noreferrer\" target=\"_blank\" className={styles.tweetButton}>\r\n                  <img src=\"../assets/images/twitter.svg\" />\r\n                  <div>\r\n                    <FormattedMessage id=\"scene.tweet_button\" />\r\n                  </div>\r\n                </a>\r\n              </WithHoverSound>\r\n            </div>\r\n          </div>\r\n          <div className={styles.info}>\r\n            <div className={styles.name}>{this.props.sceneName}</div>\r\n            <div className={styles.attribution}>{attributions}</div>\r\n          </div>\r\n          <IfFeature name=\"enable_spoke\">\r\n            <div className={styles.spoke}>\r\n              <div className={styles.madeWith}>made with</div>\r\n              <a href=\"/spoke\">\r\n                <img src={configs.image(\"editor_logo\")} />\r\n              </a>\r\n            </div>\r\n          </IfFeature>\r\n          {this.state.showCustomRoomDialog && (\r\n            <CreateRoomDialog\r\n              includeScenePrompt={false}\r\n              onClose={() => this.setState({ showCustomRoomDialog: false })}\r\n              onCustomScene={name => {\r\n                this.setState({ showCustomRoomDialog: false, customRoomName: name }, () => this.createRoom());\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n      </IntlProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SceneUI;\r\n","import { ScenePreviewCameraSystem } from \"./scene-preview-camera-system\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\nAFRAME.registerSystem(\"scene-systems\", {\r\n  init() {\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.DOMContentDidLoad = true;\r\n    });\r\n    this.scenePreviewCameraSystem = new ScenePreviewCameraSystem();\r\n  },\r\n\r\n  tick() {\r\n    if (!this.DOMContentDidLoad) return;\r\n    this.scenePreviewCameraSystem.tick();\r\n  }\r\n});\r\n","import \"./webxr-bypass-hacks\";\r\nimport \"./utils/theme\";\r\nimport \"./utils/configs\";\r\n\r\nconsole.log(`Hubs version: ${process.env.BUILD_VERSION || \"?\"}`);\r\n\r\nimport \"./assets/stylesheets/scene.scss\";\r\n\r\nimport \"aframe\";\r\nimport \"./utils/logging\";\r\nimport \"./utils/threejs-world-update\";\r\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\r\npatchWebGLRenderingContext();\r\n\r\nimport \"three/examples/js/loaders/GLTFLoader\";\r\n\r\nimport \"./components/scene-components\";\r\nimport \"./components/debug\";\r\nimport \"./systems/nav\";\r\n\r\nimport { connectToReticulum, fetchReticulumAuthenticated } from \"./utils/phoenix-utils\";\r\n\r\nimport ReactDOM from \"react-dom\";\r\nimport React from \"react\";\r\nimport jwtDecode from \"jwt-decode\";\r\nimport SceneUI from \"./react-components/scene-ui\";\r\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\r\n\r\nimport \"./systems/scene-systems\";\r\nimport \"./gltf-component-mappings\";\r\n\r\nimport { App } from \"./App\";\r\n\r\nwindow.APP = new App();\r\n\r\nconst qs = new URLSearchParams(location.search);\r\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\r\n\r\nwindow.APP.quality = window.APP.store.state.preferences.materialQualitySetting || isMobile ? \"low\" : \"high\";\r\n\r\nimport \"./components/event-repeater\";\r\n\r\nimport registerTelemetry from \"./telemetry\";\r\n\r\ndisableiOSZoom();\r\n\r\nfunction mountUI(scene, props = {}) {\r\n  ReactDOM.render(\r\n    <SceneUI\r\n      {...{\r\n        scene,\r\n        ...props\r\n      }}\r\n    />,\r\n    document.getElementById(\"ui-root\")\r\n  );\r\n}\r\n\r\nconst onReady = async () => {\r\n  const scene = document.querySelector(\"a-scene\");\r\n  window.APP.scene = scene;\r\n\r\n  const sceneId = qs.get(\"scene_id\") || document.location.pathname.substring(1).split(\"/\")[1];\r\n  console.log(`Scene ID: ${sceneId}`);\r\n\r\n  // Disable shadows on low quality\r\n  scene.setAttribute(\"shadow\", { enabled: window.APP.quality !== \"low\" });\r\n\r\n  let uiProps = { sceneId: sceneId };\r\n\r\n  mountUI(scene);\r\n\r\n  const remountUI = props => {\r\n    uiProps = { ...uiProps, ...props };\r\n    mountUI(scene, uiProps);\r\n  };\r\n\r\n  const sceneRoot = document.querySelector(\"#scene-root\");\r\n  const sceneModelEntity = document.createElement(\"a-entity\");\r\n  const gltfEl = document.createElement(\"a-entity\");\r\n  const camera = document.getElementById(\"camera\");\r\n\r\n  connectToReticulum().then(socket => {\r\n    const joinParams = { hub_id: \"scene\" };\r\n\r\n    if (window.APP.store.state.credentials && window.APP.store.state.credentials.token) {\r\n      joinParams.token = window.APP.store.state.credentials.token;\r\n    }\r\n\r\n    const retPhxChannel = socket.channel(\"ret\", joinParams);\r\n\r\n    retPhxChannel.join().receive(\"ok\", () => {\r\n      retPhxChannel.push(\"refresh_perms_token\").receive(\"ok\", ({ perms_token }) => {\r\n        const perms = jwtDecode(perms_token);\r\n        remountUI({ showCreateRoom: !!perms.create_hub });\r\n\r\n        retPhxChannel.leave();\r\n        socket.disconnect();\r\n      });\r\n    });\r\n  });\r\n\r\n  sceneModelEntity.addEventListener(\"scene-loaded\", () => {\r\n    remountUI({ sceneLoaded: true });\r\n    const previewCamera = gltfEl.object3D.getObjectByName(\"scene-preview-camera\");\r\n\r\n    if (previewCamera) {\r\n      camera.object3D.position.copy(previewCamera.position);\r\n      camera.object3D.rotation.copy(previewCamera.rotation);\r\n      camera.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    camera.setAttribute(\"scene-preview-camera\", \"\");\r\n  });\r\n\r\n  const res = await fetchReticulumAuthenticated(`/api/v1/scenes/${sceneId}`);\r\n  const sceneInfo = res.scenes[0];\r\n\r\n  // Delisted/Removed\r\n  if (!sceneInfo) {\r\n    remountUI({ unavailable: true });\r\n    return;\r\n  }\r\n\r\n  if (sceneInfo.allow_promotion) {\r\n    registerTelemetry(`/scene/${sceneId}`, `Hubs Scene: ${sceneInfo.title}`);\r\n  } else {\r\n    registerTelemetry(\"/scene\", \"Hubs Non-Promotable Scene Page\");\r\n  }\r\n\r\n  const modelUrl = sceneInfo.model_url;\r\n  console.log(`Scene Model URL: ${modelUrl}`);\r\n\r\n  gltfEl.setAttribute(\"gltf-model-plus\", { src: modelUrl, useCache: false, inflate: true });\r\n  gltfEl.addEventListener(\"model-loaded\", () => sceneModelEntity.emit(\"scene-loaded\"));\r\n  sceneModelEntity.appendChild(gltfEl);\r\n  sceneRoot.appendChild(sceneModelEntity);\r\n\r\n  const parentScene =\r\n    sceneInfo.parent_scene_id &&\r\n    (await fetchReticulumAuthenticated(`/api/v1/scenes/${sceneInfo.parent_scene_id}`)).scenes[0];\r\n\r\n  remountUI({\r\n    sceneName: sceneInfo.name,\r\n    sceneDescription: sceneInfo.description,\r\n    sceneAttributions: sceneInfo.attributions,\r\n    sceneScreenshotURL: sceneInfo.screenshot_url,\r\n    sceneId: sceneInfo.scene_id,\r\n    sceneProjectId: sceneInfo.project_id,\r\n    sceneAllowRemixing: sceneInfo.allow_remixing,\r\n    isOwner: sceneInfo.account_id && sceneInfo.account_id === window.APP.store.credentialsAccountId,\r\n    parentScene: parentScene\r\n  });\r\n};\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", onReady);\r\n","export const waitForEvent = function(eventName, eventObj) {\r\n  return new Promise(resolve => {\r\n    eventObj.addEventListener(eventName, resolve, { once: true });\r\n  });\r\n};\r\n\r\nexport const waitForDOMContentLoaded = function() {\r\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\r\n    return Promise.resolve(null);\r\n  } else {\r\n    return waitForEvent(\"DOMContentLoaded\", window);\r\n  }\r\n};\r\n","import { forEachMaterial } from \"../utils/material-utils\";\r\nimport { showHoverEffect } from \"../utils/permissions-utils\";\r\n\r\nconst interactorOneTransform = [];\r\nconst interactorTwoTransform = [];\r\n\r\nexport const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\r\n/**\r\n * Applies effects to a hoverable based on hover state.\r\n * @namespace interactables\r\n * @component hoverable-visuals\r\n */\r\nAFRAME.registerComponent(\"hoverable-visuals\", {\r\n  schema: {\r\n    enableSweepingEffect: { type: \"boolean\", default: true }\r\n  },\r\n  init() {\r\n    // uniforms and boundingSphere are set from the component responsible for loading the mesh.\r\n    this.uniforms = null;\r\n    this.geometryRadius = 0;\r\n\r\n    this.sweepParams = [0, 0];\r\n  },\r\n  remove() {\r\n    this.uniforms = null;\r\n    this.boundingBox = null;\r\n\r\n    // Used when the object is batched\r\n    const batchManagerSystem = this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem;\r\n    this.el.object3D.traverse(object => {\r\n      if (!object.material) return;\r\n      forEachMaterial(object, material => {\r\n        if (\r\n          !validMaterials.includes(material.type) ||\r\n          object.el.classList.contains(\"ui\") ||\r\n          object.el.classList.contains(\"hud\") ||\r\n          object.el.getAttribute(\"text-button\")\r\n        )\r\n          return;\r\n\r\n        batchManagerSystem.meshToEl.delete(object);\r\n      });\r\n    });\r\n\r\n    const isMobile = AFRAME.utils.device.isMobile();\r\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\r\n    this.isTouchscreen = isMobile && !isMobileVR;\r\n  },\r\n  tick(time) {\r\n    if (!this.uniforms || !this.uniforms.length) return;\r\n\r\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\r\n    const showEffect = showHoverEffect(this.el);\r\n    const toggling = this.el.sceneEl.systems[\"hubs-systems\"].cursorTogglingSystem;\r\n\r\n    let interactorOne, interactorTwo;\r\n    const interaction = this.el.sceneEl.systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n    if (interaction.state.leftHand.hovered === this.el && !interaction.state.leftHand.held) {\r\n      interactorOne = interaction.options.leftHand.entity.object3D;\r\n    }\r\n    if (\r\n      interaction.state.leftRemote.hovered === this.el &&\r\n      !interaction.state.leftRemote.held &&\r\n      !toggling.leftToggledOff\r\n    ) {\r\n      interactorOne = interaction.options.leftRemote.entity.object3D;\r\n    }\r\n    if (\r\n      interaction.state.rightRemote.hovered === this.el &&\r\n      !interaction.state.rightRemote.held &&\r\n      !toggling.rightToggledOff\r\n    ) {\r\n      interactorTwo = interaction.options.rightRemote.entity.object3D;\r\n    }\r\n    if (interaction.state.rightHand.hovered === this.el && !interaction.state.rightHand.held) {\r\n      interactorTwo = interaction.options.rightHand.entity.object3D;\r\n    }\r\n\r\n    if (interactorOne) {\r\n      interactorOne.matrixWorld.toArray(interactorOneTransform);\r\n    }\r\n    if (interactorTwo) {\r\n      interactorTwo.matrixWorld.toArray(interactorTwoTransform);\r\n    }\r\n\r\n    if (interactorOne || interactorTwo || isFrozen) {\r\n      const worldY = this.el.object3D.matrixWorld.elements[13];\r\n      const ms1 = this.el.object3D.matrixWorld.elements[4];\r\n      const ms2 = this.el.object3D.matrixWorld.elements[5];\r\n      const ms3 = this.el.object3D.matrixWorld.elements[6];\r\n      const worldScale = Math.sqrt(ms1 * ms1 + ms2 * ms2 + ms3 * ms3);\r\n      const scaledRadius = worldScale * this.geometryRadius;\r\n      this.sweepParams[0] = worldY - scaledRadius;\r\n      this.sweepParams[1] = worldY + scaledRadius;\r\n    }\r\n\r\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\r\n      const uniform = this.uniforms[i];\r\n      uniform.hubs_EnableSweepingEffect.value = this.data.enableSweepingEffect && showEffect;\r\n      uniform.hubs_IsFrozen.value = isFrozen;\r\n      uniform.hubs_SweepParams.value = this.sweepParams;\r\n\r\n      uniform.hubs_HighlightInteractorOne.value = !!interactorOne && showEffect && !this.isTouchscreen;\r\n      uniform.hubs_InteractorOnePos.value[0] = interactorOneTransform[12];\r\n      uniform.hubs_InteractorOnePos.value[1] = interactorOneTransform[13];\r\n      uniform.hubs_InteractorOnePos.value[2] = interactorOneTransform[14];\r\n\r\n      uniform.hubs_HighlightInteractorTwo.value = !!interactorTwo && showEffect && !this.isTouchscreen;\r\n      uniform.hubs_InteractorTwoPos.value[0] = interactorTwoTransform[12];\r\n      uniform.hubs_InteractorTwoPos.value[1] = interactorTwoTransform[13];\r\n      uniform.hubs_InteractorTwoPos.value[2] = interactorTwoTransform[14];\r\n\r\n      if (interactorOne || interactorTwo || isFrozen) {\r\n        uniform.hubs_Time.value = time;\r\n      }\r\n    }\r\n  }\r\n});\r\n","module.exports = __webpack_public_path__ + \"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg\";","import configs from \"./configs\";\r\nimport localeData from \"../assets/translations.data.json\";\r\n\r\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\r\n  .toLowerCase()\r\n  .split(/[_-]+/)[0];\r\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\r\n\r\nconst _messages = localeData[lang] || localeData.en;\r\n\r\nif (configs.APP_CONFIG && configs.APP_CONFIG.translations && configs.APP_CONFIG.translations[lang]) {\r\n  const configTranslations = configs.APP_CONFIG.translations[lang];\r\n  for (const messageKey in configTranslations) {\r\n    if (!configTranslations.hasOwnProperty(messageKey)) continue;\r\n    if (!configTranslations[messageKey]) continue;\r\n    _messages[messageKey] = configTranslations[messageKey];\r\n  }\r\n}\r\n\r\nexport const messages = Object.entries(_messages)\r\n  .map(([key, message]) => [\r\n    key,\r\n    // Replace nested message keys (e.g. %app-name%) with their messages.\r\n    message.replace(/%([\\w-.]+)%/i, (_match, subkey) => _messages[subkey])\r\n  ])\r\n  .reduce((acc, entry) => {\r\n    acc[entry[0]] = entry[1];\r\n    return acc;\r\n  }, {});\r\n","import { forEachMaterial } from \"../utils/material-utils\";\r\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\r\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\r\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\r\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\r\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\r\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\r\n\r\nexport async function createDefaultEnvironmentMap() {\r\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\r\n  const texture = await new Promise((resolve, reject) =>\r\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\r\n  );\r\n  texture.format = THREE.RGBFormat;\r\n  return texture;\r\n}\r\n\r\nAFRAME.registerComponent(\"environment-map\", {\r\n  init() {\r\n    this.environmentMap = null;\r\n\r\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\r\n  },\r\n\r\n  updateEnvironmentMap(environmentMap) {\r\n    this.environmentMap = environmentMap;\r\n    this.applyEnvironmentMap(this.el.object3D);\r\n  },\r\n\r\n  applyEnvironmentMap(object3D) {\r\n    object3D.traverse(object => {\r\n      forEachMaterial(object, material => {\r\n        if (material.isMeshStandardMaterial) {\r\n          material.envMap = this.environmentMap;\r\n          material.needsUpdate = true;\r\n        }\r\n      });\r\n    });\r\n  }\r\n});\r\n","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\r\\n  float ratio = 0.0;\\r\\n  float size = hubs_SweepParams.t - hubs_SweepParams.s;\\r\\n\\r\\n  if (hubs_EnableSweepingEffect) {\\r\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\r\\n\\r\\n    if (hubs_WorldPosition.y < line) {\\r\\n      // Highlight with a sweeping gradient.\\r\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\r\\n    }\\r\\n  }\\r\\n\\r\\n  // Highlight with a gradient falling off with distance.\\r\\n  float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\r\\n\\r\\n  if (hubs_HighlightInteractorOne) {\\r\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\r\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\r\\n  } \\r\\n\\r\\n  if (hubs_HighlightInteractorTwo) {\\r\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\r\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\r\\n  }\\r\\n\\r\\n  ratio = min(1.0, ratio);\\r\\n\\r\\n  // Gamma corrected highlight color\\r\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\r\\n\\r\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\r\\n}\\r\\n\"","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","// Utilities for manipulating state history. This provides a number of functions which\r\n// need to be used to manipulate history state so we can deal with edge cases around\r\n// entry back button and refreshes once entered.\r\n//\r\n// These functions also transparently deal with the room slug, so incoming calls can ignore\r\n// dealing with it, and provides APIs for getting the non-slug part of the path.\r\n//\r\n// The slug cannot be part of the basename for history, because the slug changes intra-session\r\n// if the room is renamed.\r\n\r\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\r\n// keys, or clears state if k if null.\r\n//\r\n// Also maintains a length key that can be used to find the length of the history chain\r\n// (across refreshes) for the current room.\r\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\r\n  let state = {};\r\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\r\n\r\n  if (k || newPathname || newSearch) {\r\n    state = history.location.state ? { ...history.location.state } : {};\r\n    delete state.__duplicate;\r\n\r\n    if (k) {\r\n      state[k] = v;\r\n      state.key = k;\r\n      state.value = v;\r\n      state.detail = detail;\r\n    }\r\n  }\r\n\r\n  const pathname =\r\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\r\n\r\n  const search = newSearch !== undefined ? newSearch : history.location.search;\r\n\r\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\r\n  // at the top of the history stack (which was needed to wipe out forward history)\r\n  // so we use this opportunity to replace it.\r\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\r\n  const method = replace || isDuplicate ? history.replace : history.push;\r\n  state.__historyLength = newLength;\r\n\r\n  method({ pathname, search, state });\r\n}\r\n\r\nexport function pushHistoryState(history, k, v, detail) {\r\n  pushOrUpdateHistory(history, false, k, v, detail);\r\n}\r\n\r\nexport function replaceHistoryState(history, k, v, detail) {\r\n  pushOrUpdateHistory(history, true, k, v, detail);\r\n}\r\n\r\nexport function pushHistoryPath(history, path, search) {\r\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\r\n}\r\n\r\nexport function clearHistoryState(history) {\r\n  pushOrUpdateHistory(history, false);\r\n}\r\n\r\n// This will pop the browser history to the first entry that was for this hubs room,\r\n// and then push a duplicate entry onto the history stack in order to wipe out forward\r\n// history.\r\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\r\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\r\n\r\n  const len = history.location.state.__historyLength;\r\n  if (len === 0) return;\r\n\r\n  return new Promise(resolve => {\r\n    // After the go() completes, we push a duplicate history entry onto the stack\r\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\r\n    // to go back to the prior page.\r\n    const unsubscribe = history.listen(() => {\r\n      unsubscribe();\r\n      history.push({\r\n        pathname: history.location.pathname,\r\n        search: history.location.search,\r\n        state: { __historyLength: 0, __duplicate: true }\r\n      });\r\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\r\n      resolve();\r\n    });\r\n\r\n    history.go(-len);\r\n  });\r\n}\r\n\r\n// This will pop the browser history to the entry before the first entry for this hubs room.\r\nexport function navigateToPriorPage(history) {\r\n  popToBeginningOfHubHistory(history, true);\r\n}\r\n\r\n// Returns the part of the pathname that does not include the slug\r\nexport function sluglessPath(location) {\r\n  const parts = location.pathname.split(\"/\");\r\n  return `/${parts.slice(2).join(\"/\")}`;\r\n}\r\n\r\n// Returns a new path that includes the current slug as a prefix to the\r\n// provided path.\r\nexport function withSlug(location, path) {\r\n  const parts = location.pathname.split(\"/\");\r\n  return `/${parts[1]}${path}`;\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import Store from \"./storage/store\";\r\nimport MediaSearchStore from \"./storage/media-search-store\";\r\n\r\nexport class App {\r\n  constructor() {\r\n    this.scene = null;\r\n    this.quality = \"low\";\r\n    this.store = new Store();\r\n    this.mediaSearchStore = new MediaSearchStore();\r\n  }\r\n\r\n  setQuality(quality) {\r\n    if (this.quality === quality) {\r\n      return false;\r\n    }\r\n\r\n    this.quality = quality;\r\n\r\n    if (this.scene) {\r\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n","function loadAsync(loader, url, onProgress) {\r\n  return new Promise((resolve, reject) => loader.load(url, resolve, onProgress, reject));\r\n}\r\n\r\nexport default class HubsTextureLoader {\r\n  static crossOrigin = \"anonymous\";\r\n\r\n  constructor(manager = THREE.DefaultLoadingManager) {\r\n    this.manager = manager;\r\n  }\r\n\r\n  load(url, onLoad, onProgress, onError) {\r\n    const texture = new THREE.Texture();\r\n\r\n    this.loadTextureAsync(texture, url, onProgress)\r\n      .then(onLoad)\r\n      .catch(onError);\r\n\r\n    return texture;\r\n  }\r\n\r\n  async loadTextureAsync(texture, src, onProgress) {\r\n    let imageLoader;\r\n\r\n    if (window.createImageBitmap !== undefined) {\r\n      imageLoader = new THREE.ImageBitmapLoader(this.manager);\r\n      texture.flipY = false;\r\n    } else {\r\n      imageLoader = new THREE.ImageLoader(this.manager);\r\n    }\r\n\r\n    imageLoader.setCrossOrigin(this.crossOrigin);\r\n    imageLoader.setPath(this.path);\r\n\r\n    const cacheKey = this.manager.resolveURL(src);\r\n\r\n    texture.image = await loadAsync(imageLoader, src, onProgress);\r\n\r\n    // Image was just added to cache before this function gets called, disable caching by immediatly removing it\r\n    THREE.Cache.remove(cacheKey);\r\n\r\n    texture.needsUpdate = true;\r\n\r\n    texture.onUpdate = function() {\r\n      // Delete texture data once it has been uploaded to the GPU\r\n      texture.image.close && texture.image.close();\r\n      delete texture.image;\r\n    };\r\n\r\n    return texture;\r\n  }\r\n\r\n  setCrossOrigin(value) {\r\n    this.crossOrigin = value;\r\n    return this;\r\n  }\r\n\r\n  setPath(value) {\r\n    this.path = value;\r\n    return this;\r\n  }\r\n}\r\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\r\nimport { getReticulumFetchUrl } from \"./phoenix-utils\";\r\nimport { ObjectContentOrigins } from \"../object-types\";\r\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\r\nimport { mapMaterials } from \"./material-utils\";\r\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\r\nimport { validMaterials } from \"../components/hoverable-visuals\";\r\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\r\nimport Linkify from \"linkify-it\";\r\nimport tlds from \"tlds\";\r\n\r\nimport anime from \"animejs\";\r\n\r\nconst linkify = Linkify();\r\nlinkify.tlds(tlds);\r\n\r\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\nconst isMobileVR = AFRAME.utils.device.isMobile();\r\n\r\n// Map<String, Promise<Object>\r\nconst resolveUrlCache = new Map();\r\nexport const getDefaultResolveQuality = (is360 = false) => {\r\n  const useLowerQuality = isMobile || isMobileVR;\r\n  return !is360 ? (useLowerQuality ? \"low\" : \"high\") : useLowerQuality ? \"low_360\" : \"high_360\";\r\n};\r\n\r\nexport const resolveUrl = async (url, quality = null, version = 1) => {\r\n  const key = `${url}_${version}`;\r\n  if (resolveUrlCache.has(key)) return resolveUrlCache.get(key);\r\n\r\n  const resultPromise = fetch(mediaAPIEndpoint, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ media: { url, quality: quality || getDefaultResolveQuality() }, version })\r\n  }).then(async response => {\r\n    if (!response.ok) {\r\n      const message = `Error resolving url \"${url}\":`;\r\n      try {\r\n        const body = await response.text();\r\n        throw new Error(message + \" \" + body);\r\n      } catch (e) {\r\n        throw new Error(message + \" \" + response.statusText);\r\n      }\r\n    }\r\n    return response.json();\r\n  });\r\n\r\n  resolveUrlCache.set(key, resultPromise);\r\n  return resultPromise;\r\n};\r\n\r\nexport const upload = (file, desiredContentType) => {\r\n  const formData = new FormData();\r\n  formData.append(\"media\", file);\r\n  formData.append(\"promotion_mode\", \"with_token\");\r\n\r\n  if (desiredContentType) {\r\n    formData.append(\"desired_content_type\", desiredContentType);\r\n  }\r\n\r\n  return fetch(mediaAPIEndpoint, {\r\n    method: \"POST\",\r\n    body: formData\r\n  }).then(r => r.json());\r\n};\r\n\r\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\r\nfunction getOrientation(file, callback) {\r\n  const reader = new FileReader();\r\n  reader.onload = function(e) {\r\n    const view = new DataView(e.target.result);\r\n    if (view.getUint16(0, false) != 0xffd8) {\r\n      return callback(-2);\r\n    }\r\n    const length = view.byteLength;\r\n    let offset = 2;\r\n    while (offset < length) {\r\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\r\n      const marker = view.getUint16(offset, false);\r\n      offset += 2;\r\n      if (marker == 0xffe1) {\r\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\r\n          return callback(-1);\r\n        }\r\n\r\n        const little = view.getUint16((offset += 6), false) == 0x4949;\r\n        offset += view.getUint32(offset + 4, little);\r\n        const tags = view.getUint16(offset, little);\r\n        offset += 2;\r\n        for (let i = 0; i < tags; i++) {\r\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\r\n            return callback(view.getUint16(offset + i * 12 + 8, little));\r\n          }\r\n        }\r\n      } else if ((marker & 0xff00) != 0xff00) {\r\n        break;\r\n      } else {\r\n        offset += view.getUint16(offset, false);\r\n      }\r\n    }\r\n    return callback(-1);\r\n  };\r\n  reader.readAsArrayBuffer(file);\r\n}\r\n\r\nfunction getLatestMediaVersionOfSrc(src) {\r\n  const els = document.querySelectorAll(\"[media-loader]\");\r\n  let version = 1;\r\n\r\n  for (const el of els) {\r\n    const loader = el.components[\"media-loader\"];\r\n\r\n    if (loader.data && loader.data.src === src) {\r\n      version = Math.max(version, loader.data.version);\r\n    }\r\n  }\r\n\r\n  return version;\r\n}\r\n\r\nexport function coerceToUrl(urlOrText) {\r\n  if (!linkify.test(urlOrText)) return urlOrText;\r\n\r\n  // See: https://github.com/Soapbox/linkifyjs/blob/master/src/linkify.js#L52\r\n  return urlOrText.indexOf(\"://\") >= 0 ? urlOrText : `https://${urlOrText}`;\r\n}\r\n\r\nexport const addMedia = (\r\n  src,\r\n  template,\r\n  contentOrigin,\r\n  contentSubtype = null,\r\n  resolve = false,\r\n  fitToBox = false,\r\n  animate = true,\r\n  mediaOptions = {},\r\n  networked = true,\r\n  parentEl = null,\r\n  linkedEl = null\r\n) => {\r\n  const scene = AFRAME.scenes[0];\r\n\r\n  const entity = document.createElement(\"a-entity\");\r\n\r\n  if (networked) {\r\n    entity.setAttribute(\"networked\", { template: template });\r\n  } else {\r\n    const templateBody = document\r\n      .importNode(document.body.querySelector(template).content, true)\r\n      .firstElementChild.cloneNode(true);\r\n    const elAttrs = templateBody.attributes;\r\n\r\n    // Merge root element attributes with this entity\r\n    for (let attrIdx = 0; attrIdx < elAttrs.length; attrIdx++) {\r\n      entity.setAttribute(elAttrs[attrIdx].name, elAttrs[attrIdx].value);\r\n    }\r\n\r\n    // Append all child elements\r\n    while (templateBody.firstElementChild) {\r\n      entity.appendChild(templateBody.firstElementChild);\r\n    }\r\n  }\r\n\r\n  const needsToBeUploaded = src instanceof File;\r\n\r\n  // If we're re-pasting an existing src in the scene, we should use the latest version\r\n  // seen across any other entities. Otherwise, start with version 1.\r\n  const version = getLatestMediaVersionOfSrc(src);\r\n\r\n  entity.setAttribute(\"media-loader\", {\r\n    fitToBox,\r\n    resolve,\r\n    animate,\r\n    src: typeof src === \"string\" ? coerceToUrl(src) || src : \"\",\r\n    version,\r\n    contentSubtype,\r\n    fileIsOwned: !needsToBeUploaded,\r\n    linkedEl,\r\n    mediaOptions\r\n  });\r\n\r\n  entity.object3D.matrixNeedsUpdate = true;\r\n\r\n  (parentEl || scene).appendChild(entity);\r\n\r\n  const orientation = new Promise(function(resolve) {\r\n    if (needsToBeUploaded) {\r\n      getOrientation(src, x => {\r\n        resolve(x);\r\n      });\r\n    } else {\r\n      resolve(1);\r\n    }\r\n  });\r\n  if (needsToBeUploaded) {\r\n    // Video camera videos are converted to mp4 for compatibility\r\n    const desiredContentType = contentSubtype === \"video-camera\" ? \"video/mp4\" : null;\r\n\r\n    upload(src, desiredContentType)\r\n      .then(response => {\r\n        const srcUrl = new URL(proxiedUrlFor(response.origin));\r\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\r\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\r\n        window.APP.store.update({\r\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\r\n        });\r\n      })\r\n      .catch(e => {\r\n        console.error(\"Media upload failed\", e);\r\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\r\n      });\r\n  } else if (src instanceof MediaStream) {\r\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\r\n  }\r\n\r\n  if (contentOrigin) {\r\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\r\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\r\n      scene.emit(\"object_spawned\", { objectType });\r\n    });\r\n  }\r\n\r\n  return { entity, orientation };\r\n};\r\n\r\nexport const cloneMedia = (sourceEl, template, src = null, networked = true, link = false, parentEl = null) => {\r\n  if (!src) {\r\n    ({ src } = sourceEl.components[\"media-loader\"].data);\r\n  }\r\n\r\n  const { contentSubtype, fitToBox, mediaOptions } = sourceEl.components[\"media-loader\"].data;\r\n\r\n  return addMedia(\r\n    src,\r\n    template,\r\n    ObjectContentOrigins.URL,\r\n    contentSubtype,\r\n    true,\r\n    fitToBox,\r\n    false,\r\n    mediaOptions,\r\n    networked,\r\n    parentEl,\r\n    link ? sourceEl : null\r\n  );\r\n};\r\n\r\nexport function injectCustomShaderChunks(obj) {\r\n  const vertexRegex = /\\bskinning_vertex\\b/;\r\n  const fragRegex = /\\bgl_FragColor\\b/;\r\n\r\n  const shaderUniforms = [];\r\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\r\n\r\n  obj.traverse(object => {\r\n    if (!object.material) return;\r\n\r\n    object.material = mapMaterials(object, material => {\r\n      if (material.hubs_InjectedCustomShaderChunks) return material;\r\n      if (!validMaterials.includes(material.type)) {\r\n        return material;\r\n      }\r\n\r\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\r\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\r\n      // hover/toggle state, so for now just skip these while we figure out a more correct\r\n      // solution.\r\n      if (\r\n        object.el.classList.contains(\"ui\") ||\r\n        object.el.classList.contains(\"hud\") ||\r\n        object.el.getAttribute(\"text-button\")\r\n      )\r\n        return material;\r\n\r\n      // Used when the object is batched\r\n      batchManagerSystem.meshToEl.set(object, obj.el);\r\n\r\n      const newMaterial = material.clone();\r\n      // This will not run if the object is never rendered unbatched, since its unbatched shader will never be compiled\r\n      newMaterial.onBeforeCompile = shader => {\r\n        if (!vertexRegex.test(shader.vertexShader)) return;\r\n\r\n        shader.uniforms.hubs_IsFrozen = { value: false };\r\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\r\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\r\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\r\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\r\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\r\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\r\n        shader.uniforms.hubs_Time = { value: 0 };\r\n\r\n        const vchunk = `\r\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\r\n          vec4 wt = modelMatrix * vec4(transformed, 1);\r\n\r\n          // Used in the fragment shader below.\r\n          hubs_WorldPosition = wt.xyz;\r\n        }\r\n        `;\r\n\r\n        const vlines = shader.vertexShader.split(\"\\n\");\r\n        const vindex = vlines.findIndex(line => vertexRegex.test(line));\r\n        vlines.splice(vindex + 1, 0, vchunk);\r\n        vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\r\n        vlines.unshift(\"uniform bool hubs_IsFrozen;\");\r\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\r\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\r\n        shader.vertexShader = vlines.join(\"\\n\");\r\n\r\n        const flines = shader.fragmentShader.split(\"\\n\");\r\n        const findex = flines.findIndex(line => fragRegex.test(line));\r\n        flines.splice(findex + 1, 0, mediaHighlightFrag);\r\n        flines.unshift(\"varying vec3 hubs_WorldPosition;\");\r\n        flines.unshift(\"uniform bool hubs_IsFrozen;\");\r\n        flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\r\n        flines.unshift(\"uniform vec2 hubs_SweepParams;\");\r\n        flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\r\n        flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\r\n        flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\r\n        flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\r\n        flines.unshift(\"uniform float hubs_Time;\");\r\n        shader.fragmentShader = flines.join(\"\\n\");\r\n\r\n        shaderUniforms.push(shader.uniforms);\r\n      };\r\n      newMaterial.needsUpdate = true;\r\n      newMaterial.hubs_InjectedCustomShaderChunks = true;\r\n      return newMaterial;\r\n    });\r\n  });\r\n\r\n  return shaderUniforms;\r\n}\r\n\r\nexport function getPromotionTokenForFile(fileId) {\r\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\r\n}\r\n\r\nconst mediaPos = new THREE.Vector3();\r\n\r\nexport function addAndArrangeMedia(el, media, contentSubtype, snapCount, mirrorOrientation = false, distance = 0.75) {\r\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, contentSubtype, false);\r\n\r\n  const pos = el.object3D.position;\r\n\r\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\r\n  entity.object3D.rotation.copy(el.object3D.rotation);\r\n\r\n  if (mirrorOrientation) {\r\n    entity.object3D.rotateY(Math.PI);\r\n  }\r\n\r\n  // Generate photos in a circle around camera, starting from the bottom.\r\n  // Prevent z-fighting but place behind viewfinder\r\n  const idx = (snapCount % 6) + 3;\r\n\r\n  mediaPos.set(\r\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * distance,\r\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * distance,\r\n    -0.05 + idx * 0.001\r\n  );\r\n\r\n  el.object3D.localToWorld(mediaPos);\r\n  entity.object3D.visible = false;\r\n\r\n  const handler = () => {\r\n    entity.object3D.visible = true;\r\n    entity.setAttribute(\"animation__photo_pos\", {\r\n      property: \"position\",\r\n      dur: 800,\r\n      from: { x: pos.x, y: pos.y, z: pos.z },\r\n      to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\r\n      easing: \"easeOutElastic\"\r\n    });\r\n  };\r\n\r\n  let eventType = null;\r\n\r\n  if (contentSubtype.startsWith(\"photo\")) {\r\n    entity.addEventListener(\"image-loaded\", handler, { once: true });\r\n    eventType = \"photo\";\r\n  } else if (contentSubtype.startsWith(\"video\")) {\r\n    entity.addEventListener(\"video-loaded\", handler, { once: true });\r\n    eventType = \"video\";\r\n  } else {\r\n    console.error(\"invalid type \" + contentSubtype);\r\n    return;\r\n  }\r\n\r\n  entity.object3D.matrixNeedsUpdate = true;\r\n\r\n  entity.addEventListener(\r\n    \"media_resolved\",\r\n    () => {\r\n      el.emit(`${eventType}_taken`, entity.components[\"media-loader\"].data.src);\r\n    },\r\n    { once: true }\r\n  );\r\n\r\n  return { entity, orientation };\r\n}\r\n\r\nexport const textureLoader = new HubsTextureLoader().setCrossOrigin(\"anonymous\");\r\n\r\nexport async function createImageTexture(url, filter) {\r\n  let texture;\r\n\r\n  if (filter) {\r\n    const image = new Image();\r\n    image.crossOrigin = \"anonymous\";\r\n    const load = new Promise(res => image.addEventListener(\"load\", res, { once: true }));\r\n    image.src = url;\r\n    await load;\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = image.width;\r\n    canvas.height = image.height;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    ctx.drawImage(image, 0, 0);\r\n    await filter(ctx, image.width, image.height);\r\n\r\n    texture = new THREE.CanvasTexture(canvas);\r\n  } else {\r\n    texture = new THREE.Texture();\r\n\r\n    try {\r\n      await textureLoader.loadTextureAsync(texture, url);\r\n    } catch (e) {\r\n      throw new Error(`'${url}' could not be fetched (Error code: ${e.status}; Response: ${e.statusText})`);\r\n    }\r\n  }\r\n\r\n  texture.encoding = THREE.sRGBEncoding;\r\n  texture.anisotropy = 4;\r\n\r\n  return texture;\r\n}\r\n\r\nexport function addMeshScaleAnimation(mesh, initialScale, onComplete) {\r\n  const step = (function() {\r\n    const lastValue = {};\r\n    return function(anim) {\r\n      const value = anim.animatables[0].target;\r\n\r\n      value.x = Math.max(Number.MIN_VALUE, value.x);\r\n      value.y = Math.max(Number.MIN_VALUE, value.y);\r\n      value.z = Math.max(Number.MIN_VALUE, value.z);\r\n\r\n      // For animation timeline.\r\n      if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\r\n        return;\r\n      }\r\n\r\n      lastValue.x = value.x;\r\n      lastValue.y = value.y;\r\n      lastValue.z = value.z;\r\n\r\n      mesh.scale.set(value.x, value.y, value.z);\r\n      mesh.matrixNeedsUpdate = true;\r\n    };\r\n  })();\r\n\r\n  const config = {\r\n    duration: 400,\r\n    easing: \"easeOutElastic\",\r\n    elasticity: 400,\r\n    loop: 0,\r\n    round: false,\r\n    x: mesh.scale.x,\r\n    y: mesh.scale.y,\r\n    z: mesh.scale.z,\r\n    targets: [initialScale],\r\n    update: anim => step(anim),\r\n    complete: anim => {\r\n      step(anim);\r\n      if (onComplete) onComplete();\r\n    }\r\n  };\r\n\r\n  mesh.scale.copy(initialScale);\r\n  mesh.matrixNeedsUpdate = true;\r\n\r\n  return anime(config);\r\n}\r\n\r\nexport function closeExistingMediaMirror() {\r\n  const mirrorTarget = document.querySelector(\"#media-mirror-target\");\r\n\r\n  // Remove old mirror target media element\r\n  if (mirrorTarget.firstChild) {\r\n    mirrorTarget.firstChild.setAttribute(\"animation__remove\", {\r\n      property: \"scale\",\r\n      dur: 200,\r\n      to: { x: 0.01, y: 0.01, z: 0.01 },\r\n      easing: \"easeInQuad\"\r\n    });\r\n\r\n    return new Promise(res => {\r\n      mirrorTarget.firstChild.addEventListener(\"animationcomplete\", () => {\r\n        mirrorTarget.removeChild(mirrorTarget.firstChild);\r\n        mirrorTarget.parentEl.object3D.visible = false;\r\n        res();\r\n      });\r\n    });\r\n  }\r\n}\r\n","/*\r\nHACK Fix a-frame's device detection in Chrome when WebXR or WebVR flags are enabled in\r\nchrome://flags. See https://github.com/mozilla/hubs/issues/892\r\n*/\r\nif (!/Oculus/.test(navigator.userAgent) && navigator.xr && !navigator.xr.requestDevice) {\r\n  navigator.xr.requestDevice = () => Promise.reject({ message: \"Hubs: requestDevice not supported.\" });\r\n}\r\n/*\r\nHACK Call getVRDisplays to force Oculus Browser to use WebVR, which in turn disables the WebXR API.\r\n*/\r\nif (/Oculus/.test(navigator.userAgent)) {\r\n  navigator.getVRDisplays();\r\n}\r\n","/* global fetch THREE */\r\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\r\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\r\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\r\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\r\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\r\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\r\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\r\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\r\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\r\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\r\nimport URL_POP from \"../assets/sfx/pop.mp3\";\r\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\r\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\r\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\r\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\r\nimport URL_SPAWN_EMOJI from \"../assets/sfx/emoji.mp3\";\r\nimport { setMatrixWorld } from \"../utils/three-utils\";\r\n\r\nlet soundEnum = 0;\r\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\r\nexport const SOUND_THAW = soundEnum++;\r\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\r\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\r\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\r\nexport const SOUND_TOGGLE_MIC = soundEnum++;\r\nexport const SOUND_TELEPORT_START = soundEnum++;\r\nexport const SOUND_TELEPORT_END = soundEnum++;\r\nexport const SOUND_WAYPOINT_START = soundEnum++;\r\nexport const SOUND_WAYPOINT_END = soundEnum++;\r\nexport const SOUND_SNAP_ROTATE = soundEnum++;\r\nexport const SOUND_SPAWN_PEN = soundEnum++;\r\nexport const SOUND_PEN_START_DRAW = soundEnum++;\r\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\r\nexport const SOUND_ENTER_SCENE = soundEnum++;\r\nexport const SOUND_QUACK = soundEnum++;\r\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\r\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\r\nexport const SOUND_FREEZE = soundEnum++;\r\nexport const SOUND_PIN = soundEnum++;\r\nexport const SOUND_MEDIA_LOADING = soundEnum++;\r\nexport const SOUND_MEDIA_LOADED = soundEnum++;\r\nexport const SOUND_CAMERA_TOOL_COUNTDOWN = soundEnum++;\r\nexport const SOUND_PREFERENCE_MENU_HOVER = soundEnum++;\r\nexport const SOUND_PREFERENCE_MENU_SELECT = soundEnum++;\r\nexport const SOUND_SPAWN_EMOJI = soundEnum++;\r\n\r\n// Safari doesn't support the promise form of decodeAudioData, so we polyfill it.\r\nfunction decodeAudioData(audioContext, arrayBuffer) {\r\n  return new Promise((resolve, reject) => {\r\n    audioContext.decodeAudioData(arrayBuffer, resolve, reject);\r\n  });\r\n}\r\n\r\nexport class SoundEffectsSystem {\r\n  constructor(scene) {\r\n    this.pendingAudioSourceNodes = [];\r\n    this.pendingPositionalAudios = [];\r\n    this.positionalAudiosStationary = [];\r\n    this.positionalAudiosFollowingObject3Ds = [];\r\n\r\n    this.audioContext = THREE.AudioContext.getContext();\r\n    this.scene = scene;\r\n    this.scene.audioListener = this.scene.audioListener || new THREE.AudioListener();\r\n    if (this.scene.camera) {\r\n      this.scene.camera.add(this.scene.audioListener);\r\n    }\r\n    this.scene.addEventListener(\"camera-set-active\", evt => {\r\n      evt.detail.cameraEl.getObject3D(\"camera\").add(this.scene.audioListener);\r\n    });\r\n    const soundsAndUrls = [\r\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\r\n      [SOUND_THAW, URL_TICK],\r\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\r\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\r\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\r\n      [SOUND_TOGGLE_MIC, URL_TICK],\r\n      [SOUND_CAMERA_TOOL_COUNTDOWN, URL_TICK],\r\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\r\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\r\n      [SOUND_WAYPOINT_START, URL_QUICK_TURN],\r\n      [SOUND_WAYPOINT_END, URL_TICK],\r\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\r\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\r\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\r\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\r\n      [SOUND_ENTER_SCENE, URL_WELCOME],\r\n      [SOUND_QUACK, URL_QUACK],\r\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\r\n      [SOUND_CHAT_MESSAGE, URL_POP],\r\n      [SOUND_FREEZE, URL_FREEZE],\r\n      [SOUND_PIN, URL_TACK],\r\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\r\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED],\r\n      [SOUND_PREFERENCE_MENU_HOVER, URL_FREEZE],\r\n      [SOUND_PREFERENCE_MENU_SELECT, URL_TICK],\r\n      [SOUND_SPAWN_EMOJI, URL_SPAWN_EMOJI]\r\n    ];\r\n    const loading = new Map();\r\n    const load = url => {\r\n      let audioBufferPromise = loading.get(url);\r\n      if (!audioBufferPromise) {\r\n        audioBufferPromise = fetch(url)\r\n          .then(r => r.arrayBuffer())\r\n          .then(arrayBuffer => decodeAudioData(this.audioContext, arrayBuffer));\r\n        loading.set(url, audioBufferPromise);\r\n      }\r\n      return audioBufferPromise;\r\n    };\r\n    this.sounds = new Map();\r\n    soundsAndUrls.map(([sound, url]) => {\r\n      load(url).then(audioBuffer => {\r\n        this.sounds.set(sound, audioBuffer);\r\n      });\r\n    });\r\n  }\r\n\r\n  enqueueSound(sound, loop) {\r\n    const audioBuffer = this.sounds.get(sound);\r\n    if (!audioBuffer) return null;\r\n    // The nodes are very inexpensive to create, according to\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\r\n    const source = this.audioContext.createBufferSource();\r\n    source.buffer = audioBuffer;\r\n    source.connect(this.audioContext.destination);\r\n    source.loop = loop;\r\n    this.pendingAudioSourceNodes.push(source);\r\n    return source;\r\n  }\r\n\r\n  enqueuePositionalSound(sound, loop) {\r\n    const audioBuffer = this.sounds.get(sound);\r\n    if (!audioBuffer) return null;\r\n\r\n    const positionalAudio = new THREE.PositionalAudio(this.scene.audioListener).setBuffer(audioBuffer);\r\n    positionalAudio.loop = loop;\r\n    this.pendingPositionalAudios.push(positionalAudio);\r\n    return positionalAudio;\r\n  }\r\n\r\n  playPositionalSoundAt(sound, position, loop) {\r\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\r\n    if (!positionalAudio) return null;\r\n    positionalAudio.position.copy(position);\r\n    positionalAudio.matrixWorldNeedsUpdate = true;\r\n    this.positionalAudiosStationary.push(positionalAudio);\r\n  }\r\n\r\n  playPositionalSoundFollowing(sound, object3D, loop) {\r\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\r\n    if (!positionalAudio) return null;\r\n    this.positionalAudiosFollowingObject3Ds.push({ positionalAudio, object3D });\r\n    return positionalAudio;\r\n  }\r\n\r\n  playSoundOneShot(sound) {\r\n    return this.enqueueSound(sound, false);\r\n  }\r\n\r\n  playSoundLooped(sound) {\r\n    return this.enqueueSound(sound, true);\r\n  }\r\n\r\n  playSoundLoopedWithGain(sound) {\r\n    const audioBuffer = this.sounds.get(sound);\r\n    if (!audioBuffer) return null;\r\n\r\n    const source = this.audioContext.createBufferSource();\r\n    const gain = this.audioContext.createGain();\r\n    source.buffer = audioBuffer;\r\n    source.connect(gain);\r\n    gain.connect(this.audioContext.destination);\r\n    source.loop = true;\r\n    this.pendingAudioSourceNodes.push(source);\r\n    return { gain, source };\r\n  }\r\n\r\n  stopSoundNode(node) {\r\n    const index = this.pendingAudioSourceNodes.indexOf(node);\r\n    if (index !== -1) {\r\n      this.pendingAudioSourceNodes.splice(index, 1);\r\n    } else {\r\n      node.stop();\r\n    }\r\n  }\r\n\r\n  stopPositionalAudio(inPositionalAudio) {\r\n    const pendingIndex = this.pendingPositionalAudios.indexOf(inPositionalAudio);\r\n    if (pendingIndex !== -1) {\r\n      this.pendingPositionalAudios.splice(pendingIndex, 1);\r\n    } else {\r\n      if (inPositionalAudio.isPlaying) {\r\n        inPositionalAudio.stop();\r\n      }\r\n      if (inPositionalAudio.parent) {\r\n        inPositionalAudio.parent.remove(inPositionalAudio);\r\n      }\r\n    }\r\n    this.positionalAudiosStationary = this.positionalAudiosStationary.filter(\r\n      positionalAudio => positionalAudio !== inPositionalAudio\r\n    );\r\n    this.positionalAudiosFollowingObject3Ds = this.positionalAudiosFollowingObject3Ds.filter(\r\n      ({ positionalAudio }) => positionalAudio !== inPositionalAudio\r\n    );\r\n  }\r\n\r\n  tick() {\r\n    for (let i = 0; i < this.pendingAudioSourceNodes.length; i++) {\r\n      this.pendingAudioSourceNodes[i].start();\r\n    }\r\n    this.pendingAudioSourceNodes.length = 0;\r\n\r\n    for (let i = 0; i < this.pendingPositionalAudios.length; i++) {\r\n      const pendingPositionalAudio = this.pendingPositionalAudios[i];\r\n      this.scene.object3D.add(pendingPositionalAudio);\r\n      pendingPositionalAudio.play();\r\n    }\r\n    this.pendingPositionalAudios.length = 0;\r\n\r\n    for (let i = this.positionalAudiosStationary.length - 1; i >= 0; i--) {\r\n      const positionalAudio = this.positionalAudiosStationary[i];\r\n      if (!positionalAudio.isPlaying) {\r\n        this.stopPositionalAudio(positionalAudio);\r\n      }\r\n    }\r\n\r\n    for (let i = this.positionalAudiosFollowingObject3Ds.length - 1; i >= 0; i--) {\r\n      const positionalAudioAndObject3D = this.positionalAudiosFollowingObject3Ds[i];\r\n      const positionalAudio = positionalAudioAndObject3D.positionalAudio;\r\n      const object3D = positionalAudioAndObject3D.object3D;\r\n      if (!positionalAudio.isPlaying || !object3D.parent) {\r\n        this.stopPositionalAudio(positionalAudio);\r\n      } else {\r\n        object3D.updateMatrices();\r\n        setMatrixWorld(positionalAudio, object3D.matrixWorld);\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { easeOutQuadratic } from \"../utils/easing\";\r\n\r\n// This computation is expensive, so we run on at most one avatar per frame, including quiet avatars.\r\n// However if we detect an avatar is seen speaking (its volume is above DISABLE_AT_VOLUME_THRESHOLD)\r\n// then we continue analysis for at least DISABLE_GRACE_PERIOD_MS and disable doing it every frame if\r\n// the avatar is quiet during that entire duration (eg they are muted)\r\nconst DISABLE_AT_VOLUME_THRESHOLD = 0.00001;\r\nconst DISABLE_GRACE_PERIOD_MS = 10000;\r\nconst MIN_VOLUME_THRESHOLD = 0.08;\r\n\r\nconst calculateVolume = (analyser, levels) => {\r\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\r\n  analyser.getByteTimeDomainData(levels);\r\n  let sum = 0;\r\n  for (let i = 0; i < levels.length; i++) {\r\n    const amplitude = (levels[i] - 128) / 128;\r\n    sum += amplitude * amplitude;\r\n  }\r\n  const currVolume = Math.sqrt(sum / levels.length);\r\n  return currVolume;\r\n};\r\n\r\nconst tempScaleFromPosition = new THREE.Vector3();\r\nconst tempScaleToPosition = new THREE.Vector3();\r\n\r\nexport function getAudioFeedbackScale(fromObject, toObject, minScale, maxScale, volume) {\r\n  tempScaleToPosition.setFromMatrixPosition(toObject.matrixWorld);\r\n  tempScaleFromPosition.setFromMatrixPosition(fromObject.matrixWorld);\r\n  const distance = tempScaleFromPosition.distanceTo(tempScaleToPosition) / 10;\r\n  return Math.min(maxScale, minScale + (maxScale - minScale) * volume * 8 * distance);\r\n}\r\n\r\nfunction updateVolume(component) {\r\n  const newRawVolume = calculateVolume(component.analyser, component.levels);\r\n\r\n  const newPerceivedVolume = Math.log(THREE.Math.mapLinear(newRawVolume, 0, 1, 1, Math.E));\r\n\r\n  component.volume = newPerceivedVolume < MIN_VOLUME_THRESHOLD ? 0 : newPerceivedVolume;\r\n\r\n  const s = component.volume > component.prevVolume ? 0.35 : 0.3;\r\n  component.volume = s * component.volume + (1 - s) * component.prevVolume;\r\n  component.prevVolume = component.volume;\r\n}\r\n\r\n/**\r\n * Updates a `volume` property based on a networked audio source\r\n * @namespace avatar\r\n * @component networked-audio-analyser\r\n */\r\nAFRAME.registerComponent(\"networked-audio-analyser\", {\r\n  async init() {\r\n    this.volume = 0;\r\n    this.prevVolume = 0;\r\n    this.loudest = 0;\r\n\r\n    this._updateAnalysis = this._updateAnalysis.bind(this);\r\n    this._runScheduledWork = this._runScheduledWork.bind(this);\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateAnalysis, \"audio-analyser\");\r\n    this.el.addEventListener(\"sound-source-set\", event => {\r\n      const ctx = THREE.AudioContext.getContext();\r\n      this.analyser = ctx.createAnalyser();\r\n      this.analyser.fftSize = 32;\r\n      this.levels = new Uint8Array(this.analyser.fftSize);\r\n      event.detail.soundSource.connect(this.analyser);\r\n    });\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"audio-analyser\");\r\n  },\r\n\r\n  tick: function(t) {\r\n    if (!this.avatarIsQuiet) {\r\n      this._updateAnalysis(t);\r\n    }\r\n  },\r\n\r\n  _runScheduledWork: function() {\r\n    if (this.avatarIsQuiet) {\r\n      this._updateAnalysis();\r\n    }\r\n  },\r\n\r\n  // Updates the analysis/volume. If t is passed, that implies this is called via tick\r\n  // and so as a performance optimization will check to see if it's been at least DISABLE_GRACE_PERIOD_MS\r\n  // since the last volume was seen above DISABLE_AT_VOLUME_THRESHOLD, and if so, will disable\r\n  // tick updates until the volume exceeds the level again.\r\n  _updateAnalysis: function(t) {\r\n    if (!this.analyser) return;\r\n\r\n    updateVolume(this);\r\n\r\n    if (this.volume < DISABLE_AT_VOLUME_THRESHOLD) {\r\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - DISABLE_GRACE_PERIOD_MS) {\r\n        this.avatarIsQuiet = true;\r\n      }\r\n    } else {\r\n      if (t) {\r\n        this.lastSeenVolume = t;\r\n      }\r\n\r\n      this.avatarIsQuiet = false;\r\n    }\r\n  }\r\n});\r\n\r\nfunction connectAnalyser(mediaStream) {\r\n  const ctx = THREE.AudioContext.getContext();\r\n  const source = ctx.createMediaStreamSource(mediaStream);\r\n  const analyser = ctx.createAnalyser();\r\n  analyser.fftSize = 32;\r\n  const levels = new Uint8Array(analyser.fftSize);\r\n  source.connect(analyser);\r\n  return { analyser, levels };\r\n}\r\n\r\nfunction getAnalyser(el) {\r\n  // Is this the local player\r\n  const ikRootEl = findAncestorWithComponent(el, \"ik-root\");\r\n  if (ikRootEl && ikRootEl.id === \"avatar-rig\") {\r\n    return el.sceneEl.systems[\"local-audio-analyser\"];\r\n  } else {\r\n    const analyserEl = findAncestorWithComponent(el, \"networked-audio-analyser\");\r\n    if (!analyserEl) return null;\r\n    return analyserEl.components[\"networked-audio-analyser\"];\r\n  }\r\n}\r\n\r\n/**\r\n * Calculates volume of the local audio stream.\r\n */\r\nAFRAME.registerSystem(\"local-audio-analyser\", {\r\n  init() {\r\n    this.volume = 0;\r\n    this.loudest = 0;\r\n    this.prevVolume = 0;\r\n\r\n    this.el.addEventListener(\"local-media-stream-created\", e => {\r\n      const mediaStream = e.detail.mediaStream;\r\n      if (this.stream) {\r\n        console.warn(\"media stream changed\", this.stream, mediaStream);\r\n        // TODO: cleanup?\r\n      }\r\n      this.stream = mediaStream;\r\n      const { analyser, levels } = connectAnalyser(mediaStream);\r\n      this.analyser = analyser;\r\n      this.levels = levels;\r\n    });\r\n  },\r\n\r\n  tick: function() {\r\n    if (!this.analyser) return;\r\n    updateVolume(this);\r\n  }\r\n});\r\n\r\n/**\r\n * Sets an entity's scale base on the volume of an audio-analyser in a parent entity.\r\n * @namespace avatar\r\n * @component scale-audio-feedback\r\n */\r\nAFRAME.registerComponent(\"scale-audio-feedback\", {\r\n  schema: {\r\n    minScale: { default: 1 },\r\n    maxScale: { default: 1.5 }\r\n  },\r\n\r\n  async init() {\r\n    await waitForDOMContentLoaded();\r\n    this.camera = document.getElementById(\"viewing-camera\").object3D;\r\n  },\r\n\r\n  tick() {\r\n    // TODO: come up with a cleaner way to handle this.\r\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\r\n    if (!this.el.object3D.visible) return;\r\n    if (!this.camera) return;\r\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\r\n\r\n    const { minScale, maxScale } = this.data;\r\n\r\n    const { object3D } = this.el;\r\n\r\n    const scale = getAudioFeedbackScale(\r\n      this.el.object3D,\r\n      this.camera,\r\n      minScale,\r\n      maxScale,\r\n      this.analyser ? this.analyser.volume : 0\r\n    );\r\n\r\n    object3D.scale.setScalar(scale);\r\n    object3D.matrixNeedsUpdate = true;\r\n  }\r\n});\r\n\r\n/**\r\n * Animates a morph target based on an audio-analyser in a parent entity\r\n * @namespace avatar\r\n * @component morph-audio-feedback\r\n */\r\nAFRAME.registerComponent(\"morph-audio-feedback\", {\r\n  schema: {\r\n    name: { default: \"\" },\r\n    minValue: { default: 0 },\r\n    maxValue: { default: 2 }\r\n  },\r\n\r\n  init() {\r\n    this.mesh = this.el.object3DMap.skinnedmesh;\r\n    this.morphNumber = this.mesh.morphTargetDictionary[this.data.name];\r\n  },\r\n\r\n  tick() {\r\n    if (!this.mesh) return;\r\n\r\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\r\n\r\n    const { minValue, maxValue } = this.data;\r\n    this.mesh.morphTargetInfluences[this.morphNumber] = THREE.Math.mapLinear(\r\n      easeOutQuadratic(this.analyser ? this.analyser.volume : 0),\r\n      0,\r\n      1,\r\n      minValue,\r\n      maxValue\r\n    );\r\n  }\r\n});\r\n\r\nconst SPRITE_NAMES = {\r\n  MIC: [\"mic-0.png\", \"mic-1.png\", \"mic-2.png\", \"mic-3.png\", \"mic-4.png\", \"mic-5.png\", \"mic-6.png\", \"mic-7.png\"],\r\n  MIC_HOVER: [\r\n    \"mic-0_hover.png\",\r\n    \"mic-1_hover.png\",\r\n    \"mic-2_hover.png\",\r\n    \"mic-3_hover.png\",\r\n    \"mic-4_hover.png\",\r\n    \"mic-5_hover.png\",\r\n    \"mic-6_hover.png\",\r\n    \"mic-7_hover.png\"\r\n  ],\r\n  MIC_OFF: [\r\n    \"mic-off-0.png\",\r\n    \"mic-off-1.png\",\r\n    \"mic-off-2.png\",\r\n    \"mic-off-3.png\",\r\n    \"mic-off-4.png\",\r\n    \"mic-off-5.png\",\r\n    \"mic-off-6.png\",\r\n    \"mic-off-7.png\"\r\n  ],\r\n  MIC_OFF_HOVER: [\r\n    \"mic-off-0_hover.png\",\r\n    \"mic-off-1_hover.png\",\r\n    \"mic-off-2_hover.png\",\r\n    \"mic-off-3_hover.png\",\r\n    \"mic-off-4_hover.png\",\r\n    \"mic-off-5_hover.png\",\r\n    \"mic-off-6_hover.png\",\r\n    \"mic-off-7_hover.png\"\r\n  ]\r\n};\r\n\r\nexport function micLevelForVolume(volume) {\r\n  return THREE.Math.clamp(Math.ceil(THREE.Math.mapLinear(volume - 0.05, 0, 1, 0, 7)), 0, 7);\r\n}\r\n\r\nAFRAME.registerComponent(\"mic-button\", {\r\n  schema: {\r\n    active: { type: \"boolean\" },\r\n    tooltip: { type: \"selector\" },\r\n    tooltipText: { type: \"string\" },\r\n    activeTooltipText: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    this.prevSpriteName = \"\";\r\n    this.el.object3D.matrixNeedsUpdate = true;\r\n    this.hovering = false;\r\n    this.onHover = () => {\r\n      this.hovering = true;\r\n      this.data.tooltip.setAttribute(\"visible\", true);\r\n    };\r\n    this.onHoverOut = () => {\r\n      this.hovering = false;\r\n      this.data.tooltip.setAttribute(\"visible\", false);\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  update() {\r\n    if (this.data.tooltip) {\r\n      this.textEl = this.data.tooltip.querySelector(\"[text]\");\r\n    }\r\n  },\r\n\r\n  tick() {\r\n    const audioAnalyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\r\n    const active = this.data.active;\r\n    const hovering = this.hovering;\r\n    const spriteNames =\r\n      SPRITE_NAMES[!active ? (hovering ? \"MIC_HOVER\" : \"MIC\") : hovering ? \"MIC_OFF_HOVER\" : \"MIC_OFF\"];\r\n    const level = micLevelForVolume(audioAnalyser.volume);\r\n    const spriteName = spriteNames[level];\r\n    if (spriteName !== this.prevSpriteName) {\r\n      this.prevSpriteName = spriteName;\r\n      this.el.setAttribute(\"sprite\", \"name\", spriteName);\r\n    }\r\n\r\n    if (this.data.tooltip && hovering) {\r\n      this.textEl = this.textEl || this.data.tooltip.querySelector(\"[text]\");\r\n      this.textEl.setAttribute(\"text\", \"value\", active ? this.data.activeTooltipText : this.data.tooltipText);\r\n    }\r\n  }\r\n});\r\n","import configs from \"../utils/configs\";\r\n\r\nexport default function IfFeature(props) {\r\n  return (configs.feature(props.name) && props.children) || null;\r\n}\r\n","export function addAnimationComponents(modelEl) {\r\n  if (!modelEl.components[\"animation-mixer\"]) {\r\n    return;\r\n  }\r\n\r\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\r\n    modelEl.setAttribute(\"loop-animation\", \"\");\r\n  }\r\n}\r\n","export function easeOutQuadratic(t) {\r\n  return t * (2 - t);\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3\";","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nexport default class DialogContainer extends Component {\r\n  static propTypes = {\r\n    title: PropTypes.node,\r\n    children: PropTypes.node.isRequired,\r\n    onClose: PropTypes.func,\r\n    closable: PropTypes.bool,\r\n    wide: PropTypes.bool,\r\n    noOverlay: PropTypes.bool,\r\n    className: PropTypes.string,\r\n    allowOverflow: PropTypes.bool,\r\n    additionalClass: PropTypes.string\r\n  };\r\n\r\n  static defaultProps = {\r\n    closable: true\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.onKeyDown = this.onKeyDown.bind(this);\r\n    this.onContainerClicked = this.onContainerClicked.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.addEventListener(\"keydown\", this.onKeyDown);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener(\"keydown\", this.onKeyDown);\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    if (this.props.closable && e.key === \"Escape\") {\r\n      this.props.onClose();\r\n    }\r\n  }\r\n\r\n  onContainerClicked = e => {\r\n    if (this.props.closable && e.currentTarget === e.target) {\r\n      this.props.onClose();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        className={classNames(\r\n          \"dialog-overlay\",\r\n          this.props.noOverlay ? \"dialog-overlay__no-pointer-events\" : \"\",\r\n          this.props.className\r\n        )}\r\n      >\r\n        <div\r\n          className={classNames(\r\n            \"dialog\",\r\n            this.props.noOverlay ? \"dialog__no-pointer-events\" : \"dialog__dark-background\",\r\n            this.props.noOverlay ? \"dialog__align-end\" : \"\"\r\n          )}\r\n          onClick={this.onContainerClicked}\r\n        >\r\n          <div className={`dialog__box ${this.props.wide ? \"dialog__wide\" : \"\"} `}>\r\n            <div\r\n              className={classNames(\r\n                \"dialog__box__contents\",\r\n                this.props.allowOverflow ? \"dialog__box__contents-overflow\" : null,\r\n                this.props.additionalClass\r\n              )}\r\n            >\r\n              {this.props.closable &&\r\n                this.props.onClose &&\r\n                !this.props.noOverlay && (\r\n                  <button className=\"dialog__box__contents__close\" onClick={() => this.props.onClose()}>\r\n                    <i>\r\n                      <FontAwesomeIcon icon={faTimes} />\r\n                    </i>\r\n                  </button>\r\n                )}\r\n              {this.props.title && <div className=\"dialog__box__contents__title\">{this.props.title}</div>}\r\n              <div className=\"dialog__box__contents__body\">{this.props.children}</div>\r\n              <div className=\"dialog__box__contents__button-container\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","const qs = new URLSearchParams(location.search);\r\n\r\nexport default function qsTruthy(param) {\r\n  const val = qs.get(param);\r\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\r\n  return val === \"\" || /1|on|true|yes/i.test(val);\r\n}\r\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\r\n// via the query string.\r\nimport debug from \"debug\";\r\nimport qsTruthy from \"./qs_truthy\";\r\n\r\nconst qs = new URLSearchParams(location.search);\r\nconst isDebug = qsTruthy(\"debug\");\r\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*\");\r\n\r\nif (logFilter) {\r\n  debug.enable(logFilter);\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nexport const ReactAudioContext = React.createContext({});\r\n\r\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\r\n\r\nexport const WithHoverSound = ({ sound, children }) => {\r\n  return (\r\n    <ReactAudioContext.Consumer>\r\n      {context => {\r\n        return React.cloneElement(children, {\r\n          onMouseEnter: e => {\r\n            if (context && context.playSound) {\r\n              context.playSound(sound || hudHoverSound);\r\n            }\r\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\r\n          }\r\n        });\r\n      }}\r\n    </ReactAudioContext.Consumer>\r\n  );\r\n};\r\n\r\nWithHoverSound.propTypes = {\r\n  children: PropTypes.object,\r\n  sound: PropTypes.string\r\n};\r\n","const THREE = AFRAME.THREE;\r\n\r\nfunction checkFloatTextureSupport() {\r\n  const renderer = new THREE.WebGLRenderer();\r\n\r\n  const scene = new THREE.Scene();\r\n  const size = 2;\r\n  const data = new Float32Array(size * size * 4);\r\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\r\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\r\n  box.material.map.needsUpdate = true;\r\n  scene.add(box);\r\n\r\n  renderer.render(scene, new THREE.Camera());\r\n  const result = renderer.context.getError() === 0;\r\n  renderer.dispose();\r\n  return result;\r\n}\r\n\r\nexport function patchWebGLRenderingContext() {\r\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\r\n    // It appears that Galaxy S6 devices falsely report that they support\r\n    // OES_texture_float in Firefox. This workaround disables float textures\r\n    // for those devices.\r\n    // See https://github.com/mozilla/hubs/issues/32 and\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\r\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\r\n    const supportsFloatTextures = checkFloatTextureSupport();\r\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\r\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\r\n        return null;\r\n      }\r\n      return originalGetExtension.call(this, name);\r\n    };\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/models/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb\";","module.exports = __webpack_public_path__ + \"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/welcome-0083300978d5dd05eaa376f65761da47.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/emoji-27673179a22e6f42e8187ccba07e4dce.mp3\";","import { CAMERA_MODE_INSPECT } from \"./camera-system.js\";\r\n\r\nexport class ScenePreviewCameraSystem {\r\n  constructor() {\r\n    this.entities = [];\r\n  }\r\n\r\n  register(el) {\r\n    this.entities.push(el);\r\n  }\r\n\r\n  unregister(el) {\r\n    this.entities.splice(this.entities.indexOf(el, 1));\r\n  }\r\n\r\n  tick() {\r\n    for (const el of this.entities) {\r\n      const hubsSystems = AFRAME.scenes[0].systems[\"hubs-systems\"];\r\n      if (el && (!hubsSystems || hubsSystems.cameraSystem.mode !== CAMERA_MODE_INSPECT)) {\r\n        el.components[\"scene-preview-camera\"].tick2();\r\n      }\r\n    }\r\n  }\r\n}\r\n","const zeroPos = new THREE.Vector3(0, 0, 0);\r\nconst zeroQuat = new THREE.Quaternion();\r\nconst oneScale = new THREE.Vector3(1, 1, 1);\r\nconst identity = new THREE.Matrix4();\r\nidentity.identity();\r\n\r\n// Patch animation system\r\nconst bindingSetters = THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning;\r\nconst Versioning = THREE.PropertyBinding.prototype.Versioning;\r\n\r\n// For all binding types, monkey patch the setters that require world matrix\r\n// updates to also flip matrixNeedsUpdate\r\nfor (let i = 0; i < bindingSetters.length; i++) {\r\n  const setter = bindingSetters[i][Versioning.MatrixWorldNeedsUpdate];\r\n  if (!setter) continue;\r\n\r\n  bindingSetters[i][Versioning.MatrixWorldNeedsUpdate] = function() {\r\n    const v = setter.apply(this, arguments);\r\n    this.targetObject.matrixNeedsUpdate = true;\r\n    return v;\r\n  };\r\n}\r\n\r\nTHREE.Object3D.prototype.getWorldPosition = function(target) {\r\n  if (target === undefined) {\r\n    console.warn(\"THREE.Object3D: .getWorldPosition() target is now required\");\r\n    target = new THREE.Vector3();\r\n  }\r\n\r\n  // New function, defined below (used instead of updateMatrixWorld)\r\n  this.updateMatrices();\r\n\r\n  return target.setFromMatrixPosition(this.matrixWorld);\r\n};\r\n\r\nTHREE.Object3D.prototype.getWorldQuaternion = (function() {\r\n  const position = new THREE.Vector3();\r\n  const scale = new THREE.Vector3();\r\n\r\n  return function getWorldQuaternion(target) {\r\n    if (target === undefined) {\r\n      console.warn(\"THREE.Object3D: .getWorldQuaternion() target is now required\");\r\n      target = new THREE.Quaternion();\r\n    }\r\n\r\n    // New function, defined below (used instead of updateMatrixWorld)\r\n    this.updateMatrices();\r\n    this.matrixWorld.decompose(position, target, scale);\r\n\r\n    return target;\r\n  };\r\n})();\r\n\r\nTHREE.Object3D.getWorldScale = (function() {\r\n  const position = new THREE.Vector3();\r\n  const quaternion = new THREE.Quaternion();\r\n\r\n  return function getWorldScale(target) {\r\n    if (target === undefined) {\r\n      console.warn(\"THREE.Object3D: .getWorldScale() target is now required\");\r\n      target = new THREE.Vector3();\r\n    }\r\n\r\n    // New function, defined below (used instead of updateMatrixWorld)\r\n    this.updateMatrices();\r\n    this.matrixWorld.decompose(position, quaternion, target);\r\n\r\n    return target;\r\n  };\r\n})();\r\n\r\nconst handleMatrixModification = o => {\r\n  if (!o.matrixIsModified) {\r\n    o.matrixIsModified = true;\r\n\r\n    if (o.cachedMatrixWorld) {\r\n      o.cachedMatrixWorld.copy(o.matrixWorld);\r\n      o.matrixWorld = o.cachedMatrixWorld;\r\n    }\r\n  }\r\n};\r\n\r\nconst updateMatrix = THREE.Object3D.prototype.updateMatrix;\r\nTHREE.Object3D.prototype.updateMatrix = function() {\r\n  updateMatrix.apply(this, arguments);\r\n  handleMatrixModification(this);\r\n};\r\n\r\nconst applyMatrix = THREE.Object3D.prototype.applyMatrix;\r\nTHREE.Object3D.prototype.applyMatrix = function() {\r\n  applyMatrix.apply(this, arguments);\r\n  handleMatrixModification(this);\r\n};\r\n\r\n// By the end of this function this.matrix reflects the updated local matrix\r\n// and this.matrixWorld reflects the updated world matrix, taking into account\r\n// parent matrices.\r\n//\r\n// forceLocalUpdate - Forces the local matrix to be updated regardless of if it has not\r\n// been marked dirty.\r\n//\r\n// forceWorldUpdate - Forces the world matrix to be updated regardless of if the local matrix\r\n// has been updated since the last update.\r\n//\r\n// skipParents - unless true, all parent matricies are updated before updating this object's\r\n// local and world matrix.\r\n//\r\nTHREE.Object3D.prototype.updateMatrices = function(forceLocalUpdate, forceWorldUpdate, skipParents) {\r\n  if (!this.hasHadFirstMatrixUpdate) {\r\n    if (\r\n      !this.position.equals(zeroPos) ||\r\n      !this.quaternion.equals(zeroQuat) ||\r\n      !this.scale.equals(oneScale) ||\r\n      !this.matrix.equals(identity)\r\n    ) {\r\n      // Only update the matrix the first time if its non-identity, this way\r\n      // this.matrixIsModified will remain false until the default\r\n      // identity matrix is updated.\r\n      this.updateMatrix();\r\n    }\r\n\r\n    this.hasHadFirstMatrixUpdate = true;\r\n    this.matrixWorldNeedsUpdate = true;\r\n    this.cachedMatrixWorld = this.matrixWorld;\r\n  } else if (this.matrixNeedsUpdate || this.matrixAutoUpdate || forceLocalUpdate) {\r\n    this.updateMatrix();\r\n    if (this.matrixNeedsUpdate) this.matrixNeedsUpdate = false;\r\n  }\r\n\r\n  if (!skipParents && this.parent) {\r\n    this.parent.updateMatrices(false, forceWorldUpdate, false);\r\n    this.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate || this.parent.childrenNeedMatrixWorldUpdate;\r\n  }\r\n\r\n  if (this.matrixWorldNeedsUpdate || forceWorldUpdate) {\r\n    if (this.parent === null) {\r\n      this.matrixWorld.copy(this.matrix);\r\n    } else {\r\n      // If the matrix is unmodified, it is the identity matrix,\r\n      // and hence we can use the parent's world matrix directly.\r\n      //\r\n      // Note this assumes all callers will either not pass skipParents=true\r\n      // *or* will update the parent themselves beforehand as is done in\r\n      // updateMatrixWorld.\r\n      if (!this.matrixIsModified) {\r\n        this.matrixWorld = this.parent.matrixWorld;\r\n      } else {\r\n        // Once matrixIsModified === true, this.matrixWorld has been updated to be a local\r\n        // copy, not a reference to this.parent.matrixWorld (see updateMatrix/applyMatrix)\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n      }\r\n    }\r\n\r\n    this.childrenNeedMatrixWorldUpdate = true;\r\n    this.matrixWorldNeedsUpdate = false;\r\n  }\r\n};\r\n\r\n// Computes this object's matrices and then the recursively computes the matrices of all the children.\r\n//\r\n// forceWorldUpdate - If true and the object is visible, will force the world matrix to be updated for\r\n// this node and all of its children.\r\n//\r\n// includeInvisible - If true, does not ignore non-visible objects.\r\nTHREE.Object3D.prototype.updateMatrixWorld = function(forceWorldUpdate, includeInvisible) {\r\n  if (!this.visible && !includeInvisible) return;\r\n\r\n  // Do not recurse upwards, since this is recursing downwards\r\n  this.updateMatrices(false, forceWorldUpdate, true);\r\n\r\n  const children = this.children;\r\n  const forceChildrenWorldUpdate = this.childrenNeedMatrixWorldUpdate || forceWorldUpdate;\r\n\r\n  for (let i = 0, l = children.length; i < l; i++) {\r\n    children[i].updateMatrixWorld(forceChildrenWorldUpdate, includeInvisible);\r\n  }\r\n\r\n  if (this.childrenNeedMatrixWorldUpdate) this.childrenNeedMatrixWorldUpdate = false;\r\n};\r\n\r\n// Updates this function to use updateMatrices() to avoid extra matrix computations\r\nTHREE.Object3D.prototype.lookAt = (function() {\r\n  // This method does not support objects having non-uniformly-scaled parent(s)\r\n\r\n  const q1 = new THREE.Quaternion();\r\n  const m1 = new THREE.Matrix4();\r\n  const target = new THREE.Vector3();\r\n  const position = new THREE.Vector3();\r\n\r\n  return function lookAt(x, y, z) {\r\n    if (x.isVector3) {\r\n      target.copy(x);\r\n    } else {\r\n      target.set(x, y, z);\r\n    }\r\n\r\n    const parent = this.parent;\r\n\r\n    if (parent) {\r\n      parent.updateMatrices();\r\n    }\r\n    this.updateMatrices(); // hubs change\r\n\r\n    position.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    if (this.isCamera || this.isLight) {\r\n      m1.lookAt(position, target, this.up);\r\n    } else {\r\n      m1.lookAt(target, position, this.up);\r\n    }\r\n\r\n    this.quaternion.setFromRotationMatrix(m1);\r\n\r\n    if (parent) {\r\n      m1.extractRotation(parent.matrixWorld);\r\n      q1.setFromRotationMatrix(m1);\r\n      this.quaternion.premultiply(q1.inverse());\r\n    }\r\n    this.matrixNeedsUpdate = true;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\n\r\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\r\n// scenario where the transform changes on an object during an animation.\r\n//\r\n// Changes are identified w comment // hubs\r\n//\r\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\r\n// it erroneously restarts.\r\n\r\nvar anime = require(\"animejs\").default;\r\nvar components = AFRAME.components; // hubs\r\nvar registerComponent = AFRAME.registerComponent; // hubs\r\n//var THREE = require('../lib/three'); // hubs\r\nvar utils = AFRAME.utils; // hubs\r\n\r\ndelete AFRAME.components.animation; // hubs\r\n\r\nvar colorHelperFrom = new THREE.Color();\r\nvar colorHelperTo = new THREE.Color();\r\n\r\nvar getComponentProperty = utils.entity.getComponentProperty;\r\nvar setComponentProperty = utils.entity.setComponentProperty;\r\nvar splitCache = {};\r\n\r\nvar TYPE_COLOR = \"color\";\r\nvar PROP_POSITION = \"position\";\r\nvar PROP_ROTATION = \"rotation\";\r\nvar PROP_SCALE = \"scale\";\r\nvar STRING_COMPONENTS = \"components\";\r\nvar STRING_OBJECT3D = \"object3D\";\r\n\r\n/**\r\n * Animation component for A-Frame using anime.js.\r\n *\r\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\r\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\r\n * boolean * flag * `isAnimationPlaying`.\r\n *\r\n * anime.js animation config for tweenining Javascript objects and values works as:\r\n *\r\n *  config = {\r\n *    targets: {foo: 0.0, bar: '#000'},\r\n *    foo: 1.0,\r\n *    bar: '#FFF'\r\n *  }\r\n *\r\n * The above will tween each property in `targets`. The `to` values are set in the root of\r\n * the config.\r\n *\r\n * @member {object} animation - anime.js instance.\r\n * @member {boolean} animationIsPlaying - Control if animation is playing.\r\n */\r\nmodule.exports.Component = registerComponent(\"animation\", {\r\n  schema: {\r\n    autoplay: { default: true },\r\n    delay: { default: 0 },\r\n    dir: { default: \"\" },\r\n    dur: { default: 1000 },\r\n    easing: { default: \"easeInQuad\" },\r\n    elasticity: { default: 400 },\r\n    enabled: { default: true },\r\n    from: { default: \"\" },\r\n    loop: {\r\n      default: 0,\r\n      parse: function(value) {\r\n        // Boolean or integer.\r\n        if (value === true || value === \"true\") {\r\n          return true;\r\n        }\r\n        if (value === false || value === \"false\") {\r\n          return false;\r\n        }\r\n        return parseInt(value, 10);\r\n      }\r\n    },\r\n    property: { default: \"\" },\r\n    startEvents: { type: \"array\" },\r\n    pauseEvents: { type: \"array\" },\r\n    resumeEvents: { type: \"array\" },\r\n    round: { default: false },\r\n    to: { default: \"\" },\r\n    type: { default: \"\" },\r\n    isRawProperty: { default: false }\r\n  },\r\n\r\n  multiple: true,\r\n\r\n  init: function() {\r\n    var self = this;\r\n\r\n    this.eventDetail = { name: this.attrName };\r\n    this.time = 0;\r\n\r\n    this.animation = null;\r\n    this.animationIsPlaying = false;\r\n    this.onStartEvent = this.onStartEvent.bind(this);\r\n    this.beginAnimation = this.beginAnimation.bind(this);\r\n    this.pauseAnimation = this.pauseAnimation.bind(this);\r\n    this.resumeAnimation = this.resumeAnimation.bind(this);\r\n\r\n    this.fromColor = {};\r\n    this.toColor = {};\r\n    this.targets = {};\r\n    this.targetsArray = [];\r\n\r\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\r\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\r\n\r\n    this.config = {\r\n      complete: function() {\r\n        self.animationIsPlaying = false;\r\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\r\n        if (self.id) {\r\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\r\n        }\r\n      }\r\n    };\r\n  },\r\n\r\n  update: function(oldData) {\r\n    var config = this.config;\r\n    var data = this.data;\r\n\r\n    this.animationIsPlaying = false;\r\n\r\n    if (!this.data.enabled) {\r\n      return;\r\n    }\r\n\r\n    if (!data.property) {\r\n      return;\r\n    }\r\n\r\n    // Base config.\r\n    config.autoplay = false;\r\n    config.direction = data.dir;\r\n    config.duration = data.dur;\r\n    config.easing = data.easing;\r\n    config.elasticity = data.elasticity;\r\n    config.loop = data.loop;\r\n    config.round = data.round;\r\n\r\n    // Start new animation.\r\n    this.createAndStartAnimation();\r\n  },\r\n\r\n  tick: function(t, dt) {\r\n    if (!this.animationIsPlaying) {\r\n      return;\r\n    }\r\n    this.time += dt;\r\n    this.animation.tick(this.time);\r\n  },\r\n\r\n  remove: function() {\r\n    this.pauseAnimation();\r\n    this.removeEventListeners();\r\n    this.cancelDelayedStart(); // hubs\r\n  },\r\n\r\n  pause: function() {\r\n    this.paused = true;\r\n    this.pausedWasPlaying = this.animationIsPlaying;\r\n    this.pauseAnimation();\r\n    this.removeEventListeners();\r\n    this.cancelDelayedStart(); // hubs\r\n  },\r\n\r\n  /**\r\n   * `play` handler only for resuming scene.\r\n   */\r\n  play: function() {\r\n    if (!this.paused) {\r\n      return;\r\n    }\r\n    this.paused = false;\r\n    this.addEventListeners();\r\n    if (this.pausedWasPlaying) {\r\n      this.resumeAnimation();\r\n      this.pausedWasPlaying = false;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Start animation from scratch.\r\n   */\r\n  createAndStartAnimation: function() {\r\n    var data = this.data;\r\n\r\n    this.updateConfig();\r\n    this.animationIsPlaying = false;\r\n    this.animation = anime(this.config);\r\n\r\n    this.removeEventListeners();\r\n    this.cancelDelayedStart(); // hubs\r\n    this.addEventListeners();\r\n\r\n    // Wait for start events for animation.\r\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\r\n      return;\r\n    }\r\n\r\n    // Delay animation.\r\n    if (data.delay) {\r\n      // hubs\r\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\r\n      return;\r\n    }\r\n\r\n    // Play animation.\r\n    this.beginAnimation();\r\n  },\r\n\r\n  /**\r\n   * This is before animation start (including from startEvents).\r\n   * Set to initial state (config.from, time = 0, seekTime = 0).\r\n   */\r\n  beginAnimation: function() {\r\n    this.updateConfig();\r\n    this.time = 0;\r\n    this.animationIsPlaying = true;\r\n    this.stopRelatedAnimations();\r\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\r\n  },\r\n\r\n  pauseAnimation: function() {\r\n    this.animationIsPlaying = false;\r\n  },\r\n\r\n  resumeAnimation: function() {\r\n    this.animationIsPlaying = true;\r\n  },\r\n\r\n  /**\r\n   * startEvents callback.\r\n   */\r\n  onStartEvent: function() {\r\n    if (!this.data.enabled) {\r\n      return;\r\n    }\r\n\r\n    this.updateConfig();\r\n    if (this.animation) {\r\n      this.animation.pause();\r\n    }\r\n    this.animation = anime(this.config);\r\n\r\n    // Include the delay before each start event.\r\n    if (this.data.delay) {\r\n      setTimeout(this.beginAnimation, this.data.delay);\r\n      return;\r\n    }\r\n    this.beginAnimation();\r\n  },\r\n\r\n  /**\r\n   * rawProperty: true and type: color;\r\n   */\r\n  updateConfigForRawColor: function() {\r\n    var config = this.config;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var from;\r\n    var key;\r\n    var to;\r\n\r\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\r\n      return;\r\n    }\r\n\r\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\r\n    to = data.to;\r\n\r\n    // Use r/g/b vector for color type.\r\n    this.setColorConfig(from, to);\r\n    from = this.fromColor;\r\n    to = this.toColor;\r\n\r\n    this.targetsArray.length = 0;\r\n    this.targetsArray.push(from);\r\n    config.targets = this.targetsArray;\r\n    for (key in to) {\r\n      config[key] = to[key];\r\n    }\r\n\r\n    config.update = (function() {\r\n      var lastValue = {};\r\n      return function(anim) {\r\n        var value;\r\n        value = anim.animatables[0].target;\r\n        // For animation timeline.\r\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\r\n          return;\r\n        }\r\n\r\n        setRawProperty(el, data.property, value, data.type);\r\n      };\r\n    })();\r\n  },\r\n\r\n  /**\r\n   * Stuff property into generic `property` key.\r\n   */\r\n  updateConfigForDefault: function() {\r\n    var config = this.config;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var from;\r\n    var isBoolean;\r\n    var isNumber;\r\n    var to;\r\n\r\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\r\n      return;\r\n    }\r\n\r\n    if (data.from === \"\") {\r\n      // Infer from.\r\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\r\n    } else {\r\n      // Explicit from.\r\n      from = data.from;\r\n    }\r\n\r\n    to = data.to;\r\n\r\n    isNumber = !isNaN(from || to);\r\n    if (isNumber) {\r\n      from = parseFloat(from);\r\n      to = parseFloat(to);\r\n    } else {\r\n      from = from ? from.toString() : from;\r\n      to = to ? to.toString() : to;\r\n    }\r\n\r\n    // Convert booleans to integer to allow boolean flipping.\r\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\r\n    if (isBoolean) {\r\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\r\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\r\n    }\r\n\r\n    this.targets.aframeProperty = from;\r\n    config.targets = this.targets;\r\n    config.aframeProperty = to;\r\n    config.update = (function() {\r\n      var lastValue;\r\n\r\n      return function(anim) {\r\n        var value;\r\n        value = anim.animatables[0].target.aframeProperty;\r\n\r\n        // Need to do a last value check for animation timeline since all the tweening\r\n        // begins simultaenously even if the value has not changed. Also better for perf\r\n        // anyways.\r\n        if (value === lastValue) {\r\n          return;\r\n        }\r\n        lastValue = value;\r\n\r\n        if (isBoolean) {\r\n          value = value >= 1;\r\n        }\r\n\r\n        if (isRawProperty(data)) {\r\n          setRawProperty(el, data.property, value, data.type);\r\n        } else {\r\n          setComponentProperty(el, data.property, value);\r\n        }\r\n      };\r\n    })();\r\n  },\r\n\r\n  /**\r\n   * Extend x/y/z/w onto the config.\r\n   * Update vector by modifying object3D.\r\n   */\r\n  updateConfigForVector: function() {\r\n    var config = this.config;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var key;\r\n    var from;\r\n    var to;\r\n\r\n    // Parse coordinates.\r\n    from =\r\n      data.from !== \"\"\r\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\r\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\r\n    to = utils.coordinates.parse(data.to);\r\n\r\n    if (data.property === PROP_ROTATION) {\r\n      toRadians(from);\r\n      toRadians(to);\r\n    }\r\n\r\n    // Set to and from.\r\n    this.targetsArray.length = 0;\r\n    this.targetsArray.push(from);\r\n    config.targets = this.targetsArray;\r\n    for (key in to) {\r\n      config[key] = to[key];\r\n    }\r\n\r\n    // If animating object3D transformation, run more optimized updater.\r\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\r\n      config.update = (function() {\r\n        var lastValue = {};\r\n        return function(anim) {\r\n          var value = anim.animatables[0].target;\r\n\r\n          if (data.property === PROP_SCALE) {\r\n            value.x = Math.max(0.0001, value.x);\r\n            value.y = Math.max(0.0001, value.y);\r\n            value.z = Math.max(0.0001, value.z);\r\n          }\r\n\r\n          // For animation timeline.\r\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\r\n            return;\r\n          }\r\n\r\n          lastValue.x = value.x;\r\n          lastValue.y = value.y;\r\n          lastValue.z = value.z;\r\n\r\n          el.object3D[data.property].set(value.x, value.y, value.z);\r\n          el.object3D.matrixNeedsUpdate = true; // hubs\r\n        };\r\n      })();\r\n      return;\r\n    }\r\n\r\n    // Animating some vector.\r\n    config.update = (function() {\r\n      var lastValue = {};\r\n      return function(anim) {\r\n        var value = anim.animations[0].target;\r\n\r\n        // Animate rotation through radians.\r\n        // For animation timeline.\r\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\r\n          return;\r\n        }\r\n        lastValue.x = value.x;\r\n        lastValue.y = value.y;\r\n        lastValue.z = value.z;\r\n        setComponentProperty(el, data.property, value);\r\n      };\r\n    })();\r\n  },\r\n\r\n  /**\r\n   * Update the config before each run.\r\n   */\r\n  updateConfig: function() {\r\n    var propType;\r\n\r\n    // Route config type.\r\n    propType = getPropertyType(this.el, this.data.property);\r\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\r\n      this.updateConfigForRawColor();\r\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\r\n      this.updateConfigForVector();\r\n    } else {\r\n      this.updateConfigForDefault();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Wait for component to initialize.\r\n   */\r\n  waitComponentInitRawProperty: function(cb) {\r\n    var componentName;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var self = this;\r\n\r\n    if (data.from !== \"\") {\r\n      return false;\r\n    }\r\n\r\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\r\n      return false;\r\n    }\r\n\r\n    componentName = splitDot(data.property)[1];\r\n    if (el.components[componentName]) {\r\n      return false;\r\n    }\r\n\r\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\r\n      if (evt.detail.name !== componentName) {\r\n        return;\r\n      }\r\n      cb();\r\n      // Since the config was created async, create the animation now since we missed it\r\n      // earlier.\r\n      self.animation = anime(self.config);\r\n      el.removeEventListener(\"componentinitialized\", wait);\r\n    });\r\n    return true;\r\n  },\r\n\r\n  /**\r\n   * Make sure two animations on the same property don't fight each other.\r\n   * e.g., animation__mouseenter=\"property: material.opacity\"\r\n   *       animation__mouseleave=\"property: material.opacity\"\r\n   */\r\n  stopRelatedAnimations: function() {\r\n    var component;\r\n    var componentName;\r\n    for (componentName in this.el.components) {\r\n      component = this.el.components[componentName];\r\n      if (componentName === this.attrName) {\r\n        continue;\r\n      }\r\n      if (component.name !== \"animation\") {\r\n        continue;\r\n      }\r\n      if (!component.animationIsPlaying) {\r\n        continue;\r\n      }\r\n      if (component.data.property !== this.data.property) {\r\n        continue;\r\n      }\r\n      component.animationIsPlaying = false;\r\n    }\r\n  },\r\n\r\n  addEventListeners: function() {\r\n    var data = this.data;\r\n    var el = this.el;\r\n    addEventListeners(el, data.startEvents, this.onStartEvent);\r\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\r\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\r\n  },\r\n\r\n  removeEventListeners: function() {\r\n    var data = this.data;\r\n    var el = this.el;\r\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\r\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\r\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\r\n  },\r\n\r\n  // hubs\r\n  cancelDelayedStart: function() {\r\n    if (this.delayTimeout) {\r\n      clearTimeout(this.delayTimeout);\r\n      this.delayTimeout = null;\r\n    }\r\n  },\r\n\r\n  setColorConfig: function(from, to) {\r\n    colorHelperFrom.set(from);\r\n    colorHelperTo.set(to);\r\n    from = this.fromColor;\r\n    to = this.toColor;\r\n    from.r = colorHelperFrom.r;\r\n    from.g = colorHelperFrom.g;\r\n    from.b = colorHelperFrom.b;\r\n    to.r = colorHelperTo.r;\r\n    to.g = colorHelperTo.g;\r\n    to.b = colorHelperTo.b;\r\n  }\r\n});\r\n\r\n/**\r\n * Given property name, check schema to see what type we are animating.\r\n * We just care whether the property is a vector.\r\n */\r\nfunction getPropertyType(el, property) {\r\n  var component;\r\n  var componentName;\r\n  var split;\r\n  var propertyName;\r\n\r\n  split = property.split(\".\");\r\n  componentName = split[0];\r\n  propertyName = split[1];\r\n  component = el.components[componentName] || components[componentName];\r\n\r\n  // Primitives.\r\n  if (!component) {\r\n    return null;\r\n  }\r\n\r\n  // Dynamic schema. We only care about vectors anyways.\r\n  if (propertyName && !component.schema[propertyName]) {\r\n    return null;\r\n  }\r\n\r\n  // Multi-prop.\r\n  if (propertyName) {\r\n    return component.schema[propertyName].type;\r\n  }\r\n\r\n  // Single-prop.\r\n  return component.schema.type;\r\n}\r\n\r\n/**\r\n * Convert object to radians.\r\n */\r\nfunction toRadians(obj) {\r\n  obj.x = THREE.Math.degToRad(obj.x);\r\n  obj.y = THREE.Math.degToRad(obj.y);\r\n  obj.z = THREE.Math.degToRad(obj.z);\r\n}\r\n\r\nfunction addEventListeners(el, eventNames, handler) {\r\n  var i;\r\n  for (i = 0; i < eventNames.length; i++) {\r\n    el.addEventListener(eventNames[i], handler);\r\n  }\r\n}\r\n\r\nfunction removeEventListeners(el, eventNames, handler) {\r\n  var i;\r\n  for (i = 0; i < eventNames.length; i++) {\r\n    el.removeEventListener(eventNames[i], handler);\r\n  }\r\n}\r\n\r\nfunction getRawProperty(el, path) {\r\n  var i;\r\n  var split;\r\n  var value;\r\n  split = splitDot(path);\r\n  value = el;\r\n  for (i = 0; i < split.length; i++) {\r\n    value = value[split[i]];\r\n  }\r\n  return value;\r\n}\r\n\r\nfunction setRawProperty(el, path, value, type) {\r\n  var i;\r\n  var split;\r\n  var propertyName;\r\n  var targetValue;\r\n\r\n  if (path.startsWith(\"object3D.rotation\")) {\r\n    value = THREE.Math.degToRad(value);\r\n  }\r\n\r\n  // Walk.\r\n  split = splitDot(path);\r\n  targetValue = el;\r\n  for (i = 0; i < split.length - 1; i++) {\r\n    targetValue = targetValue[split[i]];\r\n  }\r\n  propertyName = split[split.length - 1];\r\n\r\n  // Raw color.\r\n  if (type === TYPE_COLOR) {\r\n    if (\"r\" in targetValue[propertyName]) {\r\n      targetValue[propertyName].r = value.r;\r\n      targetValue[propertyName].g = value.g;\r\n      targetValue[propertyName].b = value.b;\r\n    } else {\r\n      targetValue[propertyName].x = value.r;\r\n      targetValue[propertyName].y = value.g;\r\n      targetValue[propertyName].z = value.b;\r\n    }\r\n    return;\r\n  }\r\n\r\n  targetValue[propertyName] = value;\r\n}\r\n\r\nfunction splitDot(path) {\r\n  if (path in splitCache) {\r\n    return splitCache[path];\r\n  }\r\n  splitCache[path] = path.split(\".\");\r\n  return splitCache[path];\r\n}\r\n\r\nfunction isRawProperty(data) {\r\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\r\n}\r\n","AFRAME.registerComponent(\"ambient-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.AmbientLight();\r\n    this.el.setObject3D(\"ambient-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\r\n  },\r\n\r\n  update(prevData) {\r\n    if (this.data.color !== prevData.color) {\r\n      this.light.color.set(this.data.color);\r\n      this.rendererSystem.applyColorCorrection(this.light.color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      this.light.intensity = this.data.intensity;\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"ambient-light\");\r\n  }\r\n});\r\n","/**\r\n * Instantiates and updates a THREE.AnimationMixer on an entity.\r\n * @component animation-mixer\r\n */\r\nAFRAME.registerComponent(\"animation-mixer\", {\r\n  initMixer(animations) {\r\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\r\n    this.el.object3D.animations = animations;\r\n    this.animations = animations;\r\n  },\r\n\r\n  tick: function(t, dt) {\r\n    if (this.mixer) {\r\n      this.mixer.update(dt / 1000);\r\n    }\r\n  }\r\n});\r\n","/**\r\n * Sets the CSS class on an entity.\r\n * @component css-class\r\n */\r\nAFRAME.registerComponent(\"css-class\", {\r\n  schema: {\r\n    type: \"string\"\r\n  },\r\n  multiple: true,\r\n  init() {\r\n    this.el.classList.add(this.data);\r\n  },\r\n  update(oldData) {\r\n    if (this.data !== oldData) {\r\n      this.el.classList.remove(oldData);\r\n      this.el.classList.add(this.data);\r\n    }\r\n  },\r\n  remove() {\r\n    this.el.classList.remove(this.data);\r\n  }\r\n});\r\n","/* global CANNON */\r\n/**\r\n * Floats a duck based on its scale.\r\n * @component duck\r\n */\r\nAFRAME.registerComponent(\"duck\", {\r\n  schema: {\r\n    initialForce: { default: 0 },\r\n    maxForce: { default: 6.5 },\r\n    maxScale: { default: 5 }\r\n  },\r\n\r\n  init: function() {\r\n    this.physicsSystem = this.el.sceneEl.systems.physics;\r\n    this.hasBody = false;\r\n    this.position = new CANNON.Vec3();\r\n    this.force = new CANNON.Vec3(0, this.data.initialForce, 0);\r\n    this.initialScale = this.el.object3D.scale.x;\r\n    this.maxScale = this.data.maxScale * this.initialScale;\r\n  },\r\n\r\n  play: function() {\r\n    this.physicsSystem.addComponent(this);\r\n  },\r\n\r\n  pause: function() {\r\n    this.physicsSystem.removeComponent(this);\r\n  },\r\n\r\n  beforeStep: function() {\r\n    if (this.el.body && NAF.utils.isMine(this.el)) {\r\n      const currentScale = this.el.object3D.scale.x;\r\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\r\n      const force = ratio * this.data.maxForce;\r\n      if (force > 0) {\r\n        const angle = Math.random() * Math.PI * 2;\r\n        const x = Math.cos(angle);\r\n        const z = Math.sin(angle);\r\n        this.force.set(x, force, z);\r\n        this.position.set(x * 0.01, 0, z * 0.01);\r\n        this.el.object3D.matrixNeedsUpdate = true;\r\n        this.el.body.applyForce(this.force, this.position);\r\n      }\r\n    }\r\n  }\r\n});\r\n","// Enumeration of spawned object content origins. URL means the content is\r\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\r\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\r\n// it was copied over from a spawner.\r\nexport const ObjectContentOrigins = {\r\n  URL: 1,\r\n  FILE: 2,\r\n  CLIPBOARD: 3,\r\n  SPAWNER: 4\r\n};\r\n\r\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\r\n// both the origin of the content for the object and also the type of content\r\n// contained in the object.\r\nexport const ObjectTypes = {\r\n  URL_IMAGE: 0,\r\n  URL_VIDEO: 1,\r\n  URL_MODEL: 2,\r\n  URL_PDF: 3,\r\n  URL_AUDIO: 4,\r\n  //URL_TEXT: 5,\r\n  //URL_TELEPORTER: 6,\r\n  FILE_IMAGE: 8,\r\n  FILE_VIDEO: 9,\r\n  FILE_MODEL: 10,\r\n  FILE_PDF: 11,\r\n  FILE_AUDIO: 12,\r\n  //FILE_TEXT: 13,\r\n  CLIPBOARD_IMAGE: 16,\r\n  CLIPBOARD_VIDEO: 17,\r\n  CLIPBOARD_MODEL: 18,\r\n  CLIPBOARD_PDF: 19,\r\n  CLIPBOARD_AUDIO: 20,\r\n  //CLIPBOARD_TEXT: 21,\r\n  SPAWNER_IMAGE: 24,\r\n  SPAWNER_VIDEO: 25,\r\n  SPAWNER_MODEL: 26,\r\n  SPAWNER_PDF: 27,\r\n  SPAWNER_AUDIO: 28,\r\n  //SPAWNER_TEXT: 29,\r\n  CAMERA: 30,\r\n  UNKNOWN: 31\r\n};\r\n\r\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\r\n// origins respectively, return the appropriate one\r\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\r\n  if (contentOrigin === ObjectContentOrigins.URL) {\r\n    return urlType;\r\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\r\n    return fileType;\r\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\r\n    return clipboardType;\r\n  } else {\r\n    return spawnerType;\r\n  }\r\n}\r\n\r\n// Lookup table of mime-type prefixes to the set of object types that we should use\r\n// for objects spawned matching their underlying Content-Type.\r\nconst objectTypeMimePrefixLookupMap = {\r\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\r\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\r\n  \"application/x-zip-compressed\": [\r\n    ObjectTypes.URL_MODEL,\r\n    ObjectTypes.FILE_MODEL,\r\n    ObjectTypes.CLIPBOARD_MODEL,\r\n    ObjectTypes.SPAWNER_MODEL\r\n  ],\r\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\r\n  \"application/vnd.apple.mpegurl\": [\r\n    ObjectTypes.URL_VIDEO,\r\n    ObjectTypes.FILE_VIDEO,\r\n    ObjectTypes.CLIPBOARD_VIDEO,\r\n    ObjectTypes.SPAWNER_VIDEO\r\n  ],\r\n  \"application/x-mpegurl\": [\r\n    ObjectTypes.URL_VIDEO,\r\n    ObjectTypes.FILE_VIDEO,\r\n    ObjectTypes.CLIPBOARD_VIDEO,\r\n    ObjectTypes.SPAWNER_VIDEO\r\n  ],\r\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\r\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\r\n};\r\n\r\nconst srcSuffixLookupMap = {\r\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\r\n};\r\n\r\n// Given an content origin and the resolved mime type of a piece of content, return\r\n// the ObjectType, if any, for that content.\r\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\r\n  for (const prefix in objectTypeMimePrefixLookupMap) {\r\n    if (contentType.toLowerCase().startsWith(prefix)) {\r\n      const types = objectTypeMimePrefixLookupMap[prefix];\r\n      return objectTypeForOrigin(contentOrigin, ...types);\r\n    }\r\n  }\r\n\r\n  if (src) {\r\n    for (const suffix in srcSuffixLookupMap) {\r\n      if (src.toLowerCase().endsWith(suffix)) {\r\n        const types = srcSuffixLookupMap[suffix];\r\n        return objectTypeForOrigin(contentOrigin, ...types);\r\n      }\r\n    }\r\n  }\r\n\r\n  return ObjectTypes.UNKNOWN;\r\n}\r\n","/* global CANNON */\r\nAFRAME.registerComponent(\"heightfield\", {\r\n  init() {\r\n    this.el.addEventListener(\"componentinitialized\", e => {\r\n      if (e.detail.name === \"static-body\") {\r\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\r\n      }\r\n    });\r\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\r\n  },\r\n  generateAndAddHeightfield(body) {\r\n    const { offset, distance, data } = this.data;\r\n\r\n    const orientation = new CANNON.Quaternion();\r\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\r\n\r\n    const rotation = new CANNON.Quaternion();\r\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\r\n    rotation.mult(orientation, orientation);\r\n\r\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\r\n\r\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\r\n\r\n    body.addShape(shape, cannonOffset, orientation);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"hemisphere-light\", {\r\n  schema: {\r\n    skyColor: { type: \"color\" },\r\n    groundColor: { type: \"color\" },\r\n    intensity: { default: 1.0 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.HemisphereLight();\r\n    this.light.position.set(0, 0, 0);\r\n    this.light.matrixNeedsUpdate = true;\r\n    this.el.setObject3D(\"hemisphere-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n  },\r\n\r\n  update(prevData) {\r\n    if (this.data.skyColor !== prevData.skyColor) {\r\n      this.light.color.set(this.data.skyColor);\r\n    }\r\n\r\n    if (this.data.groundColor !== prevData.groundColor) {\r\n      this.light.groundColor.set(this.data.groundColor);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      this.light.intensity = this.data.intensity;\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"hemisphere-light\");\r\n  }\r\n});\r\n","/**\r\n * Hides entities based on the scene's quality mode\r\n * @namespace environment\r\n * @component hide-when-quality\r\n */\r\nAFRAME.registerComponent(\"hide-when-quality\", {\r\n  schema: { type: \"string\", default: \"low\" },\r\n\r\n  init() {\r\n    this.onQualityChanged = this.onQualityChanged.bind(this);\r\n    this.el.sceneEl.addEventListener(\"quality-changed\", this.onQualityChanged);\r\n  },\r\n\r\n  onQualityChanged(event) {\r\n    this.updateComponentState(event.detail);\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data !== oldData) {\r\n      this.updateComponentState(window.APP.quality);\r\n    }\r\n  },\r\n\r\n  updateComponentState(quality) {\r\n    this.el.setAttribute(\"visible\", quality !== this.data);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"point-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 },\r\n    range: { default: 0 },\r\n    decay: { default: 2 },\r\n    castShadow: { default: true },\r\n    shadowMapResolution: { default: [512, 512] },\r\n    shadowBias: { default: 0 },\r\n    shadowRadius: { default: 1 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.PointLight();\r\n    this.light.shadow.camera.matrixAutoUpdate = true;\r\n    this.el.setObject3D(\"point-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\r\n  },\r\n\r\n  update(prevData) {\r\n    const light = this.light;\r\n\r\n    if (this.data.color !== prevData.color) {\r\n      const color = new THREE.Color(this.data.color);\r\n      this.rendererSystem.applyColorCorrection(color);\r\n      light.color.copy(color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      light.intensity = this.data.intensity;\r\n    }\r\n\r\n    if (this.data.range !== prevData.range) {\r\n      light.distance = this.data.range;\r\n    }\r\n\r\n    if (this.data.decay !== prevData.decay) {\r\n      light.decay = this.data.decay;\r\n    }\r\n\r\n    if (this.data.castShadow !== prevData.castShadow) {\r\n      light.castShadow = this.data.castShadow;\r\n    }\r\n\r\n    if (this.data.shadowBias !== prevData.shadowBias) {\r\n      light.shadow.bias = this.data.shadowBias;\r\n    }\r\n\r\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\r\n      light.shadow.radius = this.data.shadowRadius;\r\n    }\r\n\r\n    const [width, height] = this.data.shadowMapResolution;\r\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\r\n\r\n    if (width !== prevWidth || height !== prevHeight) {\r\n      light.shadow.mapSize.set(width, height);\r\n\r\n      if (light.shadow.map) {\r\n        light.shadow.map.dispose();\r\n        light.shadow.map = null;\r\n      }\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"point-light\");\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"spot-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 },\r\n    range: { default: 0 },\r\n    decay: { default: 2 },\r\n    innerConeAngle: { default: 0 },\r\n    outerConeAngle: { default: Math.PI / 4.0 },\r\n    castShadow: { default: true },\r\n    shadowMapResolution: { default: [512, 512] },\r\n    shadowBias: { default: 0 },\r\n    shadowRadius: { default: 1 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.SpotLight();\r\n    this.light.position.set(0, 0, 0);\r\n    this.light.target.position.set(0, 0, 1);\r\n    this.light.add(this.light.target);\r\n    this.light.matrixNeedsUpdate = true;\r\n    this.light.target.matrixNeedsUpdate = true;\r\n    this.el.setObject3D(\"spot-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n  },\r\n\r\n  update(prevData) {\r\n    const light = this.light;\r\n\r\n    if (this.data.color !== prevData.color) {\r\n      light.color.set(this.data.color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      light.intensity = this.data.intensity;\r\n    }\r\n\r\n    if (this.data.range !== prevData.range) {\r\n      light.distance = this.data.range;\r\n    }\r\n\r\n    if (this.data.decay !== prevData.decay) {\r\n      light.decay = this.data.decay;\r\n    }\r\n\r\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\r\n      light.angle = this.data.outerConeAngle;\r\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\r\n    }\r\n\r\n    if (this.data.castShadow !== prevData.castShadow) {\r\n      light.castShadow = this.data.castShadow;\r\n    }\r\n\r\n    if (this.data.shadowBias !== prevData.shadowBias) {\r\n      light.shadow.bias = this.data.shadowBias;\r\n    }\r\n\r\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\r\n      light.shadow.radius = this.data.shadowRadius;\r\n    }\r\n\r\n    const [width, height] = this.data.shadowMapResolution;\r\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\r\n\r\n    if (width !== prevWidth || height !== prevHeight) {\r\n      light.shadow.mapSize.set(width, height);\r\n\r\n      if (light.shadow.map) {\r\n        light.shadow.map.dispose();\r\n        light.shadow.map = null;\r\n      }\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"spot-light\");\r\n  }\r\n});\r\n","/* global AFRAME */\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\n\r\nAFRAME.registerComponent(\"floaty-object\", {\r\n  schema: {\r\n    // Make the object locked/kinematic upon load\r\n    autoLockOnLoad: { default: false },\r\n\r\n    // Make the object kinematic immediately upon release\r\n    autoLockOnRelease: { default: false },\r\n\r\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\r\n    // otherwise apply releaseGravity.\r\n    modifyGravityOnRelease: { default: false },\r\n\r\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\r\n    releaseGravity: { default: -2 },\r\n\r\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\r\n    reduceAngularFloat: { default: false },\r\n\r\n    // Velocity speed limit under which gravity will not be added if modifyGravityOnRelease is true\r\n    gravitySpeedLimit: { default: 1.85 } // Set to 0 to never apply gravity\r\n  },\r\n\r\n  init() {\r\n    this.onGrab = this.onGrab.bind(this);\r\n    this.onRelease = this.onRelease.bind(this);\r\n  },\r\n\r\n  tick() {\r\n    if (!this.bodyHelper) {\r\n      this.bodyHelper = this.el.components[\"body-helper\"];\r\n    }\r\n\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const isHeld = interaction && interaction.isHeld(this.el);\r\n    if (isHeld && !this.wasHeld) {\r\n      this.onGrab();\r\n    }\r\n    if (this.wasHeld && !isHeld) {\r\n      this.onRelease();\r\n    }\r\n\r\n    if (!isHeld && this._makeStaticWhenAtRest) {\r\n      const isMine = this.el.components.networked && NAF.utils.isMine(this.el);\r\n      const linearThreshold = this.bodyHelper.data.linearSleepingThreshold;\r\n      const angularThreshold = this.bodyHelper.data.angularSleepingThreshold;\r\n      const isAtRest =\r\n        this.bodyHelper.body &&\r\n        this.bodyHelper.body.physicsBody.getLinearVelocity().length2() < linearThreshold * linearThreshold &&\r\n        this.bodyHelper.body.physicsBody.getAngularVelocity().length2() < angularThreshold * angularThreshold;\r\n\r\n      if (isAtRest && isMine) {\r\n        this.el.setAttribute(\"body-helper\", { type: \"kinematic\" });\r\n      }\r\n\r\n      if (isAtRest || !isMine) {\r\n        this._makeStaticWhenAtRest = false;\r\n      }\r\n    }\r\n\r\n    this.wasHeld = isHeld;\r\n  },\r\n\r\n  play() {\r\n    // We do this in play instead of in init because otherwise NAF.utils.isMine fails\r\n    if (this.hasBeenHereBefore) return;\r\n    this.hasBeenHereBefore = true;\r\n    if (this.data.autoLockOnLoad) {\r\n      this.el.setAttribute(\"body-helper\", {\r\n        gravity: { x: 0, y: 0, z: 0 }\r\n      });\r\n      this.setLocked(true);\r\n    }\r\n  },\r\n\r\n  setLocked(locked) {\r\n    if (this.el.components.networked && !NAF.utils.isMine(this.el)) return;\r\n\r\n    this.locked = locked;\r\n    this.el.setAttribute(\"body-helper\", { type: locked ? \"kinematic\" : \"dynamic\" });\r\n  },\r\n\r\n  onRelease() {\r\n    if (this.data.modifyGravityOnRelease) {\r\n      if (\r\n        this.data.gravitySpeedLimit === 0 ||\r\n        (this.bodyHelper.body &&\r\n          this.bodyHelper.body.getVelocity().length2() < this.data.gravitySpeedLimit * this.data.gravitySpeedLimit)\r\n      ) {\r\n        this.el.setAttribute(\"body-helper\", {\r\n          gravity: { x: 0, y: 0, z: 0 },\r\n          angularDamping: this.data.reduceAngularFloat ? 0.98 : 0.5,\r\n          linearDamping: 0.95,\r\n          linearSleepingThreshold: 0.1,\r\n          angularSleepingThreshold: 0.1,\r\n          collisionFilterMask: COLLISION_LAYERS.HANDS\r\n        });\r\n\r\n        this._makeStaticWhenAtRest = true;\r\n      } else {\r\n        this.el.setAttribute(\"body-helper\", {\r\n          gravity: { x: 0, y: this.data.releaseGravity, z: 0 },\r\n          angularDamping: 0.01,\r\n          linearDamping: 0.01,\r\n          linearSleepingThreshold: 1.6,\r\n          angularSleepingThreshold: 2.5,\r\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\r\n        });\r\n      }\r\n    } else {\r\n      this.el.setAttribute(\"body-helper\", {\r\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE,\r\n        gravity: { x: 0, y: -9.8, z: 0 }\r\n      });\r\n    }\r\n\r\n    if (this.data.autoLockOnRelease) {\r\n      this.setLocked(true);\r\n    }\r\n  },\r\n\r\n  onGrab() {\r\n    this.el.setAttribute(\"body-helper\", {\r\n      gravity: { x: 0, y: 0, z: 0 },\r\n      collisionFilterMask: COLLISION_LAYERS.HANDS\r\n    });\r\n    this.setLocked(false);\r\n  },\r\n\r\n  remove() {\r\n    if (this.stuckTo) {\r\n      const stuckTo = this.stuckTo;\r\n      delete this.stuckTo;\r\n      stuckTo._unstickObject();\r\n    }\r\n  }\r\n});\r\n","const sizeVec = new THREE.Vector3();\r\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\r\nconst colliderWorldPositionVec = new THREE.Vector3();\r\n\r\nAFRAME.registerComponent(\"trigger-volume\", {\r\n  schema: {\r\n    colliders: { type: \"selectorAll\" },\r\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\r\n    target: { type: \"selector\" },\r\n    enterComponent: { type: \"string\" },\r\n    enterProperty: { type: \"string\" },\r\n    enterValue: {\r\n      default: \"\",\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    },\r\n    leaveComponent: { type: \"string\" },\r\n    leaveProperty: { type: \"string\" },\r\n    leaveValue: {\r\n      default: \"\",\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n  init() {\r\n    this.boundingBox = new THREE.Box3();\r\n    this.collidingLastFrame = {};\r\n  },\r\n  update() {\r\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\r\n    sizeVec.copy(this.data.size);\r\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\r\n  },\r\n  tick() {\r\n    if (!this.data.target) return;\r\n\r\n    const colliders = this.data.colliders;\r\n\r\n    for (let i = 0; i < colliders.length; i++) {\r\n      const collider = colliders[i];\r\n      const object3D = collider.object3D;\r\n\r\n      object3D.getWorldPosition(colliderWorldPositionVec);\r\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\r\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\r\n\r\n      if (isColliding && !collidingLastFrame) {\r\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\r\n      } else if (!isColliding && collidingLastFrame) {\r\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\r\n      }\r\n\r\n      this.collidingLastFrame[object3D.id] = isColliding;\r\n    }\r\n  }\r\n});\r\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\r\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\r\nAFRAME.registerComponent(\"video-pause-state\", {\r\n  schema: {\r\n    paused: { default: false }\r\n  },\r\n\r\n  init() {\r\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\r\n    this.videoComponent = this.el.components[\"media-video\"];\r\n\r\n    if (this.videoComponent) {\r\n      this.onVideoLoaded();\r\n    } else {\r\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\r\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\r\n    }\r\n  },\r\n\r\n  onVideoLoaded() {\r\n    this.videoComponent = this.el.components[\"media-video\"];\r\n    this.video = this.videoComponent.video;\r\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\r\n  },\r\n\r\n  onPauseStateChange() {\r\n    this.el.setAttribute(\"paused\", this.video.paused);\r\n  },\r\n\r\n  update() {\r\n    if (this.video && this.data.paused !== this.video.paused) {\r\n      this.videoComponent.togglePlaying();\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    if (this.video) {\r\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\r\n    }\r\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\r\n  }\r\n});\r\n","/**\r\n * Logs all events dispatched on an entity\r\n * @namespace debug\r\n * @component log-events\r\n */\r\nAFRAME.registerComponent(\"log-events\", {\r\n  init: function() {\r\n    const el = this.el;\r\n    const log = this.log.bind(this);\r\n    const origDispatch = this.el.dispatchEvent;\r\n    this.el.dispatchEvent = function() {\r\n      log(Array.from(arguments));\r\n      return origDispatch.apply(el, arguments);\r\n    };\r\n  },\r\n  log: function([e]) {\r\n    if ([\"componentchanged\"].includes(e.type)) return;\r\n    let firstObject = true;\r\n    const replacer = (k, x) => {\r\n      if (!x) return x;\r\n      if (typeof x === \"object\" && x.length === undefined) {\r\n        if (firstObject) {\r\n          firstObject = false;\r\n          return x;\r\n        }\r\n        return \"[object]\";\r\n      }\r\n      return x;\r\n    };\r\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\r\n  }\r\n});\r\n\r\n/**\r\n * Logs all life cycle phases on an entity.\r\n * @namespace debug\r\n * @component lifecycle-checker\r\n */\r\nAFRAME.registerComponent(\"lifecycle-checker\", {\r\n  schema: {\r\n    name: { type: \"string\" },\r\n    tick: { default: false }\r\n  },\r\n  init: function() {\r\n    this.log(\"init\");\r\n  },\r\n  update: function() {\r\n    this.log(\"update\");\r\n  },\r\n  tick: function() {\r\n    if (this.data.tick) {\r\n      this.log(\"tick\");\r\n    }\r\n  },\r\n  remove: function() {\r\n    this.log(\"remove\");\r\n  },\r\n  pause: function() {\r\n    this.log(\"pause\");\r\n  },\r\n  play: function() {\r\n    this.log(\"play\");\r\n  },\r\n\r\n  log: function(method) {\r\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\r\n  }\r\n});\r\n","const { Pathfinding } = require(\"three-pathfinding\");\r\n\r\nAFRAME.registerSystem(\"nav\", {\r\n  init: function() {\r\n    this.pathfinder = new Pathfinding();\r\n  },\r\n\r\n  loadMesh: function(mesh, zone) {\r\n    this.el.object3D.updateMatrixWorld();\r\n\r\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\r\n      this.mesh.geometry.dispose();\r\n    }\r\n\r\n    this.mesh = mesh;\r\n    const geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\r\n    geometry.applyMatrix(mesh.matrixWorld);\r\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\r\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\r\n  }\r\n});\r\n","/**\r\n * Listens to events from an event source and re-emits them on this entity\r\n * @component event-repeater\r\n */\r\nAFRAME.registerComponent(\"event-repeater\", {\r\n  schema: {\r\n    eventSource: { type: \"selector\" },\r\n    events: { type: \"array\" }\r\n  },\r\n\r\n  play: function() {\r\n    this.data.eventListeners = [];\r\n    const events = this.data.events;\r\n    for (let i = 0; i < events.length; i++) {\r\n      const event = events[i];\r\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\r\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\r\n    }\r\n  },\r\n\r\n  pause: function() {\r\n    const events = this.data.events;\r\n    for (let i = 0; i < events.length; i++) {\r\n      const event = events[i];\r\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\r\n    }\r\n    this.data.eventListeners = [];\r\n  },\r\n\r\n  _handleEvent: function(event, e) {\r\n    this.el.emit(event, e.detail);\r\n  }\r\n});\r\n","const boundingBox = new THREE.Box3();\r\nconst frustumBox = new THREE.Box3();\r\nconst inverseLightMatrixWorld = new THREE.Matrix4();\r\nconst tempBox = new THREE.Box3();\r\nconst FRUSTUM_PADDING = 1;\r\nconst NEAR_CLIPPING_PLANE = -500;\r\nconst FAR_CLIPPING_PLANE = 500;\r\nconst verts = [\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3()\r\n];\r\n\r\nexport default function resizeShadowCameraFrustum(light, scene) {\r\n  // Reset bounding box\r\n  frustumBox.makeEmpty();\r\n  boundingBox.makeEmpty();\r\n\r\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\r\n  scene.traverse(node => {\r\n    const geometry = node.geometry;\r\n\r\n    if (geometry && node.castShadow) {\r\n      if (!geometry.boundingBox) {\r\n        geometry.computeBoundingBox();\r\n      }\r\n\r\n      tempBox.copy(geometry.boundingBox);\r\n\r\n      // Apply matrix transforming bounding box from model space to world space\r\n      tempBox.applyMatrix4(node.matrixWorld);\r\n\r\n      boundingBox.union(tempBox);\r\n    }\r\n  });\r\n\r\n  // Transform the resulting bounding box from world space to light space.\r\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\r\n  const min = boundingBox.min;\r\n  const max = boundingBox.max;\r\n\r\n  verts[0].set(min.x, min.y, min.z);\r\n  verts[1].set(min.x, min.y, max.z);\r\n  verts[2].set(min.x, max.y, min.z);\r\n  verts[3].set(min.x, max.y, max.z);\r\n  verts[4].set(max.x, min.y, min.z);\r\n  verts[5].set(max.x, min.y, max.z);\r\n  verts[6].set(max.x, max.y, min.z);\r\n  verts[7].set(max.x, max.y, max.z);\r\n\r\n  inverseLightMatrixWorld.getInverse(light.shadow.camera.matrixWorld);\r\n\r\n  for (let i = 0; i < verts.length; i++) {\r\n    verts[i].applyMatrix4(inverseLightMatrixWorld);\r\n    frustumBox.expandByPoint(verts[i]);\r\n  }\r\n\r\n  // Update the camera frustum to fit the resulting bounding box.\r\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\r\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\r\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\r\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\r\n  const camera = light.shadow.camera;\r\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\r\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\r\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\r\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\r\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\r\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\r\n  camera.updateProjectionMatrix();\r\n}\r\n","import resizeShadowCameraFrustum from \"../utils/resizeShadowCameraFrustum\";\r\n\r\nAFRAME.registerComponent(\"directional-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 },\r\n    castShadow: { default: true },\r\n    shadowMapResolution: { default: [512, 512] },\r\n    shadowBias: { default: 0 },\r\n    shadowRadius: { default: 1 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.DirectionalLight();\r\n    this.light.position.set(0, 0, 0);\r\n    this.light.target.position.set(0, 0, 1);\r\n    this.light.add(this.light.target);\r\n    this.el.setObject3D(\"directional-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\r\n  },\r\n\r\n  update(prevData) {\r\n    const light = this.light;\r\n\r\n    if (this.data.color !== prevData.color) {\r\n      const color = new THREE.Color(this.data.color);\r\n      this.rendererSystem.applyColorCorrection(color);\r\n      light.color.copy(color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      light.intensity = this.data.intensity;\r\n    }\r\n\r\n    if (this.data.castShadow !== prevData.castShadow) {\r\n      light.castShadow = this.data.castShadow;\r\n    }\r\n\r\n    if (this.data.shadowBias !== prevData.shadowBias) {\r\n      light.shadow.bias = this.data.shadowBias;\r\n    }\r\n\r\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\r\n      light.shadow.radius = this.data.shadowRadius;\r\n    }\r\n\r\n    const [width, height] = this.data.shadowMapResolution;\r\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\r\n\r\n    if (width !== prevWidth || height !== prevHeight) {\r\n      light.shadow.mapSize.set(width, height);\r\n\r\n      if (light.shadow.map) {\r\n        light.shadow.map.dispose();\r\n        light.shadow.map = null;\r\n      }\r\n    }\r\n\r\n    this.light.shadow.camera.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  tick() {\r\n    if (window.APP && window.APP.quality === \"low\") {\r\n      return;\r\n    }\r\n\r\n    resizeShadowCameraFrustum(this.light, this.el.sceneEl.object3D);\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"directional-light\");\r\n  }\r\n});\r\n","export const Layers = {\r\n  // Layers 0 - 2 reserverd by ThreeJS and AFrame.\r\n  reflection: 3\r\n};\r\n\r\n/**\r\n * Sets layer flags on the underlying Object3D\r\n * @namespace environment\r\n * @component layers\r\n */\r\nAFRAME.registerComponent(\"layers\", {\r\n  schema: {\r\n    reflection: { type: \"boolean\", default: false },\r\n    inWorldHud: { type: \"boolean\", default: false },\r\n    exclusive: { type: \"boolean\", default: false } // if true, only these layers will be set\r\n  },\r\n  init() {\r\n    this.update = this.update.bind(this);\r\n    this.el.addEventListener(\"model-loaded\", this.update);\r\n  },\r\n  update(oldData) {\r\n    const obj = this.el.object3D;\r\n\r\n    if (this.data.exclusive) {\r\n      obj.traverse(o => (o.layers.mask = 0));\r\n    }\r\n\r\n    for (const [name, layer] of Object.entries(Layers)) {\r\n      const oldValue = oldData[name];\r\n      const newValue = this.data[name];\r\n\r\n      if (oldValue !== newValue) {\r\n        if (newValue) {\r\n          obj.traverse(o => o.layers.enable(layer));\r\n        } else {\r\n          obj.traverse(o => o.layers.disable(layer));\r\n        }\r\n      }\r\n    }\r\n  },\r\n  remove() {\r\n    this.el.removeEventListener(\"model-loaded\", this.update);\r\n  }\r\n});\r\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\r\n\r\n/**\r\n * Loops the given clip using this entity's animation mixer\r\n * @component loop-animation\r\n */\r\nAFRAME.registerComponent(\"loop-animation\", {\r\n  schema: {\r\n    paused: { type: \"boolean\", default: false },\r\n    /* DEPRECATED: Use activeClipIndex instead since animation names are not unique */\r\n    clip: { type: \"string\", default: \"\" },\r\n    activeClipIndex: { type: \"int\", default: 0 }\r\n  },\r\n\r\n  init() {\r\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\r\n\r\n    if (!this.mixerEl) {\r\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\r\n      return;\r\n    }\r\n\r\n    this.updateClip();\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.mixerEl) {\r\n      if (oldData.clip !== this.data.clip || oldData.activeClipIndex !== this.data.activeClipIndex) {\r\n        this.updateClip();\r\n      }\r\n\r\n      if (oldData.paused !== this.data.paused && this.currentAction) {\r\n        this.currentAction.paused = this.data.paused;\r\n      }\r\n    }\r\n  },\r\n\r\n  updateClip() {\r\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\r\n    const { clip: clipName, activeClipIndex } = this.data;\r\n\r\n    if (animations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    let clip;\r\n\r\n    if (clipName !== \"\") {\r\n      clip = animations.find(({ name }) => name === clipName);\r\n    } else {\r\n      clip = animations[activeClipIndex];\r\n    }\r\n\r\n    if (!clip) {\r\n      return;\r\n    }\r\n\r\n    const action = mixer.clipAction(clip, this.el.object3D);\r\n    action.enabled = true;\r\n    action.setLoop(THREE.LoopRepeat, Infinity).play();\r\n    this.currentAction = action;\r\n  },\r\n\r\n  destroy() {\r\n    if (this.currentAction) {\r\n      this.currentAction.enabled = false;\r\n      this.currentAction.stop();\r\n    }\r\n  }\r\n});\r\n","import { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\r\nimport {\r\n  resolveUrl,\r\n  getDefaultResolveQuality,\r\n  injectCustomShaderChunks,\r\n  addMeshScaleAnimation,\r\n  closeExistingMediaMirror\r\n} from \"../utils/media-utils\";\r\nimport {\r\n  isNonCorsProxyDomain,\r\n  guessContentType,\r\n  proxiedUrlFor,\r\n  isHubsRoomUrl,\r\n  isLocalHubsSceneUrl,\r\n  isLocalHubsAvatarUrl\r\n} from \"../utils/media-url-utils\";\r\nimport { addAnimationComponents } from \"../utils/animation\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\n\r\nimport loadingObjectSrc from \"../assets/models/LoadingObject_Atom.glb\";\r\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\r\nimport { loadModel } from \"./gltf-model-plus\";\r\nimport { cloneObject3D } from \"../utils/three-utils\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\nimport { SHAPE } from \"three-ammo/constants\";\r\n\r\nlet loadingObjectEnvMap;\r\nlet loadingObject;\r\n\r\nwaitForDOMContentLoaded().then(() => {\r\n  loadModel(loadingObjectSrc).then(gltf => {\r\n    loadingObject = gltf;\r\n  });\r\n});\r\n\r\nconst fetchContentType = url => {\r\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\r\n};\r\n\r\nconst forceMeshBatching = qsTruthy(\"batchMeshes\");\r\nconst disableBatching = qsTruthy(\"disableBatching\");\r\n\r\nAFRAME.registerComponent(\"media-loader\", {\r\n  schema: {\r\n    playSoundEffect: { default: true },\r\n    fileId: { type: \"string\" },\r\n    fileIsOwned: { type: \"boolean\" },\r\n    src: { type: \"string\" },\r\n    version: { type: \"number\", default: 1 }, // Used to force a re-resolution\r\n    fitToBox: { default: false },\r\n    resolve: { default: false },\r\n    contentType: { default: null },\r\n    contentSubtype: { default: null },\r\n    animate: { default: true },\r\n    linkedEl: { default: null }, // This is the element of which this is a linked derivative. See linked-media.js\r\n    mediaOptions: {\r\n      default: {},\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n\r\n  init() {\r\n    this.onError = this.onError.bind(this);\r\n    this.showLoader = this.showLoader.bind(this);\r\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\r\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\r\n    this.handleLinkedElRemoved = this.handleLinkedElRemoved.bind(this);\r\n    this.refresh = this.refresh.bind(this);\r\n    this.animating = false;\r\n\r\n    try {\r\n      NAF.utils\r\n        .getNetworkedEntity(this.el)\r\n        .then(networkedEl => {\r\n          this.networkedEl = networkedEl;\r\n        })\r\n        .catch(() => {}); //ignore exception, entity might not be networked\r\n    } catch (e) {\r\n      // NAF may not exist on scene landing page\r\n    }\r\n  },\r\n\r\n  updateScale: (function() {\r\n    const center = new THREE.Vector3();\r\n    return function(fitToBox) {\r\n      const mesh = this.el.getObject3D(\"mesh\");\r\n      const box = getBox(this.el, mesh);\r\n      const scaleCoefficient = fitToBox ? getScaleCoefficient(0.5, box) : 1;\r\n      mesh.scale.multiplyScalar(scaleCoefficient);\r\n      const { min, max } = box;\r\n      center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\r\n      mesh.position.sub(center);\r\n      mesh.matrixNeedsUpdate = true;\r\n    };\r\n  })(),\r\n\r\n  removeShape(id) {\r\n    if (this.el.getAttribute(\"shape-helper__\" + id)) {\r\n      this.el.removeAttribute(\"shape-helper__\" + id);\r\n    }\r\n  },\r\n\r\n  tick(t, dt) {\r\n    if (this.loaderMixer) {\r\n      this.loaderMixer.update(dt / 1000);\r\n    }\r\n  },\r\n\r\n  handleLinkedElRemoved(e) {\r\n    if (e.detail.name === \"media-loader\") {\r\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\r\n\r\n      // this should be revisited if we ever use media linking for something other than media mirroring UX --\r\n      // right now it is assumed if there is a linkedEl, this is the currently active mirrored media\r\n      closeExistingMediaMirror();\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    if (this.data.linkedEl) {\r\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\r\n    }\r\n\r\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\r\n    if (this.loadingSoundEffect) {\r\n      sfx.stopPositionalAudio(this.loadingSoundEffect);\r\n      this.loadingSoundEffect = null;\r\n    }\r\n    if (this.loadedSoundEffect) {\r\n      sfx.stopPositionalAudio(this.loadedSoundEffect);\r\n      this.loadedSoundEffect = null;\r\n    }\r\n  },\r\n\r\n  onError() {\r\n    this.el.removeAttribute(\"gltf-model-plus\");\r\n    this.el.removeAttribute(\"media-pager\");\r\n    this.el.removeAttribute(\"media-video\");\r\n    this.el.removeAttribute(\"media-pdf\");\r\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\r\n    this.clearLoadingTimeout();\r\n  },\r\n\r\n  showLoader() {\r\n    if (this.el.object3DMap.mesh) {\r\n      this.clearLoadingTimeout();\r\n      return;\r\n    }\r\n    const useFancyLoader = !!loadingObject;\r\n\r\n    const mesh = useFancyLoader\r\n      ? cloneObject3D(loadingObject.scene)\r\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\r\n    this.el.setObject3D(\"mesh\", mesh);\r\n\r\n    this.updateScale(true);\r\n\r\n    if (useFancyLoader) {\r\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n      if (environmentMapComponent) {\r\n        const currentEnivronmentMap = environmentMapComponent.environmentMap;\r\n        if (loadingObjectEnvMap !== currentEnivronmentMap) {\r\n          environmentMapComponent.applyEnvironmentMap(mesh);\r\n          loadingObjectEnvMap = currentEnivronmentMap;\r\n        }\r\n      }\r\n\r\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\r\n\r\n      this.loadingClip = this.loaderMixer.clipAction(mesh.animations[0]);\r\n      this.loadingScaleClip = this.loaderMixer.clipAction(\r\n        new THREE.AnimationClip(null, 1000, [\r\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\r\n        ])\r\n      );\r\n      setTimeout(() => {\r\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\r\n        this.el.setAttribute(\"shape-helper__loader\", { type: SHAPE.BOX });\r\n      }, 200);\r\n\r\n      this.loadingClip.play();\r\n      this.loadingScaleClip.play();\r\n    }\r\n\r\n    if (\r\n      this.el.sceneEl.is(\"entered\") &&\r\n      (!this.networkedEl || NAF.utils.isMine(this.networkedEl)) &&\r\n      this.data.playSoundEffect\r\n    ) {\r\n      this.loadingSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\r\n        SOUND_MEDIA_LOADING,\r\n        this.el.object3D,\r\n        true\r\n      );\r\n    }\r\n\r\n    delete this.showLoaderTimeout;\r\n  },\r\n\r\n  clearLoadingTimeout() {\r\n    clearTimeout(this.showLoaderTimeout);\r\n    if (this.loadingSoundEffect) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopPositionalAudio(this.loadingSoundEffect);\r\n      this.loadingSoundEffect = null;\r\n    }\r\n    if (this.loaderMixer) {\r\n      this.loadingClip.stop();\r\n      this.loadingScaleClip.stop();\r\n      delete this.loaderMixer;\r\n      delete this.loadingScaleClip;\r\n      delete this.loadingClip;\r\n    }\r\n    delete this.showLoaderTimeout;\r\n    this.removeShape(\"loader\");\r\n  },\r\n\r\n  updateHoverableVisuals: (function() {\r\n    const boundingBox = new THREE.Box3();\r\n    const boundingSphere = new THREE.Sphere();\r\n    return function() {\r\n      const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\r\n\r\n      if (hoverableVisuals) {\r\n        if (!this.injectedCustomShaderChunks) {\r\n          this.injectedCustomShaderChunks = true;\r\n          hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\r\n        }\r\n\r\n        boundingBox.setFromObject(this.el.object3DMap.mesh);\r\n        boundingBox.getBoundingSphere(boundingSphere);\r\n        hoverableVisuals.geometryRadius = boundingSphere.radius / this.el.object3D.scale.y;\r\n      }\r\n    };\r\n  })(),\r\n\r\n  onMediaLoaded(physicsShape = null, shouldUpdateScale) {\r\n    const el = this.el;\r\n    this.clearLoadingTimeout();\r\n\r\n    if (this.el.sceneEl.is(\"entered\") && this.data.playSoundEffect) {\r\n      this.loadedSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\r\n        SOUND_MEDIA_LOADED,\r\n        this.el.object3D,\r\n        false\r\n      );\r\n    }\r\n\r\n    const finish = () => {\r\n      this.animating = false;\r\n\r\n      if (physicsShape) {\r\n        el.setAttribute(\"shape-helper\", {\r\n          type: physicsShape,\r\n          minHalfExtent: 0.04\r\n        });\r\n      }\r\n\r\n      this.updateHoverableVisuals();\r\n\r\n      if (this.data.linkedEl) {\r\n        this.el.sceneEl.systems[\"linked-media\"].registerLinkage(this.data.linkedEl, this.el);\r\n        this.data.linkedEl.addEventListener(\"componentremoved\", this.handleLinkedElRemoved);\r\n      }\r\n\r\n      el.emit(\"media-loaded\");\r\n    };\r\n\r\n    if (this.data.animate) {\r\n      if (!this.animating) {\r\n        this.animating = true;\r\n        if (shouldUpdateScale) this.updateScale(this.data.fitToBox);\r\n        const mesh = this.el.getObject3D(\"mesh\");\r\n        const scale = { x: 0.001, y: 0.001, z: 0.001 };\r\n        scale.x = mesh.scale.x < scale.x ? mesh.scale.x * 0.001 : scale.x;\r\n        scale.y = mesh.scale.y < scale.y ? mesh.scale.x * 0.001 : scale.y;\r\n        scale.z = mesh.scale.z < scale.z ? mesh.scale.x * 0.001 : scale.z;\r\n        addMeshScaleAnimation(mesh, scale, finish);\r\n      }\r\n    } else {\r\n      if (shouldUpdateScale) this.updateScale(this.data.fitToBox);\r\n      finish();\r\n    }\r\n  },\r\n\r\n  refresh() {\r\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\r\n\r\n    // When we refresh, we bump the version to the current timestamp.\r\n    //\r\n    // The only use-case for refresh right now is re-fetching screenshots.\r\n    this.el.setAttribute(\"media-loader\", { version: Math.floor(Date.now() / 1000) });\r\n  },\r\n\r\n  async update(oldData) {\r\n    const { src, version, contentSubtype } = this.data;\r\n    if (!src) return;\r\n\r\n    const srcChanged = oldData.src !== src;\r\n    const versionChanged = !!(oldData.version && oldData.version !== version);\r\n\r\n    if (versionChanged) {\r\n      this.el.emit(\"media_refreshing\");\r\n\r\n      // Don't animate if its a refresh.\r\n      this.data.animate = false;\r\n\r\n      // Play the sound effect on a refresh only if we are the owner\r\n      this.data.playSoundEffect = NAF.utils.isMine(this.networkedEl);\r\n    }\r\n\r\n    try {\r\n      if (srcChanged && !this.showLoaderTimeout) {\r\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\r\n      }\r\n\r\n      let canonicalUrl = src;\r\n      let canonicalAudioUrl = src;\r\n      let accessibleUrl = src;\r\n      let contentType = this.data.contentType;\r\n      let thumbnail;\r\n\r\n      const parsedUrl = new URL(src);\r\n\r\n      // We want to resolve and proxy some hubs urls, like rooms and scene links,\r\n      // but want to avoid proxying assets in order for this to work in dev environments\r\n      const isLocalModelAsset =\r\n        isNonCorsProxyDomain(parsedUrl.hostname) && (guessContentType(src) || \"\").startsWith(\"model/gltf\");\r\n\r\n      if (this.data.resolve && !src.startsWith(\"data:\") && !src.startsWith(\"hubs:\") && !isLocalModelAsset) {\r\n        const is360 = !!(this.data.mediaOptions.projection && this.data.mediaOptions.projection.startsWith(\"360\"));\r\n        const quality = getDefaultResolveQuality(is360);\r\n        const result = await resolveUrl(src, quality, version);\r\n        canonicalUrl = result.origin;\r\n\r\n        // handle protocol relative urls\r\n        if (canonicalUrl.startsWith(\"//\")) {\r\n          canonicalUrl = location.protocol + canonicalUrl;\r\n        }\r\n\r\n        canonicalAudioUrl = result.origin_audio;\r\n        if (canonicalAudioUrl && canonicalAudioUrl.startsWith(\"//\")) {\r\n          canonicalAudioUrl = location.protocol + canonicalAudioUrl;\r\n        }\r\n\r\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\r\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\r\n      }\r\n\r\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\r\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\r\n\r\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\r\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\r\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\r\n\r\n      // We don't want to emit media_resolved for index updates.\r\n      if (srcChanged) {\r\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\r\n      } else {\r\n        this.el.emit(\"media_refreshed\", { src, raw: accessibleUrl, contentType });\r\n      }\r\n\r\n      if (\r\n        contentType.startsWith(\"video/\") ||\r\n        contentType.startsWith(\"audio/\") ||\r\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\r\n      ) {\r\n        let linkedVideoTexture, linkedAudioSource, linkedMediaElementAudioSource;\r\n        if (this.data.linkedEl) {\r\n          const linkedMediaVideo = this.data.linkedEl.components[\"media-video\"];\r\n\r\n          linkedVideoTexture = linkedMediaVideo.videoTexture;\r\n          linkedAudioSource = linkedMediaVideo.audioSource;\r\n          linkedMediaElementAudioSource = linkedMediaVideo.mediaElementAudioSource;\r\n        }\r\n\r\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\r\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\r\n        const startTime = hashTime || qsTime || 0;\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-image\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        this.el.addEventListener(\r\n          \"video-loaded\",\r\n          e => {\r\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.setAttribute(\r\n          \"media-video\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            audioSrc: canonicalAudioUrl ? proxiedUrlFor(canonicalAudioUrl) : null,\r\n            time: startTime,\r\n            contentType,\r\n            linkedVideoTexture,\r\n            linkedAudioSource,\r\n            linkedMediaElementAudioSource\r\n          })\r\n        );\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else if (contentType.startsWith(\"image/\")) {\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.removeAttribute(\"media-pager\");\r\n        this.el.addEventListener(\r\n          \"image-loaded\",\r\n          e => {\r\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\r\n\r\n            if (contentSubtype === \"photo-camera\") {\r\n              this.el.setAttribute(\"hover-menu__photo\", {\r\n                template: \"#photo-hover-menu\",\r\n                dirs: [\"forward\", \"back\"]\r\n              });\r\n            }\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        let batch = !disableBatching;\r\n        if (this.data.mediaOptions.hasOwnProperty(\"batch\") && !this.data.mediaOptions.batch) {\r\n          batch = false;\r\n        }\r\n        this.el.setAttribute(\r\n          \"media-image\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            version,\r\n            contentType,\r\n            batch\r\n          })\r\n        );\r\n\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else if (contentType.startsWith(\"application/pdf\")) {\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-image\");\r\n        this.el.setAttribute(\r\n          \"media-pdf\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            contentType,\r\n            batch: false // Batching disabled until atlas is updated properly\r\n          })\r\n        );\r\n        this.el.setAttribute(\"media-pager\", {});\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        this.el.addEventListener(\r\n          \"pdf-loaded\",\r\n          () => {\r\n            this.clearLoadingTimeout();\r\n            this.onMediaLoaded(SHAPE.BOX);\r\n          },\r\n          { once: true }\r\n        );\r\n\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else if (\r\n        contentType.includes(\"application/octet-stream\") ||\r\n        contentType.includes(\"x-zip-compressed\") ||\r\n        contentType.startsWith(\"model/gltf\")\r\n      ) {\r\n        this.el.removeAttribute(\"media-image\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.removeAttribute(\"media-pager\");\r\n        this.el.addEventListener(\r\n          \"model-loaded\",\r\n          () => {\r\n            this.onMediaLoaded(SHAPE.HULL, true);\r\n            addAnimationComponents(this.el);\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\r\n        let batch =\r\n          !disableBatching &&\r\n          (forceMeshBatching || (AFRAME.utils.device.isMobile() && window.APP && window.APP.quality === \"low\"));\r\n        if (this.data.mediaOptions.hasOwnProperty(\"batch\") && !this.data.mediaOptions.batch) {\r\n          batch = false;\r\n        }\r\n        this.el.setAttribute(\r\n          \"gltf-model-plus\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            contentType: contentType,\r\n            inflate: true,\r\n            batch,\r\n            modelToWorldScale: this.data.fitToBox ? 0.0001 : 1.0\r\n          })\r\n        );\r\n      } else if (contentType.startsWith(\"text/html\")) {\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.removeAttribute(\"media-pager\");\r\n        this.el.addEventListener(\r\n          \"image-loaded\",\r\n          async () => {\r\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\r\n\r\n            if (await isLocalHubsAvatarUrl(src)) {\r\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\r\n                template: \"#avatar-link-hover-menu\",\r\n                dirs: [\"forward\", \"back\"]\r\n              });\r\n            } else if ((await isHubsRoomUrl(src)) || ((await isLocalHubsSceneUrl(src)) && mayChangeScene)) {\r\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\r\n                template: \"#hubs-destination-hover-menu\",\r\n                dirs: [\"forward\", \"back\"]\r\n              });\r\n            } else {\r\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", dirs: [\"forward\", \"back\"] });\r\n            }\r\n            this.onMediaLoaded(SHAPE.BOX);\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        let batch = !disableBatching;\r\n        if (this.data.mediaOptions.hasOwnProperty(\"batch\") && !this.data.mediaOptions.batch) {\r\n          batch = false;\r\n        }\r\n        this.el.setAttribute(\r\n          \"media-image\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: thumbnail,\r\n            version,\r\n            contentType: guessContentType(thumbnail) || \"image/png\",\r\n            batch\r\n          })\r\n        );\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else {\r\n        throw new Error(`Unsupported content type: ${contentType}`);\r\n      }\r\n    } catch (e) {\r\n      console.error(\"Error adding media\", e);\r\n      this.onError();\r\n    }\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"media-pager\", {\r\n  schema: {\r\n    index: { default: 0 },\r\n    maxIndex: { default: 0 }\r\n  },\r\n\r\n  init() {\r\n    this.onNext = this.onNext.bind(this);\r\n    this.onPrev = this.onPrev.bind(this);\r\n    this.onSnap = this.onSnap.bind(this);\r\n    this.update = this.update.bind(this);\r\n\r\n    this.el.setAttribute(\"hover-menu__pager\", { template: \"#pager-hover-menu\", dirs: [\"forward\", \"back\"] });\r\n    this.el.components[\"hover-menu__pager\"].getHoverMenu().then(menu => {\r\n      // If we got removed while waiting, do nothing.\r\n      if (!this.el.parentNode) return;\r\n\r\n      this.hoverMenu = menu;\r\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\r\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\r\n      this.snapButton = this.el.querySelector(\".snap-button [text-button]\");\r\n      this.pageLabel = this.el.querySelector(\".page-label\");\r\n\r\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\r\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\r\n      this.snapButton.object3D.addEventListener(\"interact\", this.onSnap);\r\n\r\n      this.update();\r\n      this.el.emit(\"pager-loaded\");\r\n    });\r\n\r\n    NAF.utils\r\n      .getNetworkedEntity(this.el)\r\n      .then(networkedEl => {\r\n        this.networkedEl = networkedEl;\r\n        this.networkedEl.addEventListener(\"pinned\", this.update);\r\n        this.networkedEl.addEventListener(\"unpinned\", this.update);\r\n        window.APP.hubChannel.addEventListener(\"permissions_updated\", this.update);\r\n      })\r\n      .catch(() => {}); //ignore exception, entity might not be networked\r\n\r\n    this.el.addEventListener(\"pdf-loaded\", async () => {\r\n      this.update();\r\n    });\r\n  },\r\n\r\n  async update(oldData) {\r\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\r\n      if (oldData && typeof oldData.index === \"number\" && oldData.index !== this.data.index) {\r\n        this.el.emit(\"owned-pager-page-changed\");\r\n      }\r\n    }\r\n\r\n    if (this.pageLabel) {\r\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.data.maxIndex + 1}`);\r\n    }\r\n\r\n    if (this.prevButton && this.nextButton) {\r\n      const pinnableElement = this.el.components[\"media-loader\"].data.linkedEl || this.el;\r\n      const isPinned = pinnableElement.components.pinnable && pinnableElement.components.pinnable.data.pinned;\r\n      this.prevButton.object3D.visible = this.nextButton.object3D.visible =\r\n        !isPinned || window.APP.hubChannel.can(\"pin_objects\");\r\n    }\r\n  },\r\n\r\n  onNext() {\r\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\r\n    const newIndex = Math.min(this.data.index + 1, this.data.maxIndex);\r\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\r\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\r\n  },\r\n\r\n  onPrev() {\r\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\r\n    const newIndex = Math.max(this.data.index - 1, 0);\r\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\r\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\r\n  },\r\n\r\n  onSnap() {\r\n    this.el.emit(\"pager-snap-clicked\");\r\n  },\r\n\r\n  remove() {\r\n    if (this.networkedEl) {\r\n      this.networkedEl.removeEventListener(\"pinned\", this.update);\r\n      this.networkedEl.removeEventListener(\"unpinned\", this.update);\r\n    }\r\n\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.update);\r\n  }\r\n});\r\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\r\n\r\nAFRAME.registerComponent(\"quack\", {\r\n  schema: {\r\n    quackPercentage: { default: 1 },\r\n    specialQuackPercentage: { default: 0.01 }\r\n  },\r\n\r\n  init: function() {\r\n    this._handleGrabStart = this._handleGrabStart.bind(this);\r\n  },\r\n\r\n  play: function() {\r\n    this.el.object3D.addEventListener(\"interact\", this._handleGrabStart);\r\n  },\r\n\r\n  pause: function() {\r\n    this.el.object3D.removeEventListener(\"interact\", this._handleGrabStart);\r\n  },\r\n\r\n  _handleGrabStart: function() {\r\n    const rand = Math.random();\r\n    if (rand < this.data.specialQuackPercentage) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\r\n    } else if (rand < this.data.quackPercentage) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\r\n    }\r\n  }\r\n});\r\n","import { setMatrixWorld } from \"../utils/three-utils\";\r\nimport { getCurrentStreamer } from \"../utils/component-utils\";\r\nimport { CAMERA_MODE_SCENE_PREVIEW } from \"../systems/camera-system\";\r\n\r\nfunction getStreamerCamera() {\r\n  const streamer = getCurrentStreamer();\r\n  if (streamer) {\r\n    return streamer.el.querySelector(\".camera\").object3D;\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction lerp(start, end, t) {\r\n  return (1 - t) * start + t * end;\r\n}\r\n\r\nconst newRot = new THREE.Quaternion();\r\n\r\n/**\r\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\r\n * since it ends up panning in a direction dependent upon the start camera orientation,\r\n * but it's good enough for now.\r\n */\r\nAFRAME.registerComponent(\"scene-preview-camera\", {\r\n  schema: {\r\n    duration: { default: 90, type: \"number\" },\r\n    positionOnly: { default: false, type: \"boolean\" }\r\n  },\r\n\r\n  init: function() {\r\n    const systems = AFRAME.scenes[0].systems[\"hubs-systems\"] || AFRAME.scenes[0].systems[\"scene-systems\"];\r\n\r\n    if (systems) {\r\n      systems.scenePreviewCameraSystem.register(this.el);\r\n    }\r\n\r\n    this.startPoint = this.el.object3D.position.clone();\r\n    this.startRotation = this.el.object3D.quaternion.clone();\r\n\r\n    this.targetPoint = this.el.object3D.position.clone();\r\n    this.targetPoint.y = Math.max(this.targetPoint.y - 1.5, 1);\r\n    this.targetPoint.add(new THREE.Vector3(2, 0, -2));\r\n\r\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\r\n    this.targetRotation = new THREE.Quaternion();\r\n    this.targetRotation.setFromEuler(targetRotDelta);\r\n    this.targetRotation.premultiply(this.startRotation);\r\n\r\n    this.startTime = performance.now();\r\n    this.backwards = false;\r\n    this.ranOnePass = false;\r\n  },\r\n\r\n  tick2: function() {\r\n    const hubsSystems = this.el.sceneEl.systems[\"hubs-systems\"];\r\n\r\n    let streamerCamera;\r\n    if (hubsSystems) {\r\n      hubsSystems.cameraSystem.mode = CAMERA_MODE_SCENE_PREVIEW;\r\n      streamerCamera = getStreamerCamera();\r\n    }\r\n\r\n    if (streamerCamera) {\r\n      setMatrixWorld(this.el.object3D, streamerCamera.matrixWorld);\r\n      // Move camera forward just a bit so that we don't see the avatar's eye cylinders.\r\n      this.el.object3D.translateZ(-0.1);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    } else {\r\n      let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\r\n      t = Math.min(1.0, Math.max(0.0, t));\r\n\r\n      if (!this.ranOnePass) {\r\n        t = t * (2 - t);\r\n      } else {\r\n        t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n      }\r\n\r\n      const from = this.backwards ? this.targetPoint : this.startPoint;\r\n      const to = this.backwards ? this.startPoint : this.targetPoint;\r\n      const fromRot = this.backwards ? this.targetRotation : this.startRotation;\r\n      const toRot = this.backwards ? this.startRotation : this.targetRotation;\r\n\r\n      THREE.Quaternion.slerp(fromRot, toRot, newRot, t);\r\n\r\n      this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\r\n\r\n      if (!this.data.positionOnly) {\r\n        this.el.object3D.rotation.setFromQuaternion(newRot);\r\n      }\r\n\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n\r\n      if (t >= 0.9999) {\r\n        this.ranOnePass = true;\r\n        this.backwards = !this.backwards;\r\n        this.startTime = performance.now();\r\n      }\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    const systems = AFRAME.scenes[0].systems[\"hubs-systems\"] || AFRAME.scenes[0].systems[\"scene-systems\"];\r\n\r\n    if (systems) {\r\n      systems.scenePreviewCameraSystem.unregister(this.el);\r\n    }\r\n  }\r\n});\r\n","import \"three/examples/js/pmrem/PMREMGenerator\";\r\nimport \"three/examples/js/pmrem/PMREMCubeUVPacker\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\nconst isBotMode = qsTruthy(\"bot\");\r\n\r\nconst {\r\n  Scene,\r\n  CubeCamera,\r\n  Object3D,\r\n  Vector3,\r\n  BoxBufferGeometry,\r\n  ShaderMaterial,\r\n  UniformsUtils,\r\n  BackSide,\r\n  Mesh,\r\n  UniformsLib,\r\n  PMREMGenerator,\r\n  PMREMCubeUVPacker\r\n} = THREE;\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n *\r\n * Based on \"A Practical Analytic Model for Daylight\"\r\n * aka The Preetham Model, the de facto standard analytic skydome model\r\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\r\n *\r\n * First implemented by Simon Wallner\r\n * http://www.simonwallner.at/projects/atmospheric-scattering\r\n *\r\n * Improved by Martin Upitis\r\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\r\n *\r\n * Three.js integration by zz85 http://twitter.com/blurspline\r\n */\r\n\r\nconst vertexShader = `\r\n#include <common>\r\n#include <fog_pars_vertex>\r\n\r\nuniform vec3 sunPosition;\r\nuniform float rayleigh;\r\nuniform float turbidity;\r\nuniform float mieCoefficient;\r\n\r\nvarying vec3 vWorldPosition;\r\nvarying vec3 vSunDirection;\r\nvarying float vSunfade;\r\nvarying vec3 vBetaR;\r\nvarying vec3 vBetaM;\r\nvarying float vSunE;\r\n\r\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\r\n\r\n// constants for atmospheric scattering\r\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\r\nconst float pi = 3.141592653589793238462643383279502884197169;\r\n\r\n// wavelength of used primaries, according to preetham\r\nconst vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\r\n// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\r\n// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\r\nconst vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\r\n\r\n// mie stuff\r\n// K coefficient for the primaries\r\nconst float v = 4.0;\r\nconst vec3 K = vec3( 0.686, 0.678, 0.666 );\r\n// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\r\nconst vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\r\n\r\n// earth shadow hack\r\n// cutoffAngle = pi / 1.95;\r\nconst float cutoffAngle = 1.6110731556870734;\r\nconst float steepness = 1.5;\r\nconst float EE = 1000.0;\r\n\r\nfloat sunIntensity( float zenithAngleCos ) {\r\n  zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\r\n  return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\r\n}\r\n\r\nvec3 totalMie( float T ) {\r\n  float c = ( 0.2 * T ) * 10E-18;\r\n  return 0.434 * c * MieConst;\r\n}\r\n\r\nvoid main() {\r\n  #include <begin_vertex>\r\n\r\n  vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\r\n  vWorldPosition = worldPosition.xyz;\r\n\r\n  #include <project_vertex>\r\n\r\n  vSunDirection = normalize( sunPosition );\r\n\r\n  vSunE = sunIntensity( dot( vSunDirection, up ) );\r\n\r\n  vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\r\n\r\n  float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\r\n\r\n  // extinction (absorbtion + out scattering)\r\n  // rayleigh coefficients\r\n  vBetaR = totalRayleigh * rayleighCoefficient;\r\n\r\n  // mie coefficients\r\n  vBetaM = totalMie( turbidity ) * mieCoefficient;\r\n\r\n  #include <fog_vertex>\r\n}\r\n`;\r\n\r\nconst fragmentShader = `\r\n#include <common>\r\n#include <fog_pars_fragment>\r\n\r\nvarying vec3 vWorldPosition;\r\nvarying vec3 vSunDirection;\r\nvarying float vSunfade;\r\nvarying vec3 vBetaR;\r\nvarying vec3 vBetaM;\r\nvarying float vSunE;\r\n\r\nuniform float luminance;\r\nuniform float mieDirectionalG;\r\n\r\nconst vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\r\n\r\n// constants for atmospheric scattering\r\nconst float pi = 3.141592653589793238462643383279502884197169;\r\n\r\nconst float n = 1.0003; // refractive index of air\r\nconst float N = 2.545E25; // number of molecules per unit volume for air at\r\n// 288.15K and 1013mb (sea level -45 celsius)\r\n\r\n// optical length at zenith for molecules\r\nconst float rayleighZenithLength = 8.4E3;\r\nconst float mieZenithLength = 1.25E3;\r\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\r\n// 66 arc seconds -> degrees, and the cosine of that\r\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\r\n\r\n// 3.0 / ( 16.0 * pi )\r\nconst float THREE_OVER_SIXTEENPI = 0.05968310365946075;\r\n// 1.0 / ( 4.0 * pi )\r\nconst float ONE_OVER_FOURPI = 0.07957747154594767;\r\n\r\nfloat rayleighPhase( float cosTheta ) {\r\n  return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\r\n}\r\n\r\nfloat hgPhase( float cosTheta, float g ) {\r\n  float g2 = pow( g, 2.0 );\r\n  float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\r\n  return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\r\n}\r\n\r\n// Filmic ToneMapping http://filmicgames.com/archives/75\r\nconst float A = 0.15;\r\nconst float B = 0.50;\r\nconst float C = 0.10;\r\nconst float D = 0.20;\r\nconst float E = 0.02;\r\nconst float F = 0.30;\r\n\r\nconst float whiteScale = 1.0748724675633854; // 1.0 / Uncharted2Tonemap(1000.0)\r\n\r\nvec3 Uncharted2Tonemap( vec3 x ) {\r\n  return ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\r\n}\r\n\r\nvoid main() {\r\n  // optical length\r\n  // cutoff angle at 90 to avoid singularity in next formula.\r\n  float zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\r\n  float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\r\n  float sR = rayleighZenithLength * inverse;\r\n  float sM = mieZenithLength * inverse;\r\n\r\n  // combined extinction factor\r\n  vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\r\n\r\n  // in scattering\r\n  float cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\r\n\r\n  float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\r\n  vec3 betaRTheta = vBetaR * rPhase;\r\n\r\n  float mPhase = hgPhase( cosTheta, mieDirectionalG );\r\n  vec3 betaMTheta = vBetaM * mPhase;\r\n\r\n  vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\r\n  Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\r\n\r\n  // nightsky\r\n  vec3 direction = normalize( vWorldPosition - cameraPos );\r\n  float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\r\n  float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\r\n  vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\r\n  vec3 L0 = vec3( 0.1 ) * Fex;\r\n\r\n  // composition + solar disc\r\n  float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\r\n  L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\r\n\r\n  vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\r\n\r\n  vec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\r\n  vec3 color = curr * whiteScale;\r\n\r\n  vec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\r\n\r\n  gl_FragColor = vec4( retColor, 1.0 );\r\n\r\n  #include <fog_fragment>\r\n}\r\n`;\r\n\r\nexport default class Sky extends Object3D {\r\n  static shader = {\r\n    uniforms: UniformsUtils.merge([\r\n      UniformsLib.fog,\r\n      {\r\n        luminance: { value: 1 },\r\n        turbidity: { value: 10 },\r\n        rayleigh: { value: 2 },\r\n        mieCoefficient: { value: 0.005 },\r\n        mieDirectionalG: { value: 0.8 },\r\n        sunPosition: { value: new Vector3() }\r\n      }\r\n    ]),\r\n    vertexShader,\r\n    fragmentShader\r\n  };\r\n\r\n  static _geometry = new BoxBufferGeometry(1, 1, 1);\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    const material = new ShaderMaterial({\r\n      fragmentShader: Sky.shader.fragmentShader,\r\n      vertexShader: Sky.shader.vertexShader,\r\n      uniforms: UniformsUtils.clone(Sky.shader.uniforms),\r\n      side: BackSide,\r\n      fog: true\r\n    });\r\n\r\n    this.skyScene = new Scene();\r\n    this.cubeCamera = new CubeCamera(1, 100000, 512);\r\n    this.skyScene.add(this.cubeCamera);\r\n\r\n    this.sky = new Mesh(Sky._geometry, material);\r\n    this.sky.name = \"Sky\";\r\n    this.add(this.sky);\r\n\r\n    this._inclination = 0;\r\n    this._azimuth = 0.15;\r\n    this._distance = 8000;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  get turbidity() {\r\n    return this.sky.material.uniforms.turbidity.value;\r\n  }\r\n\r\n  set turbidity(value) {\r\n    this.sky.material.uniforms.turbidity.value = value;\r\n  }\r\n\r\n  get rayleigh() {\r\n    return this.sky.material.uniforms.rayleigh.value;\r\n  }\r\n\r\n  set rayleigh(value) {\r\n    this.sky.material.uniforms.rayleigh.value = value;\r\n  }\r\n\r\n  get luminance() {\r\n    return this.sky.material.uniforms.luminance.value;\r\n  }\r\n\r\n  set luminance(value) {\r\n    this.sky.material.uniforms.luminance.value = value;\r\n  }\r\n\r\n  get mieCoefficient() {\r\n    return this.sky.material.uniforms.mieCoefficient.value;\r\n  }\r\n\r\n  set mieCoefficient(value) {\r\n    this.sky.material.uniforms.mieCoefficient.value = value;\r\n  }\r\n\r\n  get mieDirectionalG() {\r\n    return this.sky.material.uniforms.mieDirectionalG.value;\r\n  }\r\n\r\n  set mieDirectionalG(value) {\r\n    this.sky.material.uniforms.mieDirectionalG.value = value;\r\n  }\r\n\r\n  get inclination() {\r\n    return this._inclination;\r\n  }\r\n\r\n  set inclination(value) {\r\n    this._inclination = value;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  get azimuth() {\r\n    return this._azimuth;\r\n  }\r\n\r\n  set azimuth(value) {\r\n    this._azimuth = value;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  get distance() {\r\n    return this._distance;\r\n  }\r\n\r\n  set distance(value) {\r\n    this._distance = value;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  updateSunPosition() {\r\n    const theta = Math.PI * (this._inclination - 0.5);\r\n    const phi = 2 * Math.PI * (this._azimuth - 0.5);\r\n\r\n    const distance = this._distance;\r\n\r\n    const x = distance * Math.cos(phi);\r\n    const y = distance * Math.sin(phi) * Math.sin(theta);\r\n    const z = distance * Math.sin(phi) * Math.cos(theta);\r\n\r\n    this.sky.material.uniforms.sunPosition.value.set(x, y, z).normalize();\r\n    this.sky.scale.set(distance, distance, distance);\r\n  }\r\n\r\n  generateEnvironmentMap(renderer) {\r\n    this.skyScene.add(this.sky);\r\n    this.cubeCamera.update(renderer, this.skyScene);\r\n    this.add(this.sky);\r\n    const vrEnabled = renderer.vr.enabled;\r\n    renderer.vr.enabled = false;\r\n    const pmremGenerator = new PMREMGenerator(this.cubeCamera.renderTarget.texture);\r\n    pmremGenerator.update(renderer);\r\n    const pmremCubeUVPacker = new PMREMCubeUVPacker(pmremGenerator.cubeLods);\r\n    pmremCubeUVPacker.update(renderer);\r\n    renderer.vr.enabled = vrEnabled;\r\n    pmremGenerator.dispose();\r\n    pmremCubeUVPacker.dispose();\r\n    return pmremCubeUVPacker.CubeUVRenderTarget.texture;\r\n  }\r\n\r\n  copy(source, recursive = true) {\r\n    if (recursive) {\r\n      this.remove(this.sky);\r\n    }\r\n\r\n    super.copy(source, recursive);\r\n\r\n    if (recursive) {\r\n      const skyIndex = source.children.indexOf(source.sky);\r\n\r\n      if (skyIndex !== -1) {\r\n        this.sky = this.children[skyIndex];\r\n      }\r\n    }\r\n\r\n    this.turbidity = source.turbidity;\r\n    this.rayleigh = source.rayleigh;\r\n    this.luminance = source.luminance;\r\n    this.mieCoefficient = source.mieCoefficient;\r\n    this.mieDirectionalG = source.mieDirectionalG;\r\n    this.inclination = source.inclination;\r\n    this.azimuth = source.azimuth;\r\n    this.distance = source.distance;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nAFRAME.registerComponent(\"skybox\", {\r\n  schema: {\r\n    turbidity: { type: \"number\", default: 10 },\r\n    rayleigh: { type: \"number\", default: 2 },\r\n    luminance: { type: \"number\", default: 1 },\r\n    mieCoefficient: { type: \"number\", default: 0.005 },\r\n    mieDirectionalG: { type: \"number\", default: 0.8 },\r\n    inclination: { type: \"number\", default: 0 },\r\n    azimuth: { type: \"number\", default: 0.15 },\r\n    distance: { type: \"number\", default: 8000 }\r\n  },\r\n\r\n  init() {\r\n    this.sky = new Sky();\r\n    this.sky.cubeCamera.children.forEach(o => (o.matrixNeedsUpdate = true));\r\n    this.el.setObject3D(\"mesh\", this.sky);\r\n\r\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\r\n    // HACK: Render environment map on next frame to avoid bug where the render target texture is black.\r\n    // This is likely due to the custom elements attached callback being synchronous on Chrome but not Firefox.\r\n    // Added timeout due to additional case where texture is black in Firefox.\r\n    requestAnimationFrame(() => setTimeout(this.updateEnvironmentMap));\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data.turbidity !== oldData.turbidity) {\r\n      this.sky.turbidity = this.data.turbidity;\r\n    }\r\n\r\n    if (this.data.rayleigh !== oldData.rayleigh) {\r\n      this.sky.rayleigh = this.data.rayleigh;\r\n    }\r\n\r\n    if (this.data.luminance !== oldData.luminance) {\r\n      this.sky.luminance = this.data.luminance;\r\n    }\r\n\r\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\r\n      this.sky.mieCoefficient = this.data.mieCoefficient;\r\n    }\r\n\r\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\r\n      this.sky.mieDirectionalG = this.data.mieDirectionalG;\r\n    }\r\n\r\n    if (this.data.inclination !== oldData.inclination) {\r\n      this.sky.inclination = this.data.inclination;\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    if (this.data.azimuth !== oldData.azimuth) {\r\n      this.sky.azimuth = this.data.azimuth;\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    if (this.data.distance !== oldData.distance) {\r\n      const distance = this.data.distance;\r\n\r\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\r\n      // have their sky scales set to 1.\r\n      this.sky.distance = this.el.object3D.scale.x === 1 ? distance : 1;\r\n      this.sky.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    this.updateEnvironmentMap();\r\n  },\r\n\r\n  updateEnvironmentMap() {\r\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n\r\n    if (environmentMapComponent && !isBotMode) {\r\n      const renderer = this.el.sceneEl.renderer;\r\n      const envMap = this.sky.generateEnvironmentMap(renderer);\r\n      environmentMapComponent.updateEnvironmentMap(envMap);\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeObject3D(\"mesh\");\r\n  }\r\n});\r\n","import { getLastWorldPosition } from \"../utils/three-utils\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\n/**\r\n * Used on a avatar-rig to move the avatar to a random spawn point on entry.\r\n * @namespace avatar\r\n * @component spawn-controller\r\n */\r\nAFRAME.registerComponent(\"spawn-controller\", {\r\n  schema: {\r\n    target: { type: \"selector\" },\r\n    camera: { type: \"selector\", default: \"#avatar-pov-node\" },\r\n    playerHeight: { default: 1.6 },\r\n    loadedEvent: { type: \"string\" }\r\n  },\r\n  init() {\r\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\r\n    });\r\n  },\r\n  moveToSpawnPoint() {\r\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\r\n\r\n    if (spawnPoints.length === 0) {\r\n      // Keep default position\r\n      return;\r\n    }\r\n\r\n    const camera = this.data.camera;\r\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\r\n    const spawnPoint = spawnPoints[spawnPointIndex];\r\n\r\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\r\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\r\n\r\n    if (this.el.sceneEl.is(\"vr-mode\")) {\r\n      // Rotate the avatar rig such that the vr-camera faces forward.\r\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\r\n    } else {\r\n      // Reset the camera transform in 2D mode.\r\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\r\n      camera.object3D.rotation.set(0, 0, 0);\r\n      camera.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\r\n    this.el.object3D.rotation.y += Math.PI;\r\n    this.el.object3D.matrixNeedsUpdate = true;\r\n  }\r\n});\r\n\r\n/**\r\n * Marks an entity as a potential spawn point.\r\n * @namespace environment\r\n * @component spawn-point\r\n */\r\nAFRAME.registerComponent(\"spawn-point\", {\r\n  init() {\r\n    this.el.object3D.visible = false;\r\n  }\r\n});\r\n","/* global require AFRAME THREE setTimeout clearTimeout */\r\nimport { addMedia } from \"../utils/media-utils\";\r\nimport { waitForEvent } from \"../utils/async-utils\";\r\nimport { ObjectContentOrigins } from \"../object-types\";\r\nimport { paths } from \"../systems/userinput/paths\";\r\nimport { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\r\n\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\n\r\nfunction setNonNullVec3Components(target, values) {\r\n  target.set(\r\n    values.x === null ? target.x : values.x,\r\n    values.y === null ? target.y : values.y,\r\n    values.z === null ? target.z : values.z\r\n  );\r\n}\r\n\r\n/**\r\n * Spawns networked objects when grabbed or when a specified event is fired.\r\n * @namespace network\r\n * @component super-spawner\r\n */\r\nAFRAME.registerComponent(\"super-spawner\", {\r\n  schema: {\r\n    /**\r\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\r\n     */\r\n    src: { default: \"\" },\r\n\r\n    /**\r\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\r\n     */\r\n    resolve: { default: false },\r\n\r\n    /**\r\n     * The template to use for this object\r\n     */\r\n    template: { default: \"\" },\r\n\r\n    /**\r\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\r\n     */\r\n    spawnScale: { type: \"vec3\", default: { x: NaN, y: NaN, z: NaN } },\r\n\r\n    /**\r\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\r\n     */\r\n    spawnCooldown: { default: 1 },\r\n\r\n    /**\r\n     * Optional event to listen for to spawn an object on the preferred superHand\r\n     */\r\n    spawnEvent: { type: \"string\" },\r\n\r\n    /**\r\n     * If true, will spawn the object at the cursor and animate it into the hand.\r\n     */\r\n    animateFromCursor: { type: \"boolean\" },\r\n\r\n    mediaOptions: {\r\n      default: {},\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n\r\n  init() {\r\n    this.cooldownTimeout = null;\r\n    this.handPosition = new THREE.Vector3();\r\n\r\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\r\n\r\n    this.sceneEl = this.el.sceneEl;\r\n\r\n    this.tempSpawnHandPosition = new THREE.Vector3();\r\n\r\n    this.handleMediaLoaded = this.handleMediaLoaded.bind(this);\r\n\r\n    this.spawnedMediaScale = null;\r\n  },\r\n\r\n  play() {\r\n    this.el.addEventListener(\"media-loaded\", this.handleMediaLoaded);\r\n    if (this.data.spawnEvent) {\r\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\r\n    }\r\n  },\r\n\r\n  pause() {\r\n    this.el.removeEventListener(\"media-loaded\", this.handleMediaLoaded);\r\n    if (this.data.spawnEvent) {\r\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\r\n    }\r\n    if (this.cooldownTimeout) {\r\n      clearTimeout(this.cooldownTimeout);\r\n      this.cooldownTimeout = null;\r\n      this.el.setAttribute(\"visible\", true);\r\n      this.el.classList.add(\"interactable\");\r\n    }\r\n  },\r\n\r\n  handleMediaLoaded(e) {\r\n    const spawnedEntity = e.target;\r\n    this.spawnedMediaScale = spawnedEntity.object3D.scale.clone();\r\n    setNonNullVec3Components(this.spawnedMediaScale, this.data.spawnScale);\r\n\r\n    const boxSize =\r\n      spawnedEntity.components[\"media-image\"] ||\r\n      spawnedEntity.components[\"media-video\"] ||\r\n      spawnedEntity.components[\"media-pdf\"]\r\n        ? 1\r\n        : 0.5;\r\n\r\n    const scaleCoefficient = getScaleCoefficient(boxSize, getBox(spawnedEntity, spawnedEntity.object3D));\r\n    this.spawnedMediaScale.divideScalar(scaleCoefficient);\r\n  },\r\n\r\n  async onSpawnEvent(e) {\r\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\r\n      return;\r\n    }\r\n\r\n    const spawnedEntity = addMedia(\r\n      this.data.src,\r\n      this.data.template,\r\n      ObjectContentOrigins.SPAWNER,\r\n      null,\r\n      this.data.resolve,\r\n      false,\r\n      {\r\n        x: this.data.spawnScale.x === null ? 1 : this.data.spawnScale.x,\r\n        y: this.data.spawnScale.y === null ? 1 : this.data.spawnScale.y,\r\n        z: this.data.spawnScale.z === null ? 1 : this.data.spawnScale.z\r\n      }\r\n    ).entity;\r\n\r\n    const interaction = this.el.sceneEl.systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n    const cursor = (e.detail && e.detail.object3D) || interaction.options.rightRemote.entity.object3D;\r\n\r\n    const left = cursor.el.id.indexOf(\"right\") === -1;\r\n    const hand = left ? interaction.options.leftHand.entity.object3D : interaction.options.rightHand.entity.object3D;\r\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\r\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\r\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\r\n\r\n    this.el.emit(\"spawned-entity-created\", { target: spawnedEntity });\r\n\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const willAnimateFromCursor =\r\n      this.data.animateFromCursor &&\r\n      (userinput.get(paths.actions.rightHand.matrix) || userinput.get(paths.actions.leftHand.matrix));\r\n    if (!willAnimateFromCursor) {\r\n      if (left) {\r\n        interaction.state.leftRemote.held = spawnedEntity;\r\n        interaction.state.leftRemote.spawning = true;\r\n      } else {\r\n        interaction.state.rightRemote.held = spawnedEntity;\r\n        interaction.state.rightRemote.spawning = true;\r\n      }\r\n    }\r\n    this.activateCooldown();\r\n    await waitForEvent(\"model-loaded\", spawnedEntity);\r\n\r\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\r\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\r\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\r\n\r\n    if (willAnimateFromCursor) {\r\n      hand.getWorldPosition(this.handPosition);\r\n      spawnedEntity.setAttribute(\"animation__spawn-at-cursor\", {\r\n        property: \"position\",\r\n        delay: 500,\r\n        dur: 1500,\r\n        from: {\r\n          x: spawnedEntity.object3D.position.x,\r\n          y: spawnedEntity.object3D.position.y,\r\n          z: spawnedEntity.object3D.position.z\r\n        },\r\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\r\n        easing: \"easeInOutBack\"\r\n      });\r\n    } else {\r\n      if (left) {\r\n        interaction.state.leftRemote.spawning = false;\r\n      } else {\r\n        interaction.state.rightRemote.spawning = false;\r\n      }\r\n    }\r\n    if (spawnedEntity.components[\"body-helper\"].body) {\r\n      spawnedEntity.components[\"body-helper\"].body.syncToPhysics(true);\r\n    }\r\n\r\n    spawnedEntity.addEventListener(\r\n      \"media-loaded\",\r\n      () => {\r\n        this.el.emit(\"spawned-entity-loaded\", { target: spawnedEntity });\r\n      },\r\n      { once: true }\r\n    );\r\n  },\r\n\r\n  activateCooldown() {\r\n    if (this.data.spawnCooldown > 0) {\r\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\r\n\r\n      this.el.setAttribute(\"visible\", false);\r\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n      this.el.classList.remove(\"interactable\");\r\n      this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.NONE });\r\n      this.cooldownTimeout = setTimeout(() => {\r\n        this.el.setAttribute(\"visible\", true);\r\n        this.el.classList.add(\"interactable\");\r\n        this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\r\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\r\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\r\n          property: \"scale\",\r\n          delay: 50,\r\n          dur: 350,\r\n          from: { x: 0.001, y: 0.001, z: 0.001 },\r\n          to: { x: sx, y: sy, z: sz },\r\n          easing: \"easeOutElastic\"\r\n        });\r\n\r\n        this.cooldownTimeout = null;\r\n      }, this.data.spawnCooldown * 1000);\r\n    }\r\n  }\r\n});\r\n","import { Layers } from \"./layers\";\r\nimport \"../vendor/Water\";\r\nimport waterNormalMap from \"../assets/waternormals.jpg\";\r\n\r\n/**\r\n * @author jbouny / https://github.com/jbouny\r\n *\r\n * Work based on :\r\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\r\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\r\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\r\n */\r\n\r\nfunction MobileWater(geometry, options) {\r\n  THREE.Mesh.call(this, geometry);\r\n\r\n  const scope = this;\r\n\r\n  options = options || {};\r\n\r\n  const time = options.time !== undefined ? options.time : 0.0;\r\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\r\n  const sunDirection =\r\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\r\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\r\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\r\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\r\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\r\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\r\n  const fog = options.fog !== undefined ? options.fog : false;\r\n\r\n  const mirrorShader = {\r\n    uniforms: THREE.UniformsUtils.merge([\r\n      THREE.UniformsLib[\"lights\"],\r\n      {\r\n        normalSampler: { value: null },\r\n        time: { value: 0.0 },\r\n        size: { value: 1.0 },\r\n        distortionScale: { value: 20.0 },\r\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\r\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\r\n        eye: { value: new THREE.Vector3() },\r\n        waterColor: { value: new THREE.Color(0x555555) }\r\n      }\r\n    ]),\r\n\r\n    vertexShader: `\r\n      uniform float time;\r\n      varying vec4 worldPosition;\r\n\r\n      void main() {\r\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\r\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\r\n      \tgl_Position = projectionMatrix * mvPosition;\r\n\r\n      }\r\n    `,\r\n\r\n    fragmentShader: `\r\n      uniform float time;\r\n      uniform float size;\r\n      uniform float distortionScale;\r\n      uniform sampler2D normalSampler;\r\n      uniform vec3 sunColor;\r\n      uniform vec3 sunDirection;\r\n      uniform vec3 eye;\r\n      uniform vec3 waterColor;\r\n\r\n      varying vec4 worldPosition;\r\n\r\n      vec4 getNoise( vec2 uv ) {\r\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\r\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\r\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\r\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\r\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\r\n      \t\ttexture2D( normalSampler, uv1 ) +\r\n      \t\ttexture2D( normalSampler, uv2 ) +\r\n      \t\ttexture2D( normalSampler, uv3 );\r\n      \treturn noise * 0.5 - 1.0;\r\n      }\r\n\r\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\r\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\r\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\r\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\r\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\r\n      }\r\n\r\n      ${THREE.ShaderChunk[\"common\"]}\r\n      ${THREE.ShaderChunk[\"packing\"]}\r\n      ${THREE.ShaderChunk[\"bsdfs\"]}\r\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\r\n\r\n      void main() {\r\n      \tvec4 noise = getNoise( worldPosition.xz * size );\r\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\r\n\r\n      \tvec3 diffuseLight = vec3(0.0);\r\n      \tvec3 specularLight = vec3(0.0);\r\n\r\n      \tvec3 worldToEye = eye-worldPosition.xyz;\r\n      \tvec3 eyeDirection = normalize( worldToEye );\r\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\r\n\r\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\r\n      \tfloat rf0 = 0.3;\r\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\r\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\r\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\r\n      \tvec3 outgoingLight = albedo;\r\n      \tgl_FragColor = vec4( outgoingLight, 1 );\r\n      }\r\n    `\r\n  };\r\n\r\n  const material = new THREE.ShaderMaterial({\r\n    fragmentShader: mirrorShader.fragmentShader,\r\n    vertexShader: mirrorShader.vertexShader,\r\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\r\n    transparent: false,\r\n    lights: true,\r\n    side: side,\r\n    fog: fog\r\n  });\r\n\r\n  material.uniforms.time.value = time;\r\n  material.uniforms.normalSampler.value = normalSampler;\r\n  material.uniforms.sunColor.value = sunColor;\r\n  material.uniforms.waterColor.value = waterColor;\r\n  material.uniforms.sunDirection.value = sunDirection;\r\n  material.uniforms.distortionScale.value = distortionScale;\r\n\r\n  material.uniforms.eye.value = eye;\r\n\r\n  scope.material = material;\r\n}\r\n\r\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\r\nMobileWater.prototype.constructor = THREE.Water;\r\n\r\nasync function loadWaterNormals(url) {\r\n  const texture = await new Promise((resolve, reject) =>\r\n    new THREE.TextureLoader().load(url, resolve, undefined, reject)\r\n  );\r\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\r\n  texture.needsUpdate = true;\r\n  return texture;\r\n}\r\n\r\nAFRAME.registerComponent(\"water\", {\r\n  schema: {\r\n    waterColor: { type: \"color\", default: \"#001e0f\" },\r\n    distortionScale: { type: \"number\", default: 3.7 },\r\n    sunColor: { type: \"color\", default: \"#ffffff\" },\r\n    inclination: { type: \"number\", default: 0 },\r\n    azimuth: { type: \"number\", default: 0 },\r\n    distance: { type: \"number\", default: 1 },\r\n    speed: { type: \"number\", default: 0.1 },\r\n    forceMobile: { type: \"boolean\", default: false }\r\n  },\r\n  init() {\r\n    const waterMesh = this.el.getObject3D(\"mesh\");\r\n    const waterGeometry = waterMesh.geometry;\r\n\r\n    // Render THREE.Water shader instead of THREE.Mesh\r\n    waterMesh.visible = false;\r\n\r\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\r\n      const waterConfig = {\r\n        textureWidth: 512,\r\n        textureHeight: 512,\r\n        waterNormals: waterNormals,\r\n        sunDirection: this.data.sunDirection,\r\n        sunColor: new THREE.Color(this.data.sunColor),\r\n        waterColor: new THREE.Color(this.data.waterColor),\r\n        distortionScale: this.data.distortionScale,\r\n        fog: false\r\n      };\r\n\r\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\r\n        this.water = new MobileWater(waterGeometry, waterConfig);\r\n      } else {\r\n        this.water = new THREE.Water(waterGeometry, waterConfig);\r\n        this.water.mirrorCamera.layers.set(Layers.reflection);\r\n      }\r\n\r\n      this.el.setObject3D(\"water\", this.water);\r\n    });\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data.forceMobile !== oldData.forceMobile) {\r\n      this.el.removeObject3D(\"water\");\r\n      this.init();\r\n      return;\r\n    }\r\n\r\n    if (!this.water) {\r\n      return;\r\n    }\r\n\r\n    const uniforms = this.water.material.uniforms;\r\n\r\n    if (this.data.waterColor !== oldData.waterColor) {\r\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\r\n    }\r\n\r\n    if (this.data.distortionScale !== oldData.distortionScale) {\r\n      uniforms.distortionScale.value = this.data.distortionScale;\r\n    }\r\n\r\n    if (this.data.sunColor !== oldData.sunColor) {\r\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\r\n    }\r\n\r\n    if (\r\n      this.data.inclination !== oldData.inclination ||\r\n      this.data.azimuth !== oldData.azimuth ||\r\n      this.data.distance !== oldData.distance\r\n    ) {\r\n      const theta = Math.PI * (this.data.inclination - 0.5);\r\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\r\n\r\n      const distance = this.data.distance;\r\n\r\n      const x = distance * Math.cos(phi);\r\n      const y = distance * Math.sin(phi) * Math.sin(theta);\r\n      const z = distance * Math.sin(phi) * Math.cos(theta);\r\n\r\n      uniforms.sunDirection.value.set(x, y, z);\r\n    }\r\n  },\r\n\r\n  tick(time) {\r\n    if (this.water) {\r\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeObject3D(\"water\");\r\n    const waterMesh = this.el.getObject3D(\"mesh\");\r\n    waterMesh.visible = true;\r\n  }\r\n});\r\n","import { SimplexNoise } from \"three/examples/jsm/math/SimplexNoise\";\r\nimport waterNormalsUrl from \"../assets/waternormals.jpg\";\r\n\r\nconst {\r\n  Mesh,\r\n  PlaneBufferGeometry,\r\n  MeshStandardMaterial,\r\n  MeshPhongMaterial,\r\n  Vector2,\r\n  TextureLoader,\r\n  RepeatWrapping\r\n} = THREE;\r\n\r\n/**\r\n * SimpleWater\r\n * Keep in sync with Spoke's SimpleWater class\r\n */\r\n\r\n/**\r\n * Adapted dynamic geometry code from: https://github.com/ditzel/UnityOceanWavesAndShip\r\n */\r\n\r\nclass Octave {\r\n  constructor(speed = new Vector2(1, 1), scale = new Vector2(1, 1), height = 0.0025, alternate = true) {\r\n    this.speed = speed;\r\n    this.scale = scale;\r\n    this.height = height;\r\n    this.alternate = alternate;\r\n  }\r\n}\r\nexport default class SimpleWater extends Mesh {\r\n  constructor(normalMap, resolution = 24, lowQuality = false) {\r\n    const geometry = new PlaneBufferGeometry(10, 10, resolution, resolution);\r\n    geometry.rotateX(-Math.PI / 2);\r\n\r\n    const waterUniforms = {\r\n      ripplesSpeed: { value: 0.25 },\r\n      ripplesScale: { value: 1 },\r\n      time: { value: 0 }\r\n    };\r\n\r\n    const materialClass = lowQuality ? MeshPhongMaterial : MeshStandardMaterial;\r\n\r\n    normalMap.wrapS = normalMap.wrapT = RepeatWrapping;\r\n\r\n    const material = new materialClass({ color: 0x0054df, normalMap });\r\n    material.name = \"SimpleWaterMaterial\";\r\n\r\n    material.onBeforeCompile = shader => {\r\n      Object.assign(shader.uniforms, waterUniforms);\r\n\r\n      shader.vertexShader = shader.vertexShader.replace(\r\n        \"#include <fog_pars_vertex>\",\r\n        `\r\n        #include <fog_pars_vertex>\r\n        varying vec3 vWPosition;\r\n      `\r\n      );\r\n\r\n      shader.vertexShader = shader.vertexShader.replace(\r\n        \"#include <fog_vertex>\",\r\n        `\r\n        #include <fog_vertex>\r\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\r\n      `\r\n      );\r\n\r\n      // getNoise function from https://github.com/mrdoob/three.js/blob/dev/examples/jsm/objects/Water.js\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        \"#include <normalmap_pars_fragment>\",\r\n        `\r\n        #include <normalmap_pars_fragment>\r\n\r\n        uniform float time;\r\n        uniform float ripplesSpeed;\r\n        uniform float ripplesScale;\r\n      \r\n        varying vec3 vWPosition;\r\n      \r\n        vec4 getNoise(vec2 uv){\r\n          float timeOffset = time * ripplesSpeed;\r\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\r\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\r\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\r\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\r\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\r\n          vec4 noise = (texture2D(normalMap, uv0)) +\r\n                       (texture2D(normalMap, uv1)) +\r\n                       (texture2D(normalMap, uv2)) +\r\n                       (texture2D(normalMap, uv3));\r\n          return noise / 4.0;\r\n        }\r\n      `\r\n      );\r\n\r\n      // https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl.js#L20\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        \"#include <normal_fragment_maps>\",\r\n        `\r\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\r\n\r\n          vec3 eye_pos = -vViewPosition;\r\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\r\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\r\n          vec2 st0 = dFdx( vUv.st );\r\n          vec2 st1 = dFdy( vUv.st );\r\n\r\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\r\n\r\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\r\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\r\n          vec3 N = normalize( normal );\r\n          mat3 tsn = mat3( S, T, N );\r\n\r\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\r\n\r\n          mapN.xy *= normalScale;\r\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\r\n\r\n          normal = normalize( tsn * mapN );\r\n        `\r\n      );\r\n    };\r\n\r\n    super(geometry, material);\r\n\r\n    this.lowQuality = lowQuality;\r\n    this.waterUniforms = waterUniforms;\r\n\r\n    if (lowQuality) {\r\n      this.material.specular.set(0xffffff);\r\n    } else {\r\n      this.receiveShadow = true;\r\n    }\r\n\r\n    this.geometry.attributes.position.dynamic = true;\r\n\r\n    this.resolution = resolution;\r\n    this.octaves = [\r\n      new Octave(new Vector2(0.5, 0.5), new Vector2(1, 1), 0.01, true),\r\n      new Octave(new Vector2(0.05, 6), new Vector2(1, 20), 0.1, false)\r\n    ];\r\n\r\n    this.simplex = new SimplexNoise();\r\n  }\r\n\r\n  get opacity() {\r\n    return this.material.opacity;\r\n  }\r\n\r\n  set opacity(value) {\r\n    this.material.opacity = value;\r\n\r\n    if (value !== 1) {\r\n      this.material.transparent = true;\r\n    }\r\n  }\r\n\r\n  get color() {\r\n    return this.material.color;\r\n  }\r\n\r\n  get tideHeight() {\r\n    return this.octaves[0].height;\r\n  }\r\n\r\n  get tideScale() {\r\n    return this.octaves[0].scale;\r\n  }\r\n\r\n  get tideSpeed() {\r\n    return this.octaves[0].speed;\r\n  }\r\n\r\n  set tideHeight(value) {\r\n    this.octaves[0].height = value;\r\n  }\r\n\r\n  get waveHeight() {\r\n    return this.octaves[1].height;\r\n  }\r\n\r\n  set waveHeight(value) {\r\n    this.octaves[1].height = value;\r\n  }\r\n\r\n  get waveScale() {\r\n    return this.octaves[1].scale;\r\n  }\r\n\r\n  get waveSpeed() {\r\n    return this.octaves[1].speed;\r\n  }\r\n\r\n  set ripplesSpeed(value) {\r\n    this.waterUniforms.ripplesSpeed.value = value;\r\n  }\r\n\r\n  get ripplesSpeed() {\r\n    return this.waterUniforms.ripplesSpeed.value;\r\n  }\r\n\r\n  set ripplesScale(value) {\r\n    this.waterUniforms.ripplesScale.value = value;\r\n  }\r\n\r\n  get ripplesScale() {\r\n    return this.waterUniforms.ripplesScale.value;\r\n  }\r\n\r\n  update(time) {\r\n    const positionAttribute = this.geometry.attributes.position;\r\n\r\n    for (let x = 0; x <= this.resolution; x++) {\r\n      for (let z = 0; z <= this.resolution; z++) {\r\n        let y = 0;\r\n\r\n        for (let o = 0; o < this.octaves.length; o++) {\r\n          const octave = this.octaves[o];\r\n\r\n          if (octave.alternate) {\r\n            const noise = this.simplex.noise(\r\n              (x * octave.scale.x) / this.resolution,\r\n              (z * octave.scale.y) / this.resolution\r\n            );\r\n            y += Math.cos(noise + octave.speed.length() * time) * octave.height;\r\n          } else {\r\n            const noise =\r\n              this.simplex.noise(\r\n                (x * octave.scale.x + time * octave.speed.x) / this.resolution,\r\n                (z * octave.scale.y + time * octave.speed.y) / this.resolution\r\n              ) - 0.5;\r\n            y += noise * octave.height;\r\n          }\r\n        }\r\n\r\n        positionAttribute.setY(x * (this.resolution + 1) + z, y);\r\n      }\r\n    }\r\n\r\n    this.geometry.computeVertexNormals();\r\n    positionAttribute.needsUpdate = true;\r\n    this.waterUniforms.time.value = time;\r\n  }\r\n\r\n  clone(recursive) {\r\n    return new SimpleWater(this.material.normalMap, this.resolution, this.lowQuality).copy(this, recursive);\r\n  }\r\n\r\n  copy(source, recursive = true) {\r\n    super.copy(source, recursive);\r\n\r\n    this.opacity = source.opacity;\r\n    this.color.copy(source.color);\r\n    this.tideHeight = source.tideHeight;\r\n    this.tideScale.copy(source.tideScale);\r\n    this.tideSpeed.copy(source.tideSpeed);\r\n    this.waveHeight = source.waveHeight;\r\n    this.waveScale.copy(source.waveScale);\r\n    this.waveSpeed.copy(source.waveSpeed);\r\n    this.ripplesSpeed = source.ripplesSpeed;\r\n    this.ripplesScale = source.ripplesScale;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nfunction vec2Equals(a, b) {\r\n  return a && b && a.x === b.x && a.y === b.y;\r\n}\r\n\r\nlet waterNormalMap = null;\r\n\r\nAFRAME.registerComponent(\"simple-water\", {\r\n  schema: {\r\n    opacity: { type: \"number\", default: 1 },\r\n    color: { type: \"color\" },\r\n    tideHeight: { type: \"number\", default: 0.01 },\r\n    tideScale: { type: \"vec2\", default: { x: 1, y: 1 } },\r\n    tideSpeed: { type: \"vec2\", default: { x: 0.5, y: 0.5 } },\r\n    waveHeight: { type: \"number\", default: 0.1 },\r\n    waveScale: { type: \"vec2\", default: { x: 1, y: 20 } },\r\n    waveSpeed: { type: \"vec2\", default: { x: 0.05, y: 6 } },\r\n    ripplesScale: { type: \"number\", default: 1 },\r\n    ripplesSpeed: { type: \"number\", default: 0.25 }\r\n  },\r\n\r\n  init() {\r\n    if (!waterNormalMap) {\r\n      waterNormalMap = new TextureLoader().load(waterNormalsUrl);\r\n    }\r\n    this.water = new SimpleWater(waterNormalMap, undefined, window.APP && window.APP.quality === \"low\");\r\n    this.el.setObject3D(\"mesh\", this.water);\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data.opacity !== oldData.opacity) {\r\n      this.water.opacity = this.data.opacity;\r\n    }\r\n\r\n    if (this.data.color !== oldData.color) {\r\n      this.water.color.set(this.data.color);\r\n    }\r\n\r\n    if (this.data.tideHeight !== oldData.tideHeight) {\r\n      this.water.tideHeight = this.data.tideHeight;\r\n    }\r\n\r\n    if (!vec2Equals(this.data.tideScale, oldData.tideScale)) {\r\n      this.water.tideScale.copy(this.data.tideScale);\r\n    }\r\n\r\n    if (!vec2Equals(this.data.tideSpeed, oldData.tideSpeed)) {\r\n      this.water.tideSpeed.copy(this.data.tideSpeed);\r\n    }\r\n\r\n    if (this.data.waveHeight !== oldData.waveHeight) {\r\n      this.water.waveHeight = this.data.waveHeight;\r\n    }\r\n\r\n    if (!vec2Equals(this.data.waveScale, oldData.waveScale)) {\r\n      this.water.waveScale.copy(this.data.waveScale);\r\n    }\r\n\r\n    if (!vec2Equals(this.data.waveSpeed, oldData.waveSpeed)) {\r\n      this.water.waveSpeed.copy(this.data.waveSpeed);\r\n    }\r\n\r\n    if (this.data.ripplesScale !== oldData.ripplesScale) {\r\n      this.water.ripplesScale = this.data.ripplesScale;\r\n    }\r\n\r\n    if (this.data.ripplesSpeed !== oldData.ripplesSpeed) {\r\n      this.water.ripplesSpeed = this.data.ripplesSpeed;\r\n    }\r\n  },\r\n\r\n  tick(time) {\r\n    this.water.update(time / 1000);\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeObject3D(\"mesh\");\r\n  }\r\n});\r\n","import { ParticleEmitter } from \"@mozillareality/three-particle-emitter\";\r\nimport { textureLoader } from \"../utils/media-utils\";\r\nimport { resolveUrl } from \"../utils/media-utils\";\r\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\r\nimport defaultSrcImage from \"../assets/images/warning_icon.png\";\r\n\r\nconst defaultSrcUrl = new URL(defaultSrcImage, window.location.href).href;\r\n\r\nAFRAME.registerComponent(\"particle-emitter\", {\r\n  schema: {\r\n    resolve: { type: \"boolean\", default: true },\r\n    src: { type: \"string\", default: defaultSrcUrl },\r\n    startColor: { type: \"color\" },\r\n    middleColor: { type: \"color\" },\r\n    endColor: { type: \"color\" },\r\n    startOpacity: { type: \"number\", default: 1 },\r\n    middleOpacity: { type: \"number\", default: 1 },\r\n    endOpacity: { type: \"number\", default: 1 },\r\n    colorCurve: { type: \"string\", default: \"linear\" },\r\n    sizeCurve: { type: \"string\", default: \"linear\" },\r\n    startSize: { type: \"number\", default: 1 },\r\n    endSize: { type: \"number\", default: 1 },\r\n    sizeRandomness: { type: \"number\" },\r\n    ageRandomness: { type: \"number\" },\r\n    lifetime: { type: \"number\", default: 1 },\r\n    lifetimeRandomness: { type: \"number\" },\r\n    particleCount: { type: \"number\", default: 10 },\r\n    startVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\r\n    endVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\r\n    velocityCurve: { type: \"string\", default: \"linear\" },\r\n    angularVelocity: { type: \"number\" }\r\n  },\r\n\r\n  init() {\r\n    this.particleEmitter = new ParticleEmitter(null);\r\n    this.particleEmitter.visible = false;\r\n    this.el.setObject3D(\"particle-emitter\", this.particleEmitter);\r\n    this.updateParticles = false;\r\n    if (this.data.src === defaultSrcUrl) {\r\n      this.data.resolve = false;\r\n    }\r\n  },\r\n\r\n  async setTexture(src, resolve) {\r\n    let accessibleUrl = src;\r\n\r\n    if (resolve) {\r\n      const result = await resolveUrl(src);\r\n      let canonicalUrl = result.origin;\r\n\r\n      // handle protocol relative urls\r\n      if (canonicalUrl.startsWith(\"//\")) {\r\n        canonicalUrl = location.protocol + canonicalUrl;\r\n      }\r\n\r\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\r\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\r\n    }\r\n\r\n    const texture = new THREE.Texture();\r\n\r\n    await textureLoader.loadTextureAsync(texture, accessibleUrl);\r\n\r\n    // Guard against src changing while request was in flight\r\n    if (this.data.src !== src) {\r\n      return;\r\n    }\r\n\r\n    this.particleEmitter.material.uniforms.map.value = texture;\r\n    this.particleEmitter.visible = true;\r\n    this.updateParticles = true;\r\n  },\r\n\r\n  update(prevData) {\r\n    const data = this.data;\r\n    const particleEmitter = this.particleEmitter;\r\n\r\n    if (prevData.src !== data.src) {\r\n      this.setTexture(data.src, data.resolve).catch(console.error);\r\n    }\r\n\r\n    if (\r\n      prevData.startColor !== data.startColor ||\r\n      prevData.startSize !== data.startSize ||\r\n      prevData.sizeRandomness !== data.sizeRandomness ||\r\n      prevData.ageRandomness !== data.ageRandomness ||\r\n      prevData.lifetime !== data.lifetime ||\r\n      prevData.lifetimeRandomness !== data.lifetimeRandomness ||\r\n      prevData.particleCount !== data.particleCount\r\n    ) {\r\n      this.updateParticles = true;\r\n    }\r\n\r\n    particleEmitter.startColor.set(data.startColor);\r\n    particleEmitter.middleColor.set(data.middleColor);\r\n    particleEmitter.endColor.set(data.endColor);\r\n    particleEmitter.startOpacity = data.startOpacity;\r\n    particleEmitter.middleOpacity = data.middleOpacity;\r\n    particleEmitter.endOpacity = data.endOpacity;\r\n    particleEmitter.colorCurve = data.colorCurve;\r\n    particleEmitter.sizeCurve = data.sizeCurve;\r\n    particleEmitter.startSize = data.startSize;\r\n    particleEmitter.endSize = data.endSize;\r\n    particleEmitter.sizeRandomness = data.sizeRandomness;\r\n    particleEmitter.ageRandomness = data.ageRandomness;\r\n    particleEmitter.lifetime = data.lifetime;\r\n    particleEmitter.lifetimeRandomness = data.lifetimeRandomness;\r\n    particleEmitter.particleCount = data.particleCount;\r\n    particleEmitter.startVelocity.copy(data.startVelocity);\r\n    particleEmitter.endVelocity.copy(data.endVelocity);\r\n    particleEmitter.velocityCurve = data.velocityCurve;\r\n    particleEmitter.angularVelocity = data.angularVelocity;\r\n  },\r\n\r\n  tick(time, dt) {\r\n    if (this.updateParticles) {\r\n      this.particleEmitter.updateParticles();\r\n      this.updateParticles = false;\r\n    }\r\n\r\n    if (this.particleEmitter.visible) {\r\n      this.particleEmitter.update(dt / 1000);\r\n    }\r\n  }\r\n});\r\n","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\r\n  const publicComponent = publicComponents[inputComponent];\r\n\r\n  if (!publicComponent) {\r\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\r\n  }\r\n\r\n  const publicProperty = publicComponent.publicProperties[inputProperty];\r\n\r\n  if (!publicProperty) {\r\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\r\n  }\r\n\r\n  return {\r\n    mappedComponent: publicComponent.mappedComponent,\r\n    mappedProperty: publicProperty.mappedProperty,\r\n    getMappedValue: publicProperty.getMappedValue\r\n  };\r\n}\r\n","import \"./components/gltf-model-plus\";\r\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\r\nimport { TYPE, SHAPE, FIT } from \"three-ammo/constants\";\r\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\r\n\r\nfunction registerRootSceneComponent(componentName) {\r\n  AFRAME.GLTFModelPlus.registerComponent(componentName, componentName, (el, componentName, componentData) => {\r\n    const sceneEl = AFRAME.scenes[0];\r\n\r\n    sceneEl.setAttribute(componentName, componentData);\r\n\r\n    sceneEl.addEventListener(\r\n      \"reset_scene\",\r\n      () => {\r\n        sceneEl.removeAttribute(componentName);\r\n      },\r\n      { once: true }\r\n    );\r\n  });\r\n}\r\n\r\nregisterRootSceneComponent(\"fog\");\r\nregisterRootSceneComponent(\"background\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\r\n  el.setAttribute(componentName, \"interactable\");\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\r\n  //TODO: Do not automatically add these components\r\n  el.setAttribute(\"is-remote-hover-target\", \"\");\r\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\r\n  el.setAttribute(\"hoverable-visuals\", \"\");\r\n  el.setAttribute(componentName, componentData);\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"body-helper\", el => {\r\n  //This is only required for migration of old environments with super-spawners\r\n  //will no longer be needed when spawners are added via Spoke instead.\r\n  el.setAttribute(\"body-helper\", {\r\n    mass: 0,\r\n    type: TYPE.STATIC,\r\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\r\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\r\n  });\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"shape-helper\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\r\n  if (componentData.distance === 0) {\r\n    componentData.decay = 0;\r\n  }\r\n  el.setAttribute(componentName, componentData);\r\n  if (componentData.castShadow) {\r\n    // HACK: component.light isn't set until one frame after setArrtibute\r\n    setTimeout(() => {\r\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\r\n    }, 0);\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"simple-water\", \"simple-water\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"morph-audio-feedback\", \"morph-audio-feedback\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\r\nAFRAME.GLTFModelPlus.registerComponent(\r\n  \"box-collider\",\r\n  \"shape-helper\",\r\n  (() => {\r\n    const euler = new THREE.Euler();\r\n    return (el, componentName, componentData) => {\r\n      const { scale, rotation } = componentData;\r\n      euler.set(rotation.x, rotation.y, rotation.z);\r\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\r\n      el.setAttribute(componentName, {\r\n        type: SHAPE.BOX,\r\n        fit: FIT.MANUAL,\r\n        offset: componentData.position,\r\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\r\n        orientation\r\n      });\r\n    };\r\n  })()\r\n);\r\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\r\n  if (typeof componentData === \"object\") {\r\n    el.setAttribute(componentName, componentData.visible);\r\n  } else {\r\n    el.setAttribute(componentName, componentData);\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\", el => {\r\n  el.setAttribute(\"waypoint\", {\r\n    canBeSpawnPoint: true,\r\n    canBeOccupied: false,\r\n    canBeClicked: false,\r\n    willDisableMotion: false,\r\n    willDisableTeleporting: false,\r\n    willMaintainWorldUp: true\r\n  });\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\r\n  const nav = AFRAME.scenes[0].systems.nav;\r\n  const zone = componentData.zone || \"character\";\r\n  let found = false;\r\n  el.object3D.traverse(node => {\r\n    if (node.isMesh && !found) {\r\n      found = true;\r\n      nav.loadMesh(node, zone);\r\n    }\r\n  });\r\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\r\n  // nav-mesh-helper will query for it later.\r\n  el.setAttribute(\"nav-mesh\");\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"waypoint\", \"waypoint\", (el, componentName, componentData, components) => {\r\n  if (componentData.canBeOccupied) {\r\n    el.setAttribute(\"networked\", {\r\n      template: \"#template-waypoint-avatar\",\r\n      attachTemplateToLocal: false,\r\n      owner: \"scene\",\r\n      persistent: true,\r\n      networkId: components.networked.id\r\n    });\r\n  }\r\n  el.setAttribute(\"waypoint\", componentData);\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\r\n  if (componentData.id) {\r\n    el.setAttribute(\"networked\", {\r\n      template: \"#interactable-media\",\r\n      owner: \"scene\",\r\n      persistent: true,\r\n      networkId: componentData.id\r\n    });\r\n  }\r\n\r\n  const mediaLoaderAttributes = {\r\n    src: componentData.src,\r\n    fitToBox: componentData.contentSubtype ? false : true,\r\n    resolve: true,\r\n    fileIsOwned: true,\r\n    animate: false,\r\n    contentSubtype: componentData.contentSubtype\r\n  };\r\n\r\n  if (componentData.version) {\r\n    mediaLoaderAttributes.version = componentData.version;\r\n  }\r\n\r\n  el.setAttribute(\"media-loader\", mediaLoaderAttributes);\r\n\r\n  if (componentData.pageIndex) {\r\n    el.setAttribute(\"media-pdf\", { index: componentData.pageIndex });\r\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\r\n  }\r\n\r\n  if (componentData.paused !== undefined) {\r\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\r\n  }\r\n\r\n  if (componentData.time) {\r\n    el.setAttribute(\"media-video\", { time: componentData.time });\r\n  }\r\n});\r\n\r\nasync function mediaInflator(el, componentName, componentData, components) {\r\n  let isControlled = true;\r\n\r\n  if (components.networked) {\r\n    isControlled = componentData.controls || componentName === \"link\";\r\n\r\n    const hasVolume = componentName === \"video\" || componentName === \"audio\";\r\n    const templateName = isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\r\n\r\n    el.setAttribute(\"networked\", {\r\n      template: templateName,\r\n      owner: \"scene\",\r\n      persistent: true,\r\n      networkId: components.networked.id\r\n    });\r\n  }\r\n\r\n  const mediaOptions = {};\r\n\r\n  if (componentName === \"video\" || componentName === \"image\") {\r\n    mediaOptions.projection = componentData.projection;\r\n  }\r\n\r\n  if (componentName === \"video\" || componentName === \"audio\") {\r\n    mediaOptions.videoPaused = !componentData.autoPlay;\r\n    mediaOptions.volume = componentData.volume;\r\n    mediaOptions.loop = componentData.loop;\r\n    mediaOptions.audioType = componentData.audioType;\r\n    mediaOptions.hidePlaybackControls = !isControlled;\r\n\r\n    if (componentData.audioType === \"pannernode\") {\r\n      mediaOptions.distanceModel = componentData.distanceModel;\r\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\r\n      mediaOptions.refDistance = componentData.refDistance;\r\n      mediaOptions.maxDistance = componentData.maxDistance;\r\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\r\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\r\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\r\n    }\r\n\r\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\r\n  }\r\n\r\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\r\n\r\n  el.setAttribute(\"media-loader\", {\r\n    src,\r\n    fitToBox: true,\r\n    resolve: true,\r\n    fileIsOwned: true,\r\n    animate: false,\r\n    mediaOptions\r\n  });\r\n}\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\r\nAFRAME.GLTFModelPlus.registerComponent(\"audio\", \"audio\", mediaInflator, (name, property, value) => {\r\n  if (property === \"paused\") {\r\n    return { name: \"video-pause-state\", property, value };\r\n  } else {\r\n    return null;\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\r\n  if (property === \"paused\") {\r\n    return { name: \"video-pause-state\", property, value };\r\n  } else {\r\n    return null;\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\r\n  el.setAttribute(\"is-remote-hover-target\", \"\");\r\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\r\n  el.setAttribute(\"media-loader\", {\r\n    src: componentData.src,\r\n    resolve: true,\r\n    fileIsOwned: true,\r\n    animate: false\r\n  });\r\n  el.setAttribute(\"css-class\", \"interactable\");\r\n  el.setAttribute(\"super-spawner\", {\r\n    src: componentData.src,\r\n    resolve: true,\r\n    template: \"#interactable-media\"\r\n  });\r\n  el.setAttribute(\"hoverable-visuals\", \"\");\r\n  el.setAttribute(\"body-helper\", {\r\n    mass: 0,\r\n    type: TYPE.STATIC,\r\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\r\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\r\n  });\r\n  el.setAttribute(\"is-remote-hover-target\", \"\");\r\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\r\n});\r\n\r\nconst publicComponents = {\r\n  video: {\r\n    mappedComponent: \"video-pause-state\",\r\n    publicProperties: {\r\n      paused: {\r\n        mappedProperty: \"paused\",\r\n        getMappedValue(value) {\r\n          return !!value;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"loop-animation\": {\r\n    mappedComponent: \"loop-animation\",\r\n    publicProperties: {\r\n      paused: {\r\n        mappedProperty: \"paused\",\r\n        getMappedValue(value) {\r\n          return !!value;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\r\n  \"trigger-volume\",\r\n  \"trigger-volume\",\r\n  (el, componentName, componentData, components, indexToEntityMap) => {\r\n    const {\r\n      size,\r\n      target,\r\n      enterComponent,\r\n      enterProperty,\r\n      enterValue,\r\n      leaveComponent,\r\n      leaveProperty,\r\n      leaveValue\r\n    } = componentData;\r\n\r\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\r\n\r\n    try {\r\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\r\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\r\n\r\n      targetEntity = indexToEntityMap[target];\r\n\r\n      if (!targetEntity) {\r\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\r\n      return;\r\n    }\r\n\r\n    // Filter out scope and colliders properties.\r\n    el.setAttribute(\"trigger-volume\", {\r\n      colliders: \"#avatar-pov-node\",\r\n      size,\r\n      target: targetEntity,\r\n      enterComponent: enterComponentMapping.mappedComponent,\r\n      enterProperty: enterComponentMapping.mappedProperty,\r\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\r\n      leaveComponent: leaveComponentMapping.mappedComponent,\r\n      leaveProperty: leaveComponentMapping.mappedProperty,\r\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\r\n    });\r\n  }\r\n);\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"heightfield\", \"heightfield\", (el, componentName, componentData) => {\r\n  el.setAttribute(\"shape-helper__heightfield\", {\r\n    type: SHAPE.HEIGHTFIELD,\r\n    margin: 0.01,\r\n    fit: FIT.MANUAL,\r\n    heightfieldDistance: componentData.distance,\r\n    offset: componentData.offset,\r\n    heightfieldData: componentData.data\r\n  });\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"trimesh\", \"trimesh\", el => {\r\n  el.setAttribute(\"shape-helper__trimesh\", {\r\n    type: SHAPE.MESH,\r\n    margin: 0.01,\r\n    fit: FIT.ALL,\r\n    includeInvisible: true\r\n  });\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"particle-emitter\", \"particle-emitter\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"networked-drawing-buffer\", \"networked-drawing-buffer\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"audio-settings\", \"audio-settings\", (el, _componentName, componentData) => {\r\n  el.sceneEl.systems[\"hubs-systems\"].audioSettingsSystem.updateAudioSettings(componentData);\r\n});\r\n","import appLogo from \"../assets/images/app-logo.png\";\r\nimport companyLogo from \"../assets/images/company-logo.png\";\r\nimport sceneEditorLogo from \"../assets/images/editor-logo.png\";\r\nimport pdfjs from \"pdfjs-dist\";\r\n\r\n// Read configs from global variable if available, otherwise use the process.env injected from build.\r\nconst configs = {};\r\nlet isAdmin = false;\r\n\r\n[\r\n  \"RETICULUM_SERVER\",\r\n  \"THUMBNAIL_SERVER\",\r\n  \"CORS_PROXY_SERVER\",\r\n  \"NON_CORS_PROXY_DOMAINS\",\r\n  \"SENTRY_DSN\",\r\n  \"GA_TRACKING_ID\",\r\n  \"SHORTLINK_DOMAIN\",\r\n  \"BASE_ASSETS_PATH\"\r\n].forEach(x => {\r\n  const el = document.querySelector(`meta[name='env:${x.toLowerCase()}']`);\r\n  configs[x] = el ? el.getAttribute(\"content\") : process.env[x];\r\n\r\n  if (x === \"BASE_ASSETS_PATH\" && configs[x]) {\r\n    // eslint-disable-next-line no-undef\r\n    __webpack_public_path__ = configs[x];\r\n\r\n    // Using external CDN to reduce build size\r\n    pdfjs.GlobalWorkerOptions.workerSrc = `${configs[x]}../assets/js/pdfjs-dist@2.1.266/build/pdf.worker.js`;\r\n  }\r\n});\r\n\r\n// Also include configs that reticulum injects as a script in the page head.\r\n\r\nconfigs.AVAILABLE_INTEGRATIONS = window.AVAILABLE_INTEGRATIONS || {};\r\n\r\nif (window.APP_CONFIG) {\r\n  configs.APP_CONFIG = window.APP_CONFIG;\r\n  const { theme } = configs.APP_CONFIG;\r\n  if (theme) {\r\n    const colorVars = [];\r\n    for (const key in theme) {\r\n      if (!theme.hasOwnProperty(key)) continue;\r\n      colorVars.push(`--${key}: ${theme[key]};`);\r\n    }\r\n    const style = document.createElement(\"style\");\r\n    style.innerHTML = `:root{${colorVars.join(\"\\n\")}}`;\r\n    document.head.prepend(style);\r\n  }\r\n\r\n  if (!configs.APP_CONFIG.features) {\r\n    configs.APP_CONFIG.features = {};\r\n  }\r\n} else {\r\n  configs.APP_CONFIG = {\r\n    features: {}\r\n  };\r\n}\r\n\r\nconst isLocalDevelopment = process.env.NODE_ENV === \"development\";\r\n\r\nconfigs.feature = featureName => {\r\n  const value = configs.APP_CONFIG.features[featureName];\r\n  if (typeof value === \"boolean\") {\r\n    const enableAll = isLocalDevelopment && !process.env.USE_FEATURE_CONFIG;\r\n    const forceEnableSpoke = featureName === \"enable_spoke\" && isAdmin;\r\n    return forceEnableSpoke || enableAll || value;\r\n  } else {\r\n    return value;\r\n  }\r\n};\r\n\r\nlet localDevImages = {};\r\nif (isLocalDevelopment) {\r\n  localDevImages = {\r\n    logo: appLogo,\r\n    company_logo: companyLogo,\r\n    editor_logo: sceneEditorLogo\r\n  };\r\n}\r\n\r\nconfigs.image = (imageName, cssUrl) => {\r\n  const url =\r\n    (configs.APP_CONFIG && configs.APP_CONFIG.images && configs.APP_CONFIG.images[imageName]) ||\r\n    localDevImages[imageName];\r\n  return url && cssUrl ? `url(${url})` : url;\r\n};\r\n\r\nconfigs.link = (linkName, defaultValue) => {\r\n  return (configs.APP_CONFIG && configs.APP_CONFIG.links && configs.APP_CONFIG.links[linkName]) || defaultValue;\r\n};\r\n\r\nconfigs.setIsAdmin = _isAdmin => {\r\n  isAdmin = _isAdmin;\r\n};\r\nconfigs.isAdmin = () => isAdmin;\r\n\r\nexport default configs;\r\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { childMatch, setMatrixWorld, calculateViewingDistance } from \"../utils/three-utils\";\r\nimport { paths } from \"./userinput/paths\";\r\nimport { getBox } from \"../utils/auto-box-collider\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\nconst enableThirdPersonMode = qsTruthy(\"thirdPerson\");\r\n\r\nexport function getInspectable(child) {\r\n  let el = child;\r\n  while (el) {\r\n    if (el.components && el.components.tags && el.components.tags.data.inspectable) return el;\r\n    el = el.parentNode;\r\n  }\r\n  return null;\r\n}\r\n\r\nconst decompose = (function() {\r\n  const scale = new THREE.Vector3();\r\n  return function decompose(m, p, q) {\r\n    m.decompose(p, q, scale); //ignore scale, like we're dealing with a motor\r\n  };\r\n})();\r\n\r\nconst IDENTITY = new THREE.Matrix4().identity();\r\nconst orbit = (function() {\r\n  const owq = new THREE.Quaternion();\r\n  const owp = new THREE.Vector3();\r\n  const cwq = new THREE.Quaternion();\r\n  const cwp = new THREE.Vector3();\r\n  const rwq = new THREE.Quaternion();\r\n  const UP = new THREE.Vector3();\r\n  const RIGHT = new THREE.Vector3();\r\n  const target = new THREE.Object3D();\r\n  const dhQ = new THREE.Quaternion();\r\n  const dvQ = new THREE.Quaternion();\r\n  return function orbit(object, rig, camera, dh, dv, dz, dt, panY) {\r\n    if (!target.parent) {\r\n      // add dummy object to the scene, if this is the first time we call this function\r\n      AFRAME.scenes[0].object3D.add(target);\r\n      target.applyMatrix(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\r\n    }\r\n    object.updateMatrices();\r\n    decompose(object.matrixWorld, owp, owq);\r\n    decompose(camera.matrixWorld, cwp, cwq);\r\n    rig.getWorldQuaternion(rwq);\r\n\r\n    dhQ.setFromAxisAngle(UP.set(0, 1, 0).applyQuaternion(owq), 0.1 * dh * dt);\r\n    target.quaternion.copy(cwq).premultiply(dhQ);\r\n    const dPos = new THREE.Vector3().subVectors(cwp, owp);\r\n    const zoom = 1 - dz * dt;\r\n    const newLength = dPos.length() * zoom;\r\n    // TODO: These limits should be calculated based on the calculated view distance.\r\n    if (newLength > 0.1 && newLength < 100) {\r\n      dPos.multiplyScalar(zoom);\r\n    }\r\n\r\n    dvQ.setFromAxisAngle(RIGHT.set(1, 0, 0).applyQuaternion(target.quaternion), 0.1 * dv * dt);\r\n    target.quaternion.premultiply(dvQ);\r\n    target.position.addVectors(owp, dPos.applyQuaternion(dhQ).applyQuaternion(dvQ)).add(\r\n      UP.set(0, 1, 0)\r\n        .multiplyScalar(panY * newLength)\r\n        .applyQuaternion(target.quaternion)\r\n    );\r\n    target.matrixNeedsUpdate = true;\r\n    target.updateMatrices();\r\n    childMatch(rig, camera, target.matrixWorld);\r\n  };\r\n})();\r\n\r\nconst moveRigSoCameraLooksAtObject = (function() {\r\n  const owq = new THREE.Quaternion();\r\n  const owp = new THREE.Vector3();\r\n  const cwq = new THREE.Quaternion();\r\n  const cwp = new THREE.Vector3();\r\n  const oForw = new THREE.Vector3();\r\n  const center = new THREE.Vector3();\r\n  const target = new THREE.Object3D();\r\n  return function moveRigSoCameraLooksAtObject(rig, camera, object, distanceMod) {\r\n    if (!target.parent) {\r\n      // add dummy object to the scene, if this is the first time we call this function\r\n      AFRAME.scenes[0].object3D.add(target);\r\n      target.applyMatrix(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\r\n    }\r\n\r\n    object.updateMatrices();\r\n    decompose(object.matrixWorld, owp, owq);\r\n    decompose(camera.matrixWorld, cwp, cwq);\r\n    rig.getWorldQuaternion(cwq);\r\n\r\n    const box = getBox(object.el, object.el.getObject3D(\"mesh\") || object, true);\r\n    box.getCenter(center);\r\n    const vrMode = object.el.sceneEl.is(\"vr-mode\");\r\n    const dist =\r\n      calculateViewingDistance(\r\n        object.el.sceneEl.camera.fov,\r\n        object.el.sceneEl.camera.aspect,\r\n        object,\r\n        box,\r\n        center,\r\n        vrMode\r\n      ) * distanceMod;\r\n    target.position.addVectors(\r\n      owp,\r\n      oForw\r\n        .set(0, 0, 1)\r\n        .multiplyScalar(dist)\r\n        .applyQuaternion(owq)\r\n    );\r\n    target.quaternion.copy(owq);\r\n    target.matrixNeedsUpdate = true;\r\n    target.updateMatrices();\r\n    childMatch(rig, camera, target.matrixWorld);\r\n  };\r\n})();\r\n\r\nexport const CAMERA_MODE_FIRST_PERSON = 0;\r\nexport const CAMERA_MODE_THIRD_PERSON_NEAR = 1;\r\nexport const CAMERA_MODE_THIRD_PERSON_FAR = 2;\r\nexport const CAMERA_MODE_INSPECT = 3;\r\nexport const CAMERA_MODE_SCENE_PREVIEW = 4;\r\n\r\nconst NEXT_MODES = {\r\n  [CAMERA_MODE_FIRST_PERSON]: CAMERA_MODE_THIRD_PERSON_NEAR,\r\n  [CAMERA_MODE_THIRD_PERSON_NEAR]: CAMERA_MODE_THIRD_PERSON_FAR,\r\n  [CAMERA_MODE_THIRD_PERSON_FAR]: CAMERA_MODE_FIRST_PERSON\r\n};\r\n\r\nconst CAMERA_LAYER_INSPECT = 4;\r\n// This layer is never actually rendered by a camera but lets the batching system know it should be rendered if inspecting\r\nexport const CAMERA_LAYER_BATCH_INSPECT = 5;\r\n\r\nconst ensureLightsAreSeenByCamera = function(o) {\r\n  if (o.isLight) {\r\n    o.layers.enable(CAMERA_LAYER_INSPECT);\r\n  }\r\n};\r\nconst enableInspectLayer = function(o) {\r\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\r\n  const batch = batchManagerSystem.batchManager.batchForMesh.get(o);\r\n  if (batch) {\r\n    batch.layers.enable(CAMERA_LAYER_INSPECT);\r\n    o.layers.enable(CAMERA_LAYER_BATCH_INSPECT);\r\n  } else {\r\n    o.layers.enable(CAMERA_LAYER_INSPECT);\r\n  }\r\n};\r\nconst disableInspectLayer = function(o) {\r\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\r\n  const batch = batchManagerSystem.batchManager.batchForMesh.get(o);\r\n  if (batch) {\r\n    batch.layers.disable(CAMERA_LAYER_INSPECT);\r\n    o.layers.disable(CAMERA_LAYER_BATCH_INSPECT);\r\n  } else {\r\n    o.layers.disable(CAMERA_LAYER_INSPECT);\r\n  }\r\n};\r\n\r\nfunction getAudio(o) {\r\n  let audio;\r\n  o.traverse(c => {\r\n    if (!audio && c.type === \"Audio\") {\r\n      audio = c;\r\n    }\r\n  });\r\n  return audio;\r\n}\r\n\r\nconst FALLOFF = 0.9;\r\nexport class CameraSystem {\r\n  constructor(batchManagerSystem) {\r\n    this.enableLights = localStorage.getItem(\"show-background-while-inspecting\") === \"true\";\r\n    this.verticalDelta = 0;\r\n    this.horizontalDelta = 0;\r\n    this.inspectZoom = 0;\r\n    this.batchManagerSystem = batchManagerSystem;\r\n    this.mode = CAMERA_MODE_SCENE_PREVIEW;\r\n    this.snapshot = { audioTransform: new THREE.Matrix4(), matrixWorld: new THREE.Matrix4() };\r\n    this.audioListenerTargetTransform = new THREE.Matrix4();\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.avatarPOV = document.getElementById(\"avatar-pov-node\");\r\n      this.avatarRig = document.getElementById(\"avatar-rig\");\r\n      this.viewingCamera = document.getElementById(\"viewing-camera\");\r\n      this.viewingRig = document.getElementById(\"viewing-rig\");\r\n\r\n      const bg = new THREE.Mesh(\r\n        new THREE.BoxGeometry(100, 100, 100),\r\n        new THREE.MeshBasicMaterial({ color: 0x020202, side: THREE.BackSide })\r\n      );\r\n      bg.layers.set(CAMERA_LAYER_INSPECT);\r\n      this.viewingRig.object3D.add(bg);\r\n    });\r\n  }\r\n\r\n  nextMode() {\r\n    if (this.mode === CAMERA_MODE_INSPECT) {\r\n      this.uninspect();\r\n      return;\r\n    }\r\n\r\n    if (!enableThirdPersonMode) return;\r\n    if (this.mode === CAMERA_MODE_SCENE_PREVIEW) return;\r\n\r\n    this.mode = NEXT_MODES[this.mode] || 0;\r\n    if (this.mode === CAMERA_MODE_FIRST_PERSON) {\r\n      AFRAME.scenes[0].renderer.vr.setPoseTarget(this.avatarPOV.object3D);\r\n    } else if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR || this.mode === CAMERA_MODE_THIRD_PERSON_FAR) {\r\n      AFRAME.scenes[0].renderer.vr.setPoseTarget(this.viewingCamera.object3D);\r\n    }\r\n  }\r\n\r\n  inspect(o, distanceMod, temporarilyDisableRegularExit) {\r\n    this.verticalDelta = 0;\r\n    this.horizontalDelta = 0;\r\n    this.inspectZoom = 0;\r\n    this.temporarilyDisableRegularExit = temporarilyDisableRegularExit; // TODO: Do this at the action set layer\r\n    if (this.mode === CAMERA_MODE_INSPECT) {\r\n      return;\r\n    }\r\n    const scene = AFRAME.scenes[0];\r\n    scene.object3D.traverse(ensureLightsAreSeenByCamera);\r\n    scene.classList.add(\"hand-cursor\");\r\n    scene.classList.remove(\"no-cursor\");\r\n    this.snapshot.mode = this.mode;\r\n    this.mode = CAMERA_MODE_INSPECT;\r\n    this.inspected = o;\r\n\r\n    const vrMode = scene.is(\"vr-mode\");\r\n    const camera = vrMode ? scene.renderer.vr.getCamera(scene.camera) : scene.camera;\r\n    this.snapshot.mask = camera.layers.mask;\r\n    if (vrMode) {\r\n      this.snapshot.mask0 = camera.cameras[0].layers.mask;\r\n      this.snapshot.mask1 = camera.cameras[1].layers.mask;\r\n    }\r\n    if (!this.enableLights) {\r\n      this.hideEverythingButThisObject(o);\r\n    }\r\n\r\n    this.viewingCamera.object3D.updateMatrices();\r\n    this.snapshot.matrixWorld.copy(this.viewingRig.object3D.matrixWorld);\r\n\r\n    moveRigSoCameraLooksAtObject(\r\n      this.viewingRig.object3D,\r\n      this.viewingCamera.object3D,\r\n      this.inspected,\r\n      distanceMod || 1\r\n    );\r\n\r\n    this.snapshot.audio = getAudio(o);\r\n    if (this.snapshot.audio) {\r\n      this.snapshot.audio.updateMatrices();\r\n      this.snapshot.audioTransform.copy(this.snapshot.audio.matrixWorld);\r\n      scene.audioListener.updateMatrices();\r\n      this.audioListenerTargetTransform.makeTranslation(0, 0, 1).premultiply(scene.audioListener.matrixWorld);\r\n      setMatrixWorld(this.snapshot.audio, this.audioListenerTargetTransform);\r\n    }\r\n  }\r\n\r\n  uninspect() {\r\n    this.temporarilyDisableRegularExit = false;\r\n    if (this.mode !== CAMERA_MODE_INSPECT) return;\r\n    const scene = AFRAME.scenes[0];\r\n    if (scene.is(\"entered\")) {\r\n      scene.classList.remove(\"hand-cursor\");\r\n      scene.classList.add(\"no-cursor\");\r\n    }\r\n    this.showEverythingAsNormal();\r\n    this.inspected = null;\r\n    if (this.snapshot.audio) {\r\n      setMatrixWorld(this.snapshot.audio, this.snapshot.audioTransform);\r\n      this.snapshot.audio = null;\r\n    }\r\n\r\n    this.mode = this.snapshot.mode;\r\n    if (this.snapshot.mode === CAMERA_MODE_SCENE_PREVIEW) {\r\n      setMatrixWorld(this.viewingRig.object3D, this.snapshot.matrixWorld);\r\n    }\r\n    this.snapshot.mode = null;\r\n    this.tick(AFRAME.scenes[0]);\r\n  }\r\n\r\n  hideEverythingButThisObject(o) {\r\n    o.traverse(enableInspectLayer);\r\n\r\n    const scene = AFRAME.scenes[0];\r\n    const vrMode = scene.is(\"vr-mode\");\r\n    const camera = vrMode ? scene.renderer.vr.getCamera(scene.camera) : scene.camera;\r\n    camera.layers.set(CAMERA_LAYER_INSPECT);\r\n    if (vrMode) {\r\n      camera.cameras[0].layers.set(CAMERA_LAYER_INSPECT);\r\n      camera.cameras[1].layers.set(CAMERA_LAYER_INSPECT);\r\n    }\r\n  }\r\n\r\n  showEverythingAsNormal() {\r\n    if (this.inspected) {\r\n      this.inspected.traverse(disableInspectLayer);\r\n    }\r\n    const scene = AFRAME.scenes[0];\r\n    const vrMode = scene.is(\"vr-mode\");\r\n    const camera = vrMode ? scene.renderer.vr.getCamera(scene.camera) : scene.camera;\r\n    camera.layers.mask = this.snapshot.mask;\r\n    if (vrMode) {\r\n      camera.cameras[0].layers.mask = this.snapshot.mask0;\r\n      camera.cameras[1].layers.mask = this.snapshot.mask1;\r\n    }\r\n  }\r\n\r\n  tick = (function() {\r\n    const translation = new THREE.Matrix4();\r\n    return function tick(scene, dt) {\r\n      if (!this.enteredScene && scene.is(\"entered\")) {\r\n        this.enteredScene = true;\r\n        this.mode = CAMERA_MODE_FIRST_PERSON;\r\n      }\r\n      this.avatarPOVRotator = this.avatarPOVRotator || this.avatarPOV.components[\"pitch-yaw-rotator\"];\r\n      this.viewingCameraRotator = this.viewingCameraRotator || this.viewingCamera.components[\"pitch-yaw-rotator\"];\r\n      this.avatarPOVRotator.on = true;\r\n      this.viewingCameraRotator.on = true;\r\n\r\n      this.userinput = this.userinput || scene.systems.userinput;\r\n      this.interaction = this.interaction || scene.systems.interaction;\r\n\r\n      if (this.userinput.get(paths.actions.startInspecting) && this.mode !== CAMERA_MODE_INSPECT) {\r\n        const hoverEl = this.interaction.state.rightRemote.hovered || this.interaction.state.leftRemote.hovered;\r\n\r\n        if (hoverEl) {\r\n          const inspectable = getInspectable(hoverEl);\r\n\r\n          if (inspectable) {\r\n            this.inspect(inspectable.object3D);\r\n          }\r\n        }\r\n      } else if (\r\n        !this.temporarilyDisableRegularExit &&\r\n        this.mode === CAMERA_MODE_INSPECT &&\r\n        this.userinput.get(paths.actions.stopInspecting)\r\n      ) {\r\n        scene.emit(\"uninspect\");\r\n        this.uninspect();\r\n      }\r\n\r\n      if (this.userinput.get(paths.actions.nextCameraMode)) {\r\n        this.nextMode();\r\n      }\r\n\r\n      const headShouldBeVisible = this.mode !== CAMERA_MODE_FIRST_PERSON;\r\n      this.playerHead = this.playerHead || document.getElementById(\"avatar-head\");\r\n      if (this.playerHead && headShouldBeVisible !== this.playerHead.object3D.visible) {\r\n        this.playerHead.object3D.visible = headShouldBeVisible;\r\n\r\n        // Skip a frame so we don't see our own avatar, etc.\r\n        return;\r\n      }\r\n\r\n      if (this.mode === CAMERA_MODE_FIRST_PERSON) {\r\n        this.viewingCameraRotator.on = false;\r\n        this.avatarRig.object3D.updateMatrices();\r\n        setMatrixWorld(this.viewingRig.object3D, this.avatarRig.object3D.matrixWorld);\r\n        if (scene.is(\"vr-mode\")) {\r\n          this.viewingCamera.object3D.updateMatrices();\r\n          setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.object3D.matrixWorld);\r\n        } else {\r\n          this.avatarPOV.object3D.updateMatrices();\r\n          setMatrixWorld(this.viewingCamera.object3D, this.avatarPOV.object3D.matrixWorld);\r\n        }\r\n      } else if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR || this.mode === CAMERA_MODE_THIRD_PERSON_FAR) {\r\n        if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR) {\r\n          translation.makeTranslation(0, 1, 3);\r\n        } else {\r\n          translation.makeTranslation(0, 2, 8);\r\n        }\r\n        this.avatarRig.object3D.updateMatrices();\r\n        this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld).multiply(translation);\r\n        setMatrixWorld(this.viewingRig.object3D, this.viewingRig.object3D.matrixWorld);\r\n        this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.object3D.quaternion);\r\n        this.avatarPOV.object3D.matrixNeedsUpdate = true;\r\n      } else if (this.mode === CAMERA_MODE_INSPECT) {\r\n        this.avatarPOVRotator.on = false;\r\n        this.viewingCameraRotator.on = false;\r\n        const cameraDelta = this.userinput.get(\r\n          scene.is(\"entered\") ? paths.actions.cameraDelta : paths.actions.lobbyCameraDelta\r\n        );\r\n\r\n        if (cameraDelta) {\r\n          // TODO: Move device specific tinkering to action sets\r\n          const horizontalDelta = (AFRAME.utils.device.isMobile() ? -0.6 : 1) * cameraDelta[0] || 0;\r\n          const verticalDelta = (AFRAME.utils.device.isMobile() ? -1.2 : 1) * cameraDelta[1] || 0;\r\n          this.horizontalDelta = (this.horizontalDelta + horizontalDelta) / 2;\r\n          this.verticalDelta = (this.verticalDelta + verticalDelta) / 2;\r\n        } else if (Math.abs(this.verticalDelta) > 0.0001 || Math.abs(this.horizontalDelta) > 0.0001) {\r\n          this.verticalDelta = FALLOFF * this.verticalDelta;\r\n          this.horizontalDelta = FALLOFF * this.horizontalDelta;\r\n        }\r\n\r\n        const inspectZoom = this.userinput.get(paths.actions.inspectZoom) * 0.001;\r\n        if (inspectZoom) {\r\n          this.inspectZoom = inspectZoom + (5 * this.inspectZoom) / 6;\r\n        } else if (Math.abs(this.inspectZoom) > 0.0001) {\r\n          this.inspectZoom = FALLOFF * this.inspectZoom;\r\n        }\r\n        const panY = this.userinput.get(paths.actions.inspectPanY) || 0;\r\n        if (this.userinput.get(paths.actions.resetInspectView)) {\r\n          moveRigSoCameraLooksAtObject(this.viewingRig.object3D, this.viewingCamera.object3D, this.inspected, 1);\r\n        }\r\n\r\n        if (\r\n          Math.abs(this.verticalDelta) > 0.001 ||\r\n          Math.abs(this.horizontalDelta) > 0.001 ||\r\n          Math.abs(this.inspectZoom) > 0.001 ||\r\n          Math.abs(panY) > 0.0001\r\n        ) {\r\n          orbit(\r\n            this.inspected,\r\n            this.viewingRig.object3D,\r\n            this.viewingCamera.object3D,\r\n            this.horizontalDelta,\r\n            this.verticalDelta,\r\n            this.inspectZoom,\r\n            dt,\r\n            panY\r\n          );\r\n        }\r\n      }\r\n\r\n      if (scene.audioListener && this.avatarPOV) {\r\n        if (\r\n          (this.mode === CAMERA_MODE_FIRST_PERSON || this.mode === CAMERA_MODE_INSPECT) &&\r\n          scene.audioListener.parent !== this.avatarPOV.object3D\r\n        ) {\r\n          this.avatarPOV.object3D.add(scene.audioListener);\r\n        } else if (\r\n          (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR || this.mode === CAMERA_MODE_THIRD_PERSON_FAR) &&\r\n          scene.audioListener.parent !== this.viewingCamera.object3D\r\n        ) {\r\n          this.viewingCamera.object3D.add(scene.audioListener);\r\n        }\r\n      }\r\n    };\r\n  })();\r\n}\r\n","export function forEachMaterial(object3D, fn) {\r\n  if (!object3D.material) return;\r\n\r\n  if (Array.isArray(object3D.material)) {\r\n    object3D.material.forEach(fn);\r\n  } else {\r\n    fn(object3D.material);\r\n  }\r\n}\r\n\r\nexport function mapMaterials(object3D, fn) {\r\n  if (!object3D.material) return;\r\n\r\n  if (Array.isArray(object3D.material)) {\r\n    return object3D.material.map(fn);\r\n  } else {\r\n    return fn(object3D.material);\r\n  }\r\n}\r\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\r\nimport ducky from \"../assets/models/DuckyMesh.glb\";\r\n\r\nconst names = [\r\n  \"Baers-Pochard\",\r\n  \"Baikal-Teal\",\r\n  \"Barrows-Goldeneye\",\r\n  \"Blue-Billed\",\r\n  \"Blue-Duck\",\r\n  \"Blue-Winged\",\r\n  \"Brown-Teal\",\r\n  \"Bufflehead\",\r\n  \"Canvasback\",\r\n  \"Cape-Shoveler\",\r\n  \"Chestnut-Teal\",\r\n  \"Chiloe-Wigeon\",\r\n  \"Cinnamon-Teal\",\r\n  \"Comb-Duck\",\r\n  \"Common-Eider\",\r\n  \"Common-Goldeneye\",\r\n  \"Common-Merganser\",\r\n  \"Common-Pochard\",\r\n  \"Common-Scoter\",\r\n  \"Common-Shelduck\",\r\n  \"Cotton-Pygmy\",\r\n  \"Crested-Duck\",\r\n  \"Crested-Shelduck\",\r\n  \"Eatons-Pintail\",\r\n  \"Falcated\",\r\n  \"Ferruginous\",\r\n  \"Freckled-Duck\",\r\n  \"Gadwall\",\r\n  \"Garganey\",\r\n  \"Greater-Scaup\",\r\n  \"Green-Pygmy\",\r\n  \"Grey-Teal\",\r\n  \"Hardhead\",\r\n  \"Harlequin\",\r\n  \"Hartlaubs\",\r\n  \"Hooded-Merganser\",\r\n  \"Hottentot-Teal\",\r\n  \"Kelp-Goose\",\r\n  \"King-Eider\",\r\n  \"Lake-Duck\",\r\n  \"Laysan-Duck\",\r\n  \"Lesser-Scaup\",\r\n  \"Long-Tailed\",\r\n  \"Maccoa-Duck\",\r\n  \"Mallard\",\r\n  \"Mandarin\",\r\n  \"Marbled-Teal\",\r\n  \"Mellers-Duck\",\r\n  \"Merganser\",\r\n  \"Northern-Pintail\",\r\n  \"Orinoco-Goose\",\r\n  \"Paradise-Shelduck\",\r\n  \"Plumed-Whistler\",\r\n  \"Puna-Teal\",\r\n  \"Pygmy-Goose\",\r\n  \"Radjah-Shelduck\",\r\n  \"Red-Billed\",\r\n  \"Red-Crested\",\r\n  \"Red-Shoveler\",\r\n  \"Ring-Necked\",\r\n  \"Ringed-Teal\",\r\n  \"Rosy-Billed\",\r\n  \"Ruddy-Shelduck\",\r\n  \"Salvadoris-Teal\",\r\n  \"Scaly-Sided\",\r\n  \"Shelduck\",\r\n  \"Shoveler\",\r\n  \"Silver-Teal\",\r\n  \"Smew\",\r\n  \"Spectacled-Eider\",\r\n  \"Spot-Billed\",\r\n  \"Spotted-Whistler\",\r\n  \"Steamerduck\",\r\n  \"Stellers-Eider\",\r\n  \"Sunda-Teal\",\r\n  \"Surf-Scoter\",\r\n  \"Tufted-Duck\",\r\n  \"Velvet-Scoter\",\r\n  \"Wandering-Whistler\",\r\n  \"Whistling-duck\",\r\n  \"White-Backed\",\r\n  \"White-Cheeked\",\r\n  \"White-Winged\",\r\n  \"Wigeon\",\r\n  \"Wood-Duck\",\r\n  \"Yellow-Billed\"\r\n];\r\n\r\nfunction chooseRandom(arr) {\r\n  return arr[Math.floor(Math.random() * arr.length)];\r\n}\r\n\r\nexport function generateRandomName() {\r\n  return `${chooseRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\r\n}\r\n\r\nexport async function fetchRandomDefaultAvatarId() {\r\n  const defaultAvatarEndpoint = \"/api/v1/media/search?filter=default&source=avatar_listings\";\r\n  const defaultAvatars = (await fetchReticulumAuthenticated(defaultAvatarEndpoint)).entries;\r\n  if (defaultAvatars.length === 0) {\r\n    // If reticulum doesn't return any default avatars, just default to the duck model. This should only happen\r\n    // when running against a fresh reticulum server, e.g. a local ret instance.\r\n    return new URL(ducky, location.href).href;\r\n  }\r\n  const avatarIds = defaultAvatars.map(avatar => avatar.id);\r\n  return chooseRandom(avatarIds);\r\n}\r\n","import { Validator } from \"jsonschema\";\r\nimport merge from \"deepmerge\";\r\nimport Cookies from \"js-cookie\";\r\nimport jwtDecode from \"jwt-decode\";\r\n\r\nconst LOCAL_STORE_KEY = \"___hubs_store\";\r\nconst STORE_STATE_CACHE_KEY = Symbol();\r\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\r\nconst validator = new Validator();\r\nimport { EventTarget } from \"event-target-shim\";\r\nimport { fetchRandomDefaultAvatarId, generateRandomName } from \"../utils/identity.js\";\r\n\r\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\r\n// (Think flux but with way less incidental complexity, at least for now :))\r\nexport const SCHEMA = {\r\n  id: \"/HubsStore\",\r\n\r\n  definitions: {\r\n    profile: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9 -]{3,32}$\" },\r\n        avatarId: { type: \"string\" },\r\n        // personalAvatarId is obsolete, but we need it here for backwards compatibility.\r\n        personalAvatarId: { type: \"string\" }\r\n      }\r\n    },\r\n\r\n    credentials: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        token: { type: [\"null\", \"string\"] },\r\n        email: { type: [\"null\", \"string\"] }\r\n      }\r\n    },\r\n\r\n    activity: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        hasFoundFreeze: { type: \"boolean\" },\r\n        hasChangedName: { type: \"boolean\" },\r\n        hasAcceptedProfile: { type: \"boolean\" },\r\n        lastEnteredAt: { type: \"string\" },\r\n        hasPinned: { type: \"boolean\" },\r\n        hasRotated: { type: \"boolean\" },\r\n        hasRecentered: { type: \"boolean\" },\r\n        hasScaled: { type: \"boolean\" },\r\n        hasHoveredInWorldHud: { type: \"boolean\" },\r\n        hasOpenedShare: { type: \"boolean\" },\r\n        entryCount: { type: \"number\" }\r\n      }\r\n    },\r\n\r\n    settings: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        lastUsedMicDeviceId: { type: \"string\" }\r\n      }\r\n    },\r\n\r\n    preferences: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        muteMicOnEntry: { type: \"bool\" },\r\n        enableOnScreenJoystickLeft: { type: \"bool\" },\r\n        enableOnScreenJoystickRight: { type: \"bool\" },\r\n        onlyShowNametagsInFreeze: { type: \"bool\" },\r\n        allowMultipleHubsInstances: { type: \"bool\" },\r\n        maxResolutionWidth: { type: \"number\" },\r\n        maxResolutionHeight: { type: \"number\" },\r\n        globalVoiceVolume: { type: \"number\" },\r\n        globalMediaVolume: { type: \"number\" },\r\n        snapRotationDegrees: { type: \"number\" },\r\n        materialQualitySetting: { type: \"string\" },\r\n        disableMovement: { type: \"bool\" },\r\n        disableBackwardsMovement: { type: \"bool\" },\r\n        disableStrafing: { type: \"bool\" },\r\n        disableTeleporter: { type: \"bool\" }\r\n      }\r\n    },\r\n\r\n    // Legacy\r\n    confirmedDiscordRooms: {\r\n      type: \"array\",\r\n      items: { type: \"string\" }\r\n    },\r\n\r\n    confirmedBroadcastedRooms: {\r\n      type: \"array\",\r\n      items: { type: \"string\" }\r\n    },\r\n\r\n    uploadPromotionTokens: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          fileId: { type: \"string\" },\r\n          promotionToken: { type: \"string\" }\r\n        }\r\n      }\r\n    },\r\n\r\n    creatorAssignmentTokens: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          hubId: { type: \"string\" },\r\n          creatorAssignmentToken: { type: \"string\" }\r\n        }\r\n      }\r\n    },\r\n\r\n    embedTokens: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          hubId: { type: \"string\" },\r\n          embedToken: { type: \"string\" }\r\n        }\r\n      }\r\n    },\r\n\r\n    onLoadActions: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          action: { type: \"string\" },\r\n          args: { type: \"object\" }\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  type: \"object\",\r\n\r\n  properties: {\r\n    profile: { $ref: \"#/definitions/profile\" },\r\n    credentials: { $ref: \"#/definitions/credentials\" },\r\n    activity: { $ref: \"#/definitions/activity\" },\r\n    settings: { $ref: \"#/definitions/settings\" },\r\n    preferences: { $ref: \"#/definitions/preferences\" },\r\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\r\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\r\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\r\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\r\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\r\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\r\n  },\r\n\r\n  additionalProperties: false\r\n};\r\n\r\nexport default class Store extends EventTarget {\r\n  constructor() {\r\n    super();\r\n\r\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\r\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\r\n    }\r\n\r\n    // When storage is updated in another window\r\n    window.addEventListener(\"storage\", e => {\r\n      if (e.key !== LOCAL_STORE_KEY) return;\r\n      delete this[STORE_STATE_CACHE_KEY];\r\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n    });\r\n\r\n    this.update({\r\n      activity: {},\r\n      settings: {},\r\n      credentials: {},\r\n      profile: {},\r\n      confirmedDiscordRooms: [],\r\n      confirmedBroadcastedRooms: [],\r\n      uploadPromotionTokens: [],\r\n      creatorAssignmentTokens: [],\r\n      embedTokens: [],\r\n      onLoadActions: [],\r\n      preferences: {}\r\n    });\r\n\r\n    this._shouldResetAvatarOnInit = false;\r\n\r\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\r\n    if (oauthFlowCredentials) {\r\n      this.update({ credentials: oauthFlowCredentials });\r\n      this._shouldResetAvatarOnInit = true;\r\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\r\n    }\r\n\r\n    this._signOutOnExpiredAuthToken();\r\n  }\r\n\r\n  _signOutOnExpiredAuthToken = () => {\r\n    if (!this.state.credentials.token) return;\r\n\r\n    const expiry = jwtDecode(this.state.credentials.token).exp * 1000;\r\n    if (expiry <= Date.now()) {\r\n      this.update({ credentials: { token: null, email: null } });\r\n    }\r\n  };\r\n\r\n  initProfile = async () => {\r\n    if (this._shouldResetAvatarOnInit) {\r\n      await this.resetToRandomDefaultAvatar();\r\n    } else {\r\n      this.update({\r\n        profile: { avatarId: await fetchRandomDefaultAvatarId(), ...(this.state.profile || {}) }\r\n      });\r\n    }\r\n\r\n    // Regenerate name to encourage users to change it.\r\n    if (!this.state.activity.hasChangedName) {\r\n      this.update({ profile: { displayName: generateRandomName() } });\r\n    }\r\n  };\r\n\r\n  resetToRandomDefaultAvatar = async () => {\r\n    this.update({\r\n      profile: { ...(this.state.profile || {}), avatarId: await fetchRandomDefaultAvatarId() }\r\n    });\r\n  };\r\n\r\n  get state() {\r\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\r\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\r\n    }\r\n\r\n    return this[STORE_STATE_CACHE_KEY];\r\n  }\r\n\r\n  get credentialsAccountId() {\r\n    if (this.state.credentials.token) {\r\n      return jwtDecode(this.state.credentials.token).sub;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  resetConfirmedBroadcastedRooms() {\r\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\r\n  }\r\n\r\n  resetTipActivityFlags() {\r\n    this.update({\r\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\r\n    });\r\n  }\r\n\r\n  bumpEntryCount() {\r\n    const currentEntryCount = this.state.activity.entryCount || 0;\r\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\r\n  }\r\n\r\n  // Sets a one-time action to perform the next time the page loads\r\n  enqueueOnLoadAction(action, args) {\r\n    this.update({ onLoadActions: [{ action, args }] });\r\n  }\r\n\r\n  executeOnLoadActions(sceneEl) {\r\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\r\n      const { action, args } = this.state.onLoadActions[i];\r\n\r\n      if (action === \"emit_scene_event\") {\r\n        sceneEl.emit(args.event, args.detail);\r\n      }\r\n    }\r\n\r\n    this.clearOnLoadActions();\r\n  }\r\n\r\n  clearOnLoadActions() {\r\n    this.clearStoredArray(\"onLoadActions\");\r\n  }\r\n\r\n  clearStoredArray(key) {\r\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\r\n    const update = {};\r\n    update[key] = [];\r\n\r\n    this.update(update, { arrayMerge: overwriteMerge });\r\n  }\r\n\r\n  update(newState, mergeOpts) {\r\n    const finalState = merge(this.state, newState, mergeOpts);\r\n    const { valid } = validator.validate(finalState, SCHEMA);\r\n\r\n    if (!valid) {\r\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\r\n      // sensitive data in the error message.\r\n      throw new Error(`Write to store failed schema validation.`);\r\n    }\r\n\r\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\r\n    delete this[STORE_STATE_CACHE_KEY];\r\n\r\n    if (newState.profile !== undefined) {\r\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\r\n    }\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n\r\n    return finalState;\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/images/app-logo-157c06cff6c80227eb577f35c79e58b6.png\";","module.exports = __webpack_public_path__ + \"assets/images/company-logo-8f6f7c3b303004256295b45c2eee5117.png\";","module.exports = __webpack_public_path__ + \"assets/images/editor-logo-6f885a1543496ebc23a21b7fea82b255.png\";","// Brief overview of client authorization can be found in the wiki:\r\n// https://github.com/mozilla/hubs/wiki/Hubs-authorization\r\nexport function showHoverEffect(el) {\r\n  const isFrozen = el.sceneEl.is(\"frozen\");\r\n  const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\r\n  const isSpawner = !!el.components[\"super-spawner\"];\r\n  const canMove =\r\n    window.APP.hubChannel.can(\"spawn_and_move_media\") && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\r\n  return (isSpawner || !isPinned || isFrozen) && canMove;\r\n}\r\n\r\nexport function canMove(entity) {\r\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\r\n  const networkedTemplate = entity && entity.components.networked && entity.components.networked.data.template;\r\n  const isCamera = networkedTemplate === \"#interactable-camera\";\r\n  const isPen = networkedTemplate === \"#interactable-pen\";\r\n  const isHoldableButton = entity.components.tags && entity.components.tags.data.holdableButton;\r\n  return (\r\n    isHoldableButton ||\r\n    (window.APP.hubChannel.can(\"spawn_and_move_media\") &&\r\n      (!isPinned || window.APP.hubChannel.can(\"pin_objects\")) &&\r\n      (!isCamera || window.APP.hubChannel.can(\"spawn_camera\")) &&\r\n      (!isPen || window.APP.hubChannel.can(\"spawn_drawing\")))\r\n  );\r\n}\r\n\r\nfunction indexForComponent(component, schema) {\r\n  const fullComponent = typeof component === \"string\";\r\n  const componentName = fullComponent ? component : component.component;\r\n\r\n  if (fullComponent) {\r\n    return schema.components.findIndex(schemaComponent => schemaComponent === componentName);\r\n  } else {\r\n    return schema.components.findIndex(\r\n      schemaComponent => schemaComponent.component === componentName && schemaComponent.property === component.property\r\n    );\r\n  }\r\n}\r\n\r\nlet nonAuthorizedSchemas = null;\r\nfunction initializeNonAuthorizedSchemas() {\r\n  /*\r\n  Takes the NAF schemas defined in network-schemas.js and produces a data structure of template name to non-authorized\r\n  component indices:\r\n  {\r\n    \"#interactable-media\": [\"4\", \"5\", \"6\"]\r\n  }\r\n  */\r\n  nonAuthorizedSchemas = {};\r\n  const { schemaDict } = NAF.schemas;\r\n  for (const template in schemaDict) {\r\n    if (!schemaDict.hasOwnProperty(template)) continue;\r\n    const schema = schemaDict[template];\r\n    nonAuthorizedSchemas[template] = (schema.nonAuthorizedComponents || [])\r\n      .map(nonAuthorizedComponent => indexForComponent(nonAuthorizedComponent, schema))\r\n      .map(index => index.toString());\r\n  }\r\n}\r\n\r\nfunction sanitizeMessageData(template, data) {\r\n  if (nonAuthorizedSchemas === null) {\r\n    initializeNonAuthorizedSchemas();\r\n  }\r\n  const nonAuthorizedIndices = nonAuthorizedSchemas[template];\r\n  for (const index in data.components) {\r\n    if (!data.components.hasOwnProperty(index)) continue;\r\n    if (!nonAuthorizedIndices.includes(index)) {\r\n      data.components[index] = null;\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nfunction authorizeEntityManipulation(entityMetadata, sender, senderPermissions) {\r\n  const { template, creator, isPinned } = entityMetadata;\r\n  const isCreator = sender === creator;\r\n\r\n  if (template.endsWith(\"-waypoint-avatar\")) {\r\n    return true;\r\n  } else if (template.endsWith(\"-avatar\")) {\r\n    return isCreator;\r\n  } else if (template.endsWith(\"-media\")) {\r\n    return (!isPinned || senderPermissions.pin_objects) && (isCreator || senderPermissions.spawn_and_move_media);\r\n  } else if (template.endsWith(\"-camera\")) {\r\n    return isCreator || senderPermissions.spawn_camera;\r\n  } else if (template.endsWith(\"-pen\") || template.endsWith(\"-drawing\")) {\r\n    return isCreator || senderPermissions.spawn_drawing;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction getPendingOrExistingEntityMetadata(networkId) {\r\n  const pendingData = NAF.connection.adapter.getPendingDataForNetworkId(networkId);\r\n\r\n  if (pendingData) {\r\n    const { template, creator } = pendingData;\r\n    const schema = NAF.schemas.schemaDict[template];\r\n    const pinnableComponent = pendingData.components[indexForComponent(\"pinnable\", schema)];\r\n    const isPinned = pinnableComponent && pinnableComponent.pinned;\r\n    return { template, creator, isPinned };\r\n  }\r\n\r\n  const entity = NAF.entities.getEntity(networkId);\r\n  if (!entity) return null;\r\n\r\n  const { template, creator } = entity.components.networked.data;\r\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\r\n  return { template, creator, isPinned };\r\n}\r\n\r\nfunction authorizeOrSanitizeMessageData(data, sender, senderPermissions) {\r\n  const entityMetadata = getPendingOrExistingEntityMetadata(data.networkId);\r\n  if (!entityMetadata) return false;\r\n\r\n  if (authorizeEntityManipulation(entityMetadata, sender, senderPermissions)) {\r\n    return true;\r\n  } else {\r\n    const { template } = entityMetadata;\r\n    sanitizeMessageData(template, data);\r\n    return true;\r\n  }\r\n}\r\n\r\n// If we receive a sync from a persistent object that we don't have an entity for yet, it must be a scene-owned object\r\n// (since we guarantee that pinned objects are loaded before connecting NAF).\r\n// Since we need to get metadata (the template id in particular) from the entity, we must stash these messages until\r\n// the scene has loaded.\r\n// Components which require this data must call applyPersistentSync after they are initialized\r\nconst persistentSyncs = {};\r\nfunction stashPersistentSync(message, entityData) {\r\n  if (!persistentSyncs[entityData.networkId]) {\r\n    persistentSyncs[entityData.networkId] = {\r\n      dataType: \"u\",\r\n      data: entityData,\r\n      clientId: message.clientId,\r\n      from_session_id: message.from_session_id\r\n    };\r\n  } else {\r\n    const currentData = persistentSyncs[entityData.networkId].data;\r\n    const currentComponents = currentData.components;\r\n    Object.assign(currentData, entityData);\r\n    currentData.components = Object.assign(currentComponents, entityData.components);\r\n  }\r\n}\r\n\r\nconst emptyObject = {};\r\nexport function authorizeOrSanitizeMessage(message) {\r\n  const { dataType, from_session_id } = message;\r\n\r\n  if (dataType === \"u\" && message.data.isFirstSync && !message.data.persistent) {\r\n    // The server has already authorized first sync messages that result in an instantiation.\r\n    return message;\r\n  }\r\n\r\n  const presenceState = window.APP.hubChannel.presence.state[from_session_id];\r\n\r\n  if (!presenceState) {\r\n    // We've received a manipulation message from a user that we don't have presence state for yet.\r\n    // Since we can't make a judgement about their permissions, we'll have to ignore the message.\r\n    return emptyObject;\r\n  }\r\n\r\n  const senderPermissions = presenceState.metas[0].permissions;\r\n\r\n  if (dataType === \"um\") {\r\n    let sanitizedAny = false;\r\n    let stashedAny = false;\r\n    for (const index in message.data.d) {\r\n      if (!message.data.d.hasOwnProperty(index)) continue;\r\n      const entityData = message.data.d[index];\r\n      if (entityData.persistent && !NAF.entities.getEntity(entityData.networkId)) {\r\n        stashPersistentSync(message, entityData);\r\n        message.data.d[index] = null;\r\n        stashedAny = true;\r\n      } else {\r\n        const authorizedOrSanitized = authorizeOrSanitizeMessageData(entityData, from_session_id, senderPermissions);\r\n        if (!authorizedOrSanitized) {\r\n          message.data.d[index] = null;\r\n          sanitizedAny = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (sanitizedAny || stashedAny) {\r\n      message.data.d = message.data.d.filter(x => x != null);\r\n    }\r\n\r\n    return message;\r\n  } else if (dataType === \"u\") {\r\n    if (message.data.persistent && !NAF.entities.getEntity(message.data.networkId)) {\r\n      persistentSyncs[message.data.networkId] = message;\r\n      return emptyObject;\r\n    } else {\r\n      const authorizedOrSanitized = authorizeOrSanitizeMessageData(message.data, from_session_id, senderPermissions);\r\n      if (authorizedOrSanitized) {\r\n        return message;\r\n      } else {\r\n        return emptyObject;\r\n      }\r\n    }\r\n  } else if (dataType === \"r\") {\r\n    const entityMetadata = getPendingOrExistingEntityMetadata(message.data.networkId);\r\n    if (!entityMetadata) return emptyObject;\r\n    if (authorizeEntityManipulation(entityMetadata, from_session_id, senderPermissions)) {\r\n      return message;\r\n    } else {\r\n      return emptyObject;\r\n    }\r\n  } else {\r\n    // Fall through for other data types. Namely, \"drawing-<networkId>\" messages at the moment.\r\n    return message;\r\n  }\r\n}\r\n\r\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\r\nexport function applyPersistentSync(networkId) {\r\n  if (!persistentSyncs[networkId]) return;\r\n  NAF.connection.adapter.onData(authorizeOrSanitizeMessage(persistentSyncs[networkId]), PHOENIX_RELIABLE_NAF);\r\n  delete persistentSyncs[networkId];\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"spokeButton\":\"scene-ui__spokeButton__1aYS3\",\"tweetButton\":\"scene-ui__tweetButton__2bktg\",\"createButton\":\"scene-ui__createButton__3SFiS\",\"optionsButton\":\"scene-ui__optionsButton__1z7or\",\"ui\":\"scene-ui__ui__2w8SD\",\"logoTagline\":\"scene-ui__logoTagline__vvFFN\",\"whiteOverlay\":\"scene-ui__whiteOverlay__3qZ5u\",\"grid\":\"scene-ui__grid__1vLm1\",\"mainPanel\":\"scene-ui__mainPanel__19Tre\",\"logo\":\"scene-ui__logo__1gm7w\",\"info\":\"scene-ui__info__3h6Ui\",\"name\":\"scene-ui__name__226vL\",\"attribution\":\"scene-ui__attribution__GPKdB\",\"screenshot\":\"scene-ui__screenshot__Ai7b6\",\"screenshotHidden\":\"scene-ui__screenshotHidden__YLDmm\",\"spoke\":\"scene-ui__spoke__2UyEa\",\"madeWith\":\"scene-ui__madeWith__fn5Fe\",\"createButtons\":\"scene-ui__createButtons__3NOLi\",\"unavailable\":\"scene-ui__unavailable__2X-V3\"};","import Raven from \"raven-js\";\r\nimport configs from \"./utils/configs\";\r\n\r\nconst ga = window.ga;\r\n\r\nexport default function registerTelemetry(trackedPage, trackedTitle) {\r\n  const sentryDsn = configs.SENTRY_DSN;\r\n  const gaTrackingId = configs.GA_TRACKING_ID;\r\n\r\n  if (sentryDsn) {\r\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\r\n    Raven.config(sentryDsn).install();\r\n  }\r\n\r\n  if (ga && gaTrackingId) {\r\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\r\n\r\n    ga(\"create\", gaTrackingId, \"auto\");\r\n\r\n    if (trackedPage) {\r\n      ga(\"set\", \"page\", trackedPage);\r\n    }\r\n\r\n    if (trackedTitle) {\r\n      ga(\"set\", \"title\", trackedTitle);\r\n    }\r\n\r\n    ga(\"send\", \"pageview\");\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3\";","module.exports = __webpack_public_path__ + \"assets/images/twitter-ed8866f38a314b1281e6b0307cd7b891.svg\";","// Computes an AABB that surrounds the object in question and all of its children.\r\n// Note that if the children have rotations, this probably won't return the tightest\r\n// possible AABB -- we could return a tighter one if we examined all of the vertices\r\n// of the geometry for ourselves, but we don't care enough for what we're using this\r\n// for to do so much work.\r\nconst computeObjectAABB = (function() {\r\n  const bounds = new THREE.Box3();\r\n  return function(root, target) {\r\n    target.makeEmpty();\r\n    root.traverse(node => {\r\n      const geometry = node.geometry;\r\n      if (geometry != null) {\r\n        if (geometry.boundingBox == null) {\r\n          geometry.computeBoundingBox();\r\n        }\r\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\r\n      }\r\n    });\r\n    return target;\r\n  };\r\n})();\r\n\r\nconst rotation = new THREE.Euler();\r\nexport function getBox(entity, boxRoot, worldSpace) {\r\n  const box = new THREE.Box3();\r\n\r\n  rotation.copy(entity.object3D.rotation);\r\n  entity.object3D.rotation.set(0, 0, 0);\r\n\r\n  entity.object3D.updateMatrices(true, true);\r\n  boxRoot.updateMatrices(true, true);\r\n  boxRoot.updateMatrixWorld(true);\r\n\r\n  computeObjectAABB(boxRoot, box);\r\n\r\n  if (!box.isEmpty()) {\r\n    if (!worldSpace) {\r\n      entity.object3D.worldToLocal(box.min);\r\n      entity.object3D.worldToLocal(box.max);\r\n    }\r\n    entity.object3D.rotation.copy(rotation);\r\n    entity.object3D.matrixNeedsUpdate = true;\r\n  }\r\n\r\n  boxRoot.matrixWorldNeedsUpdate = true;\r\n  boxRoot.updateMatrices();\r\n\r\n  return box;\r\n}\r\n\r\nexport function getScaleCoefficient(length, box) {\r\n  if (box.isEmpty()) return 1.0;\r\n\r\n  const { max, min } = box;\r\n  const dX = Math.abs(max.x - min.x);\r\n  const dY = Math.abs(max.y - min.y);\r\n  const dZ = Math.abs(max.z - min.z);\r\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\r\n  return length / lengthOfLongestComponent;\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/models/DuckyMesh-04f978955fb12d48f7ff8c59a05de439.glb\";","export default function nextTick() {\r\n  return new Promise(resolve => {\r\n    setTimeout(resolve, 0);\r\n  });\r\n}\r\n","import nextTick from \"../utils/next-tick\";\r\nimport { mapMaterials } from \"../utils/material-utils\";\r\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\r\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\r\nimport { textureLoader } from \"../utils/media-utils\";\r\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-url-utils\";\r\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\r\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\r\nimport { disposeNode, cloneObject3D } from \"../utils/three-utils\";\r\n\r\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\r\n\r\nclass GLTFCache {\r\n  cache = new Map();\r\n\r\n  set(src, gltf) {\r\n    this.cache.set(src, {\r\n      gltf,\r\n      count: 0\r\n    });\r\n    return this.retain(src);\r\n  }\r\n\r\n  has(src) {\r\n    return this.cache.has(src);\r\n  }\r\n\r\n  get(src) {\r\n    return this.cache.get(src);\r\n  }\r\n\r\n  retain(src) {\r\n    const cacheItem = this.cache.get(src);\r\n    cacheItem.count++;\r\n    return cacheItem;\r\n  }\r\n\r\n  release(src) {\r\n    const cacheItem = this.cache.get(src);\r\n\r\n    if (!cacheItem) {\r\n      console.error(`Releasing uncached gltf ${src}`);\r\n      return;\r\n    }\r\n\r\n    cacheItem.count--;\r\n    if (cacheItem.count <= 0) {\r\n      cacheItem.gltf.scene.traverse(disposeNode);\r\n      this.cache.delete(src);\r\n    }\r\n  }\r\n}\r\nconst gltfCache = new GLTFCache();\r\nconst inflightGltfs = new Map();\r\n\r\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\r\n\r\nfunction defaultInflator(el, componentName, componentData) {\r\n  if (!AFRAME.components[componentName]) {\r\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\r\n  }\r\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\r\n    for (let i = 0; i < componentData.length; i++) {\r\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\r\n    }\r\n  } else {\r\n    el.setAttribute(componentName, componentData);\r\n  }\r\n}\r\n\r\nAFRAME.GLTFModelPlus = {\r\n  // eslint-disable-next-line no-unused-vars\r\n  components: {},\r\n  registerComponent(componentKey, componentName, inflator) {\r\n    inflator = inflator || defaultInflator;\r\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\r\n  }\r\n};\r\n\r\nfunction generateMeshBVH(object3D) {\r\n  object3D.traverse(obj => {\r\n    // note that we might already have a bounds tree if this was a clone of an object with one\r\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\r\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\r\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\r\n      const geo = obj.geometry;\r\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\r\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\r\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\r\n      // we put this in a web worker)\r\n      if (triCount > 1000 && triCount < 1000000) {\r\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\r\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nfunction cloneGltf(gltf) {\r\n  return {\r\n    animations: gltf.scene.animations,\r\n    scene: cloneObject3D(gltf.scene)\r\n  };\r\n}\r\n\r\nfunction getHubsComponents(node) {\r\n  const hubsComponents =\r\n    node.userData.gltfExtensions &&\r\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\r\n\r\n  // We can remove support for legacy components when our environment, avatar and interactable models are\r\n  // updated to match Spoke output.\r\n  const legacyComponents = node.userData.components;\r\n\r\n  return hubsComponents || legacyComponents;\r\n}\r\n\r\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\r\n/// and template data to construct A-Frame entities and components when necessary.\r\n/// (It's unnecessary to construct entities for subtrees that have no component data\r\n/// or templates associated with any of their nodes.)\r\n///\r\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\r\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\r\n  // TODO: Remove this once we update the legacy avatars to the new node names\r\n  if (node.name === \"Chest\") {\r\n    node.name = \"Spine\";\r\n  } else if (node.name === \"Root Scene\") {\r\n    node.name = \"AvatarRoot\";\r\n  } else if (node.name === \"Bot_Skinned\") {\r\n    node.name = \"AvatarMesh\";\r\n  }\r\n\r\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\r\n  const childEntities = [];\r\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\r\n  for (const child of children) {\r\n    const el = inflateEntities(indexToEntityMap, child, templates);\r\n    if (el) {\r\n      childEntities.push(el);\r\n    }\r\n  }\r\n\r\n  const entityComponents = getHubsComponents(node);\r\n\r\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\r\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\r\n    return null; // we don't need an entity for this node\r\n  }\r\n\r\n  const el = document.createElement(\"a-entity\");\r\n  el.append.apply(el, childEntities);\r\n\r\n  // Remove invalid CSS class name characters.\r\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\r\n  el.classList.add(className);\r\n\r\n  // AFRAME rotation component expects rotations in YXZ, convert it\r\n  if (node.rotation.order !== \"YXZ\") {\r\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\r\n  }\r\n\r\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\r\n  // all updates to the object should be done through the THREE.Group wrapper\r\n  el.object3D.position.copy(node.position);\r\n  el.object3D.rotation.copy(node.rotation);\r\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\r\n  el.object3D.matrixNeedsUpdate = true;\r\n\r\n  node.matrixAutoUpdate = false;\r\n  node.matrix.identity();\r\n  node.matrix.decompose(node.position, node.rotation, node.scale);\r\n\r\n  el.setObject3D(node.type.toLowerCase(), node);\r\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\r\n    el.setObject3D(\"mesh\", node);\r\n  }\r\n\r\n  // Set the name of the `THREE.Group` to match the name of the node,\r\n  // so that templates can be attached to the correct AFrame entity.\r\n  el.object3D.name = node.name;\r\n\r\n  // Set the uuid of the `THREE.Group` to match the uuid of the node,\r\n  // so that `THREE.PropertyBinding` will find (and later animate)\r\n  // the group. See `PropertyBinding.findNode`:\r\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\r\n  el.object3D.uuid = node.uuid;\r\n  node.uuid = THREE.Math.generateUUID();\r\n\r\n  if (node.animations) {\r\n    // Pass animations up to the group object so that when we can pass the group as\r\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\r\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\r\n    // `null` in `THREE.AnimationClip.findByName`.\r\n    node.parent.animations = node.animations;\r\n  }\r\n\r\n  const gltfIndex = node.userData.gltfIndex;\r\n  if (gltfIndex !== undefined) {\r\n    indexToEntityMap[gltfIndex] = el;\r\n  }\r\n\r\n  return el;\r\n};\r\n\r\nasync function inflateComponents(inflatedEntity, indexToEntityMap) {\r\n  let isFirstInflation = true;\r\n  const objectInflations = [];\r\n\r\n  inflatedEntity.object3D.traverse(async object3D => {\r\n    const objectInflation = {};\r\n    objectInflation.promise = new Promise(resolve => (objectInflation.resolve = resolve));\r\n    objectInflations.push(objectInflation);\r\n\r\n    if (!isFirstInflation) {\r\n      await objectInflations.shift().promise;\r\n    }\r\n    isFirstInflation = false;\r\n\r\n    const entityComponents = getHubsComponents(object3D);\r\n    const el = object3D.el;\r\n\r\n    if (entityComponents && el) {\r\n      for (const prop in entityComponents) {\r\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\r\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\r\n          await inflator(el, componentName, entityComponents[prop], entityComponents, indexToEntityMap);\r\n        }\r\n      }\r\n    }\r\n\r\n    objectInflation.resolve();\r\n  });\r\n\r\n  await objectInflations.shift().promise;\r\n}\r\n\r\nfunction attachTemplate(root, name, templateRoot) {\r\n  const targetEls = root.querySelectorAll(\".\" + name);\r\n  for (const el of targetEls) {\r\n    const root = templateRoot.cloneNode(true);\r\n    // Merge root element attributes with the target element\r\n    for (const { name, value } of root.attributes) {\r\n      el.setAttribute(name, value);\r\n    }\r\n\r\n    // Append all child elements\r\n    while (root.children.length > 0) {\r\n      el.appendChild(root.children[0]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getHubsComponentsExtension(node) {\r\n  if (node.extensions && node.extensions.MOZ_hubs_components) {\r\n    return node.extensions.MOZ_hubs_components;\r\n  } else if (node.extensions && node.extensions.HUBS_components) {\r\n    return node.extensions.HUBS_components;\r\n  } else if (node.extras && node.extras.gltfExtensions && node.extras.gltfExtensions.MOZ_hubs_components) {\r\n    return node.extras.gltfExtensions.MOZ_hubs_components;\r\n  }\r\n}\r\n\r\n// Versions are documented here: https://github.com/mozilla/hubs/wiki/MOZ_hubs_components-Changelog\r\n// Make sure to update the wiki and Spoke when bumping a version\r\nfunction runMigration(version, json) {\r\n  if (version < 2) {\r\n    //old heightfields will be on the same node as the nav-mesh, delete those\r\n    const oldHeightfieldNode = json.nodes.find(node => {\r\n      const components = getHubsComponentsExtension(node);\r\n      return components && components.heightfield && components[\"nav-mesh\"];\r\n    });\r\n    if (oldHeightfieldNode) {\r\n      if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.MOZ_hubs_components) {\r\n        delete oldHeightfieldNode.extensions.MOZ_hubs_components.heightfield;\r\n      } else if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.HUBS_components) {\r\n        delete oldHeightfieldNode.extensions.HUBS_components.heightfield;\r\n      } else if (\r\n        oldHeightfieldNode.extras &&\r\n        oldHeightfieldNode.extras.gltfExtensions &&\r\n        oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components\r\n      ) {\r\n        delete oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (version < 4) {\r\n    // Lights prior to version 4 should treat range === 0 as if it has zero decay\r\n    if (json.nodes) {\r\n      for (const node of json.nodes) {\r\n        const components = getHubsComponentsExtension(node);\r\n\r\n        if (!components) {\r\n          continue;\r\n        }\r\n\r\n        const light = components[\"spot-light\"] || components[\"point-light\"];\r\n\r\n        if (light && light.range === 0) {\r\n          light.decay = 0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport async function loadGLTF(src, contentType, preferredTechnique, onProgress, jsonPreprocessor) {\r\n  let gltfUrl = src;\r\n  let fileMap;\r\n\r\n  if (contentType && (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\"))) {\r\n    fileMap = await extractZipFile(gltfUrl);\r\n    gltfUrl = fileMap[\"scene.gtlf\"];\r\n  }\r\n\r\n  const loadingManager = new THREE.LoadingManager();\r\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\r\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\r\n\r\n  const parser = await new Promise((resolve, reject) => gltfLoader.createParser(gltfUrl, resolve, onProgress, reject));\r\n\r\n  parser.textureLoader = textureLoader;\r\n\r\n  if (jsonPreprocessor) {\r\n    parser.json = jsonPreprocessor(parser.json);\r\n  }\r\n\r\n  let version = 0;\r\n  if (\r\n    parser.json.extensions &&\r\n    parser.json.extensions.MOZ_hubs_components &&\r\n    parser.json.extensions.MOZ_hubs_components.hasOwnProperty(\"version\")\r\n  ) {\r\n    version = parser.json.extensions.MOZ_hubs_components.version;\r\n  }\r\n  runMigration(version, parser.json);\r\n\r\n  const materials = parser.json.materials;\r\n  if (materials) {\r\n    for (let i = 0; i < materials.length; i++) {\r\n      const material = materials[i];\r\n\r\n      if (\r\n        material.extensions &&\r\n        material.extensions.MOZ_alt_materials &&\r\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\r\n      ) {\r\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\r\n        materials[i] = materials[altMaterialIndex];\r\n      }\r\n    }\r\n  }\r\n\r\n  const nodes = parser.json.nodes;\r\n\r\n  if (nodes) {\r\n    for (let i = 0; i < nodes.length; i++) {\r\n      const node = nodes[i];\r\n\r\n      if (!node.extras) {\r\n        node.extras = {};\r\n      }\r\n\r\n      node.extras.gltfIndex = i;\r\n    }\r\n  }\r\n\r\n  const gltf = await new Promise(parser.parse.bind(parser));\r\n\r\n  gltf.scene.traverse(object => {\r\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\r\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\r\n\r\n    object.material = mapMaterials(object, material => {\r\n      if (material.isMeshStandardMaterial && preferredTechnique === \"KHR_materials_unlit\") {\r\n        return MobileStandardMaterial.fromStandardMaterial(material);\r\n      }\r\n\r\n      return material;\r\n    });\r\n  });\r\n\r\n  if (fileMap) {\r\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\r\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\r\n  }\r\n\r\n  gltf.scene.animations = gltf.animations;\r\n\r\n  return gltf;\r\n}\r\n\r\nexport async function loadModel(src, contentType = null, useCache = false, jsonPreprocessor = null) {\r\n  const preferredTechnique =\r\n    window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\r\n\r\n  if (useCache) {\r\n    if (gltfCache.has(src)) {\r\n      gltfCache.retain(src);\r\n      return cloneGltf(gltfCache.get(src).gltf);\r\n    } else {\r\n      if (inflightGltfs.has(src)) {\r\n        const gltf = await inflightGltfs.get(src);\r\n        gltfCache.retain(src);\r\n        return cloneGltf(gltf);\r\n      } else {\r\n        const promise = loadGLTF(src, contentType, preferredTechnique, null, jsonPreprocessor);\r\n        inflightGltfs.set(src, promise);\r\n        const gltf = await promise;\r\n        inflightGltfs.delete(src);\r\n        gltfCache.set(src, gltf);\r\n        return cloneGltf(gltf);\r\n      }\r\n    }\r\n  } else {\r\n    return loadGLTF(src, contentType, preferredTechnique, null, jsonPreprocessor);\r\n  }\r\n}\r\n\r\nfunction resolveAsset(src) {\r\n  // If the src attribute is a selector, get the url from the asset item.\r\n  if (src && src.charAt(0) === \"#\") {\r\n    const assetEl = document.getElementById(src.substring(1));\r\n    if (assetEl) {\r\n      return assetEl.getAttribute(\"src\");\r\n    }\r\n  }\r\n  return src;\r\n}\r\n\r\n/**\r\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\r\n * whitelisted components on them if defined in the node's extras.\r\n * @namespace gltf\r\n * @component gltf-model-plus\r\n */\r\nAFRAME.registerComponent(\"gltf-model-plus\", {\r\n  schema: {\r\n    src: { type: \"string\" },\r\n    contentType: { type: \"string\" },\r\n    useCache: { default: true },\r\n    inflate: { default: false },\r\n    batch: { default: false },\r\n    modelToWorldScale: { type: \"number\", default: 1 }\r\n  },\r\n\r\n  init() {\r\n    // This can be set externally if a consumer wants to do some node preprocssing.\r\n    this.jsonPreprocessor = null;\r\n\r\n    this.loadTemplates();\r\n  },\r\n\r\n  update() {\r\n    this.applySrc(resolveAsset(this.data.src), this.data.contentType);\r\n  },\r\n\r\n  remove() {\r\n    if (this.data.batch && this.model) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.el.object3DMap.mesh);\r\n    }\r\n    const src = resolveAsset(this.data.src);\r\n    if (src) {\r\n      gltfCache.release(src);\r\n    }\r\n  },\r\n\r\n  loadTemplates() {\r\n    this.templates = {};\r\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\r\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\r\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\r\n    });\r\n  },\r\n\r\n  async applySrc(src, contentType) {\r\n    try {\r\n      if (src === this.lastSrc) return;\r\n\r\n      const lastSrc = this.lastSrc;\r\n      this.lastSrc = src;\r\n\r\n      if (!src) {\r\n        if (this.inflatedEl) {\r\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\r\n          this.disposeLastInflatedEl();\r\n        }\r\n        return;\r\n      }\r\n\r\n      this.el.emit(\"model-loading\");\r\n      const gltf = await loadModel(src, contentType, this.data.useCache, this.jsonPreprocessor);\r\n\r\n      // If we started loading something else already\r\n      // TODO: there should be a way to cancel loading instead\r\n      if (src != this.lastSrc) return;\r\n\r\n      // If we had inflated something already before, clean that up\r\n      this.disposeLastInflatedEl();\r\n\r\n      this.model = gltf.scene || gltf.scenes[0];\r\n\r\n      if (this.data.batch) {\r\n        this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.model);\r\n      }\r\n\r\n      if (gltf.animations.length > 0) {\r\n        this.el.setAttribute(\"animation-mixer\", {});\r\n        this.el.components[\"animation-mixer\"].initMixer(this.model.animations);\r\n      } else {\r\n        generateMeshBVH(this.model);\r\n      }\r\n\r\n      const indexToEntityMap = {};\r\n\r\n      let object3DToSet = this.model;\r\n      if (\r\n        this.data.inflate &&\r\n        (this.inflatedEl = inflateEntities(\r\n          indexToEntityMap,\r\n          this.model,\r\n          this.templates,\r\n          true,\r\n          this.data.modelToWorldScale\r\n        ))\r\n      ) {\r\n        this.el.appendChild(this.inflatedEl);\r\n\r\n        object3DToSet = this.inflatedEl.object3D;\r\n        object3DToSet.visible = false;\r\n\r\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\r\n        // Wait one tick for the appended custom elements to be connected before attaching templates\r\n        await nextTick();\r\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\r\n\r\n        await inflateComponents(this.inflatedEl, indexToEntityMap);\r\n\r\n        for (const name in this.templates) {\r\n          attachTemplate(this.el, name, this.templates[name]);\r\n        }\r\n      }\r\n\r\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\r\n      // in the entire inflated entity graph to point to `object3DToSet`.\r\n      //\r\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\r\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\r\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\r\n      // the model or the root GLTF inflated entity.\r\n      const rewires = [];\r\n\r\n      object3DToSet.traverse(o => {\r\n        const el = o.el;\r\n        if (el) rewires.push(() => (o.el = el));\r\n      });\r\n\r\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n\r\n      if (environmentMapComponent) {\r\n        environmentMapComponent.applyEnvironmentMap(object3DToSet);\r\n      }\r\n\r\n      if (lastSrc) {\r\n        gltfCache.release(lastSrc);\r\n      }\r\n      this.el.setObject3D(\"mesh\", object3DToSet);\r\n\r\n      rewires.forEach(f => f());\r\n\r\n      object3DToSet.visible = true;\r\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\r\n    } catch (e) {\r\n      gltfCache.release(src);\r\n      console.error(\"Failed to load glTF model\", e, this);\r\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\r\n    }\r\n  },\r\n\r\n  disposeLastInflatedEl() {\r\n    if (this.inflatedEl) {\r\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\r\n\r\n      this.inflatedEl.object3D.traverse(x => {\r\n        if (x.material && x.material.dispose) {\r\n          x.material.dispose();\r\n        }\r\n\r\n        if (x.geometry) {\r\n          if (x.geometry.dispose) {\r\n            x.geometry.dispose();\r\n          }\r\n\r\n          x.geometry.boundsTree = null;\r\n        }\r\n      });\r\n\r\n      delete this.inflatedEl;\r\n\r\n      this.el.removeAttribute(\"animation-mixer\");\r\n    }\r\n  }\r\n});\r\n","export function findAncestorWithComponent(entity, componentName) {\r\n  while (entity && !(entity.components && entity.components[componentName])) {\r\n    entity = entity.parentNode;\r\n  }\r\n  return entity;\r\n}\r\n","const adjectives = [\r\n  \"able\",\r\n  \"absolute\",\r\n  \"acceptable\",\r\n  \"acclaimed\",\r\n  \"accomplished\",\r\n  \"accurate\",\r\n  \"aching\",\r\n  \"acrobatic\",\r\n  \"adorable\",\r\n  \"adventurous\",\r\n  \"basic\",\r\n  \"belated\",\r\n  \"beloved\",\r\n  \"calm\",\r\n  \"candid\",\r\n  \"capital\",\r\n  \"carefree\",\r\n  \"caring\",\r\n  \"cautious\",\r\n  \"celebrated\",\r\n  \"charming\",\r\n  \"daring\",\r\n  \"darling\",\r\n  \"dearest\",\r\n  \"each\",\r\n  \"eager\",\r\n  \"early\",\r\n  \"earnest\",\r\n  \"easy\",\r\n  \"easygoing\",\r\n  \"ecstatic\",\r\n  \"edible\",\r\n  \"fabulous\",\r\n  \"fair\",\r\n  \"faithful\",\r\n  \"familiar\",\r\n  \"famous\",\r\n  \"fancy\",\r\n  \"fantastic\",\r\n  \"far\",\r\n  \"generous\",\r\n  \"gentle\",\r\n  \"genuine\",\r\n  \"giant\",\r\n  \"handmade\",\r\n  \"handsome\",\r\n  \"handy\",\r\n  \"happy\",\r\n  \"icy\",\r\n  \"ideal\",\r\n  \"identical\",\r\n  \"keen\",\r\n  \"lasting\",\r\n  \"lavish\",\r\n  \"magnificent\",\r\n  \"majestic\",\r\n  \"mammoth\",\r\n  \"marvelous\",\r\n  \"natural\",\r\n  \"obedient\",\r\n  \"palatable\",\r\n  \"parched\",\r\n  \"passionate\",\r\n  \"pastel\",\r\n  \"peaceful\",\r\n  \"perfect\",\r\n  \"perfumed\",\r\n  \"quaint\",\r\n  \"qualified\",\r\n  \"radiant\",\r\n  \"rapid\",\r\n  \"rare\",\r\n  \"safe\",\r\n  \"sandy\",\r\n  \"satisfied\",\r\n  \"scaly\",\r\n  \"scarce\",\r\n  \"scared\",\r\n  \"scary\",\r\n  \"scented\",\r\n  \"scientific\",\r\n  \"secret\",\r\n  \"sentimental\",\r\n  \"talkative\",\r\n  \"tangible\",\r\n  \"tart\",\r\n  \"tasty\",\r\n  \"tattered\",\r\n  \"teeming\",\r\n  \"ultimate\",\r\n  \"uncommon\",\r\n  \"unconscious\",\r\n  \"understated\",\r\n  \"warm\",\r\n  \"active\",\r\n  \"adept\",\r\n  \"admirable\",\r\n  \"admired\",\r\n  \"adorable\",\r\n  \"adored\",\r\n  \"advanced\",\r\n  \"affectionate\",\r\n  \"beneficial\",\r\n  \"best\",\r\n  \"better\",\r\n  \"big\",\r\n  \"cheerful\",\r\n  \"cheery\",\r\n  \"chief\",\r\n  \"chilly\",\r\n  \"classic\",\r\n  \"clean\",\r\n  \"clear\",\r\n  \"clever\",\r\n  \"decent\",\r\n  \"decisive\",\r\n  \"deep\",\r\n  \"defiant\",\r\n  \"definitive\",\r\n  \"delectable\",\r\n  \"delicious\",\r\n  \"elaborate\",\r\n  \"elastic\",\r\n  \"elated\",\r\n  \"elegant\",\r\n  \"elementary\",\r\n  \"elliptical\",\r\n  \"fast\",\r\n  \"favorable\",\r\n  \"favorite\",\r\n  \"fearless\",\r\n  \"gifted\",\r\n  \"glamorous\",\r\n  \"gleaming\",\r\n  \"glittering\",\r\n  \"harmonious\",\r\n  \"imaginative\",\r\n  \"immense\",\r\n  \"jealous\",\r\n  \"kind\",\r\n  \"leafy\",\r\n  \"legal\",\r\n  \"mature\",\r\n  \"mean\",\r\n  \"nautical\",\r\n  \"neat\",\r\n  \"necessary\",\r\n  \"needy\",\r\n  \"oddball\",\r\n  \"offbeat\",\r\n  \"periodic\",\r\n  \"perky\",\r\n  \"personal\",\r\n  \"pertinent\",\r\n  \"petty\",\r\n  \"quarterly\",\r\n  \"ready\",\r\n  \"real\",\r\n  \"realistic\",\r\n  \"reasonable\",\r\n  \"regal\",\r\n  \"serene\",\r\n  \"shabby\",\r\n  \"sharp\",\r\n  \"shiny\",\r\n  \"showy\",\r\n  \"shy\",\r\n  \"silky\",\r\n  \"tempting\",\r\n  \"tense\",\r\n  \"terrific\",\r\n  \"testy\",\r\n  \"thankful\",\r\n  \"uniform\",\r\n  \"unique\",\r\n  \"vast\",\r\n  \"weary\",\r\n  \"wee\",\r\n  \"welcome\",\r\n  \"agile\",\r\n  \"alarmed\",\r\n  \"alert\",\r\n  \"alive\",\r\n  \"bleak\",\r\n  \"blissful\",\r\n  \"blushing\",\r\n  \"coarse\",\r\n  \"colorful\",\r\n  \"colossal\",\r\n  \"comfortable\",\r\n  \"compassionate\",\r\n  \"complete\",\r\n  \"delightful\",\r\n  \"dense\",\r\n  \"dependable\",\r\n  \"dependent\",\r\n  \"descriptive\",\r\n  \"detailed\",\r\n  \"determined\",\r\n  \"devoted\",\r\n  \"different\",\r\n  \"eminent\",\r\n  \"emotional\",\r\n  \"enchanted\",\r\n  \"enchanting\",\r\n  \"energetic\",\r\n  \"enormous\",\r\n  \"fine\",\r\n  \"finished\",\r\n  \"firm\",\r\n  \"firsthand\",\r\n  \"fixed\",\r\n  \"flashy\",\r\n  \"flawless\",\r\n  \"glorious\",\r\n  \"glossy\",\r\n  \"golden\",\r\n  \"good\",\r\n  \"gorgeous\",\r\n  \"graceful\",\r\n  \"healthy\",\r\n  \"heartfelt\",\r\n  \"hearty\",\r\n  \"helpful\",\r\n  \"impartial\",\r\n  \"impressive\",\r\n  \"jolly\",\r\n  \"jovial\",\r\n  \"lighthearted\",\r\n  \"likable\",\r\n  \"lined\",\r\n  \"mellow\",\r\n  \"melodic\",\r\n  \"memorable\",\r\n  \"mild\",\r\n  \"new\",\r\n  \"opulent\",\r\n  \"playful\",\r\n  \"pleasant\",\r\n  \"pleasing\",\r\n  \"plump\",\r\n  \"plush\",\r\n  \"polished\",\r\n  \"polite\",\r\n  \"reliable\",\r\n  \"relieved\",\r\n  \"remarkable\",\r\n  \"remote\",\r\n  \"respectful\",\r\n  \"responsible\",\r\n  \"simple\",\r\n  \"simplistic\",\r\n  \"sizzling\",\r\n  \"sleepy\",\r\n  \"slight\",\r\n  \"slim\",\r\n  \"smart\",\r\n  \"smooth\",\r\n  \"snappy\",\r\n  \"snoopy\",\r\n  \"thirsty\",\r\n  \"this\",\r\n  \"thorough\",\r\n  \"those\",\r\n  \"thoughtful\",\r\n  \"united\",\r\n  \"vibrant\",\r\n  \"vicious\",\r\n  \"wellmade\",\r\n  \"whimsical\",\r\n  \"whirlwind\",\r\n  \"zesty\",\r\n  \"amazing\",\r\n  \"ambitious\",\r\n  \"ample\",\r\n  \"amused\",\r\n  \"amusing\",\r\n  \"ancient\",\r\n  \"angelic\",\r\n  \"antique\",\r\n  \"bold\",\r\n  \"bossy\",\r\n  \"both\",\r\n  \"bouncy\",\r\n  \"bountiful\",\r\n  \"complex\",\r\n  \"conscious\",\r\n  \"considerate\",\r\n  \"constant\",\r\n  \"content\",\r\n  \"conventional\",\r\n  \"cooked\",\r\n  \"cool\",\r\n  \"cooperative\",\r\n  \"diligent\",\r\n  \"dimwitted\",\r\n  \"direct\",\r\n  \"discrete\",\r\n  \"envious\",\r\n  \"essential\",\r\n  \"ethical\",\r\n  \"euphoric\",\r\n  \"flippant\",\r\n  \"fluffy\",\r\n  \"flustered\",\r\n  \"focused\",\r\n  \"fond\",\r\n  \"gracious\",\r\n  \"grand\",\r\n  \"grandiose\",\r\n  \"granular\",\r\n  \"grateful\",\r\n  \"grave\",\r\n  \"great\",\r\n  \"hidden\",\r\n  \"high\",\r\n  \"hilarious\",\r\n  \"homely\",\r\n  \"incomparable\",\r\n  \"incredible\",\r\n  \"infamous\",\r\n  \"joyful\",\r\n  \"lively\",\r\n  \"loathsome\",\r\n  \"lonely\",\r\n  \"long\",\r\n  \"mindless\",\r\n  \"miniature\",\r\n  \"minor\",\r\n  \"misty\",\r\n  \"next\",\r\n  \"nice\",\r\n  \"nifty\",\r\n  \"nimble\",\r\n  \"orderly\",\r\n  \"organic\",\r\n  \"ornate\",\r\n  \"popular\",\r\n  \"posh\",\r\n  \"positive\",\r\n  \"potable\",\r\n  \"powerful\",\r\n  \"powerless\",\r\n  \"precious\",\r\n  \"present\",\r\n  \"prestigious\",\r\n  \"quick\",\r\n  \"rewarding\",\r\n  \"rich\",\r\n  \"right\",\r\n  \"sociable\",\r\n  \"soft\",\r\n  \"solid\",\r\n  \"some\",\r\n  \"sophisticated\",\r\n  \"soulful\",\r\n  \"sparkling\",\r\n  \"spectacular\",\r\n  \"speedy\",\r\n  \"spicy\",\r\n  \"spiffy\",\r\n  \"spirited\",\r\n  \"spiteful\",\r\n  \"splendid\",\r\n  \"spotless\",\r\n  \"spry\",\r\n  \"thrifty\",\r\n  \"tidy\",\r\n  \"tight\",\r\n  \"timely\",\r\n  \"tinted\",\r\n  \"unruly\",\r\n  \"untimely\",\r\n  \"violet\",\r\n  \"wicked\",\r\n  \"wide\",\r\n  \"wild\",\r\n  \"willing\",\r\n  \"winding\",\r\n  \"windy\",\r\n  \"zigzag\",\r\n  \"apprehensive\",\r\n  \"appropriate\",\r\n  \"artistic\",\r\n  \"assured\",\r\n  \"astonishing\",\r\n  \"bright\",\r\n  \"brilliant\",\r\n  \"bronze\",\r\n  \"coordinated\",\r\n  \"courageous\",\r\n  \"courteous\",\r\n  \"crafty\",\r\n  \"crazy\",\r\n  \"creamy\",\r\n  \"creative\",\r\n  \"crisp\",\r\n  \"distant\",\r\n  \"distinct\",\r\n  \"downright\",\r\n  \"evergreen\",\r\n  \"everlasting\",\r\n  \"every\",\r\n  \"evil\",\r\n  \"excellent\",\r\n  \"excitable\",\r\n  \"exemplary\",\r\n  \"exhausted\",\r\n  \"forthright\",\r\n  \"fortunate\",\r\n  \"fragrant\",\r\n  \"frank\",\r\n  \"free\",\r\n  \"frequent\",\r\n  \"fresh\",\r\n  \"friendly\",\r\n  \"frightened\",\r\n  \"frigid\",\r\n  \"gripping\",\r\n  \"grounded\",\r\n  \"honest\",\r\n  \"honorable\",\r\n  \"honored\",\r\n  \"hopeful\",\r\n  \"hospitable\",\r\n  \"hot\",\r\n  \"huge\",\r\n  \"infatuated\",\r\n  \"infinite\",\r\n  \"informal\",\r\n  \"insistent\",\r\n  \"instructive\",\r\n  \"juicy\",\r\n  \"jumbo\",\r\n  \"knowing\",\r\n  \"knowledgeable\",\r\n  \"longterm\",\r\n  \"loud\",\r\n  \"lovable\",\r\n  \"loving\",\r\n  \"modern\",\r\n  \"modest\",\r\n  \"monumental\",\r\n  \"normal\",\r\n  \"notable\",\r\n  \"outgoing\",\r\n  \"precious\",\r\n  \"pretty\",\r\n  \"prickly\",\r\n  \"primary\",\r\n  \"pristine\",\r\n  \"private\",\r\n  \"prize\",\r\n  \"productive\",\r\n  \"profitable\",\r\n  \"quiet\",\r\n  \"quintessential\",\r\n  \"roasted\",\r\n  \"robust\",\r\n  \"square\",\r\n  \"squiggly\",\r\n  \"stable\",\r\n  \"staid\",\r\n  \"starry\",\r\n  \"steel\",\r\n  \"stimulating\",\r\n  \"striking\",\r\n  \"striped\",\r\n  \"strong\",\r\n  \"studious\",\r\n  \"stunning\",\r\n  \"tough\",\r\n  \"trained\",\r\n  \"treasured\",\r\n  \"tremendous\",\r\n  \"triangular\",\r\n  \"tricky\",\r\n  \"unused\",\r\n  \"unusual\",\r\n  \"upbeat\",\r\n  \"virtual\",\r\n  \"witty\",\r\n  \"wonderful\",\r\n  \"wooden\",\r\n  \"worldly\",\r\n  \"youthful\",\r\n  \"attached\",\r\n  \"attentive\",\r\n  \"attractive\",\r\n  \"austere\",\r\n  \"authentic\",\r\n  \"automatic\",\r\n  \"aware\",\r\n  \"awesome\",\r\n  \"bubbly\",\r\n  \"bustling\",\r\n  \"busy\",\r\n  \"buttery\",\r\n  \"cuddly\",\r\n  \"cultured\",\r\n  \"curly\",\r\n  \"curvy\",\r\n  \"cute\",\r\n  \"cylindrical\",\r\n  \"downright\",\r\n  \"dramatic\",\r\n  \"excited\",\r\n  \"exciting\",\r\n  \"exotic\",\r\n  \"experienced\",\r\n  \"expert\",\r\n  \"frosty\",\r\n  \"fruitful\",\r\n  \"full\",\r\n  \"fumbling\",\r\n  \"funny\",\r\n  \"fussy\",\r\n  \"growing\",\r\n  \"grown\",\r\n  \"gummy\",\r\n  \"humble\",\r\n  \"humongous\",\r\n  \"hungry\",\r\n  \"intelligent\",\r\n  \"interesting\",\r\n  \"known\",\r\n  \"kooky\",\r\n  \"loyal\",\r\n  \"lucky\",\r\n  \"luminous\",\r\n  \"lustrous\",\r\n  \"luxurious\",\r\n  \"multicolored\",\r\n  \"mysterious\",\r\n  \"noteworthy\",\r\n  \"numb\",\r\n  \"nutritious\",\r\n  \"outstanding\",\r\n  \"overjoyed\",\r\n  \"proper\",\r\n  \"proud\",\r\n  \"prudent\",\r\n  \"punctual\",\r\n  \"puny\",\r\n  \"pure\",\r\n  \"puzzled\",\r\n  \"puzzling\",\r\n  \"quirky\",\r\n  \"stupendous\",\r\n  \"sturdy\",\r\n  \"stylish\",\r\n  \"subdued\",\r\n  \"subtle\",\r\n  \"sunny\",\r\n  \"super\",\r\n  \"superb\",\r\n  \"supportive\",\r\n  \"surprised\",\r\n  \"sweet\",\r\n  \"swift\",\r\n  \"sympathetic\",\r\n  \"trivial\",\r\n  \"trusting\",\r\n  \"trustworthy\",\r\n  \"trusty\",\r\n  \"truthful\",\r\n  \"twin\",\r\n  \"usable\",\r\n  \"used\",\r\n  \"useful\",\r\n  \"utilized\",\r\n  \"vital\",\r\n  \"vivid\",\r\n  \"worried\",\r\n  \"worthwhile\",\r\n  \"worthy\",\r\n  \"writhing\",\r\n  \"wry\",\r\n  \"yummy\",\r\n  \"chocolate\",\r\n  \"crimson\",\r\n  \"cyan\",\r\n  \"fuchsia\",\r\n  \"gold\",\r\n  \"honeydew\",\r\n  \"lime\",\r\n  \"linen\",\r\n  \"magenta\",\r\n  \"olive\",\r\n  \"peru\",\r\n  \"salmon\",\r\n  \"seashell\",\r\n  \"sienna\",\r\n  \"snow\",\r\n  \"thistle\",\r\n  \"tomato\",\r\n  \"transparent\",\r\n  \"turquoise\",\r\n  \"violet\"\r\n];\r\n\r\nconst nouns = [\r\n  \"space\",\r\n  \"land\",\r\n  \"world\",\r\n  \"universe\",\r\n  \"plane\",\r\n  \"room\",\r\n  \"nation\",\r\n  \"plaza\",\r\n  \"gathering\",\r\n  \"meetup\",\r\n  \"get together\",\r\n  \"conclave\",\r\n  \"party\",\r\n  \"domain\",\r\n  \"dominion\",\r\n  \"realm\",\r\n  \"square\",\r\n  \"commons\",\r\n  \"park\",\r\n  \"cosmos\",\r\n  \"sphere\",\r\n  \"terrain\",\r\n  \"spot\",\r\n  \"zone\",\r\n  \"area\",\r\n  \"tract\",\r\n  \"turf\",\r\n  \"place\",\r\n  \"territory\",\r\n  \"volume\",\r\n  \"camp\",\r\n  \"picnic\",\r\n  \"outing\",\r\n  \"vacation\",\r\n  \"adventure\",\r\n  \"exploration\",\r\n  \"outing\",\r\n  \"walkabout\",\r\n  \"safari\",\r\n  \"venture\",\r\n  \"roundtable\",\r\n  \"barbecue\",\r\n  \"celebration\",\r\n  \"festivity\",\r\n  \"gala\",\r\n  \"shindig\",\r\n  \"social\",\r\n  \"convention\",\r\n  \"assembly\",\r\n  \"congregation\",\r\n  \"rendezvous\",\r\n  \"huddle\",\r\n  \"meet\",\r\n  \"soiree\"\r\n];\r\n\r\nexport function generateHubName() {\r\n  const randItem = set => {\r\n    const s = set[Math.floor(Math.random() * set.length)];\r\n    return s.charAt(0).toUpperCase() + s.slice(1);\r\n  };\r\n\r\n  return `${randItem(adjectives)} ${randItem(adjectives)} ${randItem(nouns)}`;\r\n}\r\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\nimport configs from \"../utils/configs\";\n\nimport Store from \"../storage/store\";\n\nexport function hasReticulumServer() {\n  return !!configs.RETICULUM_SERVER;\n}\n\nexport function isLocalClient() {\n  return hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER;\n}\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (hasReticulumServer()) {\n    return `https://${configs.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nexport async function connectToReticulum(debug = false, params = null, socketClass = Socket) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    const socketProtocol =\n      qs.get(\"phx_protocol\") ||\n      configs.RETICULUM_SOCKET_PROTOCOL ||\n      (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n    let socketHost = qs.get(\"phx_host\");\n    let socketPort = qs.get(\"phx_port\");\n\n    const reticulumMeta = await getReticulumMeta();\n    socketHost = socketHost || configs.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\n    socketPort =\n      socketPort || (hasReticulumServer() ? new URL(`${socketProtocol}//${configs.RETICULUM_SERVER}`).port : \"443\");\n    return `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new socketClass(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: { \"content-type\": \"application/json\" },\n    method\n  };\n  if (token) {\n    params.headers.authorization = `bearer ${token}`;\n  }\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  const payload = { hub: { name: name || generateHubName() } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n\n    // Don't need to store the embed token if there's no creator assignment token, since that means\n    // we are the owner and will get the embed token on page load.\n    const embedToken = hub.embed_token;\n\n    if (embedToken) {\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\n    }\n  }\n\n  if (isLocalClient()) {\n    url = process.env.BASE_ASSETS_PATH + `hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceEntryForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0]) || {};\n}\n\nexport function getPresenceContextForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    channel.on(item.event, item.callback);\n  }\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n\nexport function discordBridgesForPresences(presences) {\n  const channels = [];\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.profile && m.profile.discordBridges) {\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n      }\n    }\n  }\n  return channels;\n}\n","import { waitForDOMContentLoaded } from \"./async-utils\";\r\nimport \"./configs\";\r\n\r\n// Node these should be synchronized with the top of shared.scss\r\nconst DEFAULT_ACTION_COLOR = \"#FF3464\";\r\nconst DEFAULT_ACTION_COLOR_LIGHT = \"#FF74A4\";\r\n\r\nconst DEFAULT_COLORS = {\r\n  \"action-color\": DEFAULT_ACTION_COLOR,\r\n  \"action-label-color\": DEFAULT_ACTION_COLOR,\r\n  \"action-color-disabled\": DEFAULT_ACTION_COLOR_LIGHT,\r\n  \"action-color-highlight\": DEFAULT_ACTION_COLOR_LIGHT,\r\n  \"action-text-color\": \"#FFFFFF\",\r\n  \"action-subtitle-color\": \"#F0F0F0\",\r\n  \"notice-background-color\": \"#2F80ED\",\r\n  \"notice-text-color\": \"#FFFFFF\",\r\n  \"favorited-color\": \"#FFC000\"\r\n};\r\n\r\nfunction getThemeColor(name) {\r\n  if (window.APP_CONFIG && window.APP_CONFIG.theme && window.APP_CONFIG.theme[name])\r\n    return window.APP_CONFIG.theme[name];\r\n\r\n  return DEFAULT_COLORS[name];\r\n}\r\n\r\nwaitForDOMContentLoaded().then(() => {\r\n  if (window.APP_CONFIG && window.APP_CONFIG.theme && window.APP_CONFIG.theme[\"dark-theme\"]) {\r\n    document.body.classList.add(\"dark-theme\");\r\n  } else {\r\n    document.body.classList.add(\"light-theme\");\r\n  }\r\n\r\n  const actionColor = getThemeColor(\"action-color\");\r\n  const actionHoverColor = getThemeColor(\"action-color-highlight\");\r\n\r\n  if (document.querySelector(\"#rounded-text-button\")) {\r\n    // NOTE, using the object-based {} setAttribute variant in a-frame\r\n    // seems to not work in Firefox here -- the entities with the mixins are not\r\n    // updated.\r\n    document\r\n      .querySelector(\"#rounded-text-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\r\n      );\r\n\r\n    document\r\n      .querySelector(\"#rounded-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\r\n      );\r\n\r\n    document\r\n      .querySelector(\"#rounded-text-action-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\r\n      );\r\n\r\n    document\r\n      .querySelector(\"#rounded-action-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\r\n      );\r\n  }\r\n});\r\n\r\nfunction applyThemeToTextButton(el, highlighted) {\r\n  el.setAttribute(\r\n    \"text-button\",\r\n    \"backgroundColor\",\r\n    highlighted ? getThemeColor(\"action-color-highlight\") : getThemeColor(\"action-color\")\r\n  );\r\n  el.setAttribute(\r\n    \"text-button\",\r\n    \"backgroundHoverColor\",\r\n    highlighted ? \"#aaa\" : getThemeColor(\"action-color-highlight\")\r\n  );\r\n}\r\n\r\nexport { applyThemeToTextButton, getThemeColor };\r\n","module.exports = __webpack_public_path__ + \"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png\";","const VERTEX_SHADER = `\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <uv2_pars_vertex>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n  #include <uv_vertex>\r\n  #include <uv2_vertex>\r\n  #include <color_vertex>\r\n  #include <skinbase_vertex>\r\n\r\n  #include <begin_vertex>\r\n  #include <morphtarget_vertex>\r\n  #include <skinning_vertex>\r\n  #include <project_vertex>\r\n  #include <logdepthbuf_vertex>\r\n\r\n  #include <worldpos_vertex>\r\n  #include <clipping_planes_vertex>\r\n  #include <fog_vertex>\r\n}\r\n`;\r\n\r\nconst FRAGMENT_SHADER = `\r\nuniform vec3 diffuse;\r\nuniform vec3 emissive;\r\nuniform float opacity;\r\n\r\n#include <common>\r\n#include <color_pars_fragment>\r\n#include <uv_pars_fragment>\r\n#include <uv2_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <aomap_pars_fragment>\r\n#include <emissivemap_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n  #include <clipping_planes_fragment>\r\n\r\n  vec4 diffuseColor = vec4(diffuse, opacity);\r\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\r\n  vec3 totalEmissiveRadiance = emissive;\r\n\r\n  #include <logdepthbuf_fragment>\r\n  #include <map_fragment>\r\n  #include <color_fragment>\r\n  #include <alphatest_fragment>\r\n  #include <emissivemap_fragment>\r\n\r\n  reflectedLight.indirectDiffuse += vec3(1.0);\r\n\r\n  #include <aomap_fragment>\r\n\r\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\r\n\r\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\r\n\r\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\r\n\r\n  #include <premultiplied_alpha_fragment>\r\n  #include <tonemapping_fragment>\r\n  #include <encodings_fragment>\r\n  #include <fog_fragment>\r\n}\r\n`;\r\n\r\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\r\n  type = \"MobileStandardMaterial\";\r\n  isMobileStandardMaterial = true;\r\n  static fromStandardMaterial(material) {\r\n    const parameters = {\r\n      vertexShader: VERTEX_SHADER,\r\n      fragmentShader: FRAGMENT_SHADER,\r\n      uniforms: {\r\n        ...THREE.UniformsUtils.clone(THREE.UniformsLib.fog),\r\n        uvTransform: { value: new THREE.Matrix3() },\r\n        diffuse: { value: material.color },\r\n        opacity: { value: material.opacity },\r\n        map: { value: material.map },\r\n        aoMapIntensity: { value: material.aoMapIntensity },\r\n        aoMap: { value: material.aoMap },\r\n        emissive: { value: material.emissive },\r\n        emissiveMap: { value: material.emissiveMap }\r\n      },\r\n      fog: true,\r\n      lights: false,\r\n      opacity: material.opacity,\r\n      transparent: material.transparent,\r\n      alphaTest: material.alphaTest,\r\n      skinning: material.skinning,\r\n      morphTargets: material.morphTargets,\r\n      vertexColors: material.vertexColors,\r\n      name: material.name\r\n    };\r\n\r\n    const mobileMaterial = new MobileStandardMaterial(parameters);\r\n\r\n    mobileMaterial.color = material.color;\r\n    mobileMaterial.map = material.map;\r\n    mobileMaterial.aoMap = material.aoMap;\r\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\r\n    mobileMaterial.emissive = material.emissive;\r\n    mobileMaterial.emissiveIntensity = material.emissiveIntensity;\r\n    mobileMaterial.emissiveMap = material.emissiveMap;\r\n\r\n    // TODO this actually needs to get called whenever any of these material properties change\r\n    mobileMaterial.refreshUniforms();\r\n\r\n    return mobileMaterial;\r\n  }\r\n\r\n  refreshUniforms() {\r\n    this.uniforms.opacity.value = this.opacity;\r\n\r\n    if (this.color) {\r\n      this.uniforms.diffuse.value.copy(this.color);\r\n    }\r\n\r\n    if (this.emissive) {\r\n      this.uniforms.emissive.value.copy(this.emissive).multiplyScalar(this.emissiveIntensity);\r\n    }\r\n\r\n    if (this.map) {\r\n      this.uniforms.map.value = this.map;\r\n    }\r\n\r\n    if (this.aoMap) {\r\n      this.uniforms.aoMap.value = this.aoMap;\r\n      this.uniforms.aoMapIntensity.value = this.aoMapIntensity;\r\n    }\r\n\r\n    const uvScaleMap = this.map || this.emissiveMap;\r\n    if (uvScaleMap && uvScaleMap.matrixAutoUpdate === true) {\r\n      uvScaleMap.updateMatrix();\r\n      this.uniforms.uvTransform.value.copy(uvScaleMap.matrix);\r\n    }\r\n  }\r\n\r\n  clone() {\r\n    return MobileStandardMaterial.fromStandardMaterial(this);\r\n  }\r\n}\r\n"],"sourceRoot":""}